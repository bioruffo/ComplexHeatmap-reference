<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 7 OncoPrint | ComplexHeatmap Complete Reference</title>
<meta name="author" content="Zuguang Gu">
<meta name="description" content="OncoPrint is a way to visualize multiple genomic alteration events by heatmap. Here the ComplexHeatmap package provides a oncoPrint() function which makes oncoPrints. Besides the default style...">
<meta name="generator" content="bookdown 0.27 with bs4_book()">
<meta property="og:title" content="Chapter 7 OncoPrint | ComplexHeatmap Complete Reference">
<meta property="og:type" content="book">
<meta property="og:url" content="https://jokergoo.github.io/ComplexHeatmap-reference/book/oncoprint.html">
<meta property="og:image" content="https://jokergoo.github.io/ComplexHeatmap-reference/book/complexheatmap-cover.jpg">
<meta property="og:description" content="OncoPrint is a way to visualize multiple genomic alteration events by heatmap. Here the ComplexHeatmap package provides a oncoPrint() function which makes oncoPrints. Besides the default style...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 7 OncoPrint | ComplexHeatmap Complete Reference">
<meta name="twitter:description" content="OncoPrint is a way to visualize multiple genomic alteration events by heatmap. Here the ComplexHeatmap package provides a oncoPrint() function which makes oncoPrints. Besides the default style...">
<meta name="twitter:image" content="https://jokergoo.github.io/ComplexHeatmap-reference/book/complexheatmap-cover.jpg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><style>
    #content {
    	font-size: 0.95rem;
    }
    </style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">ComplexHeatmap Complete Reference</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">About</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="a-single-heatmap.html"><span class="header-section-number">2</span> A Single Heatmap</a></li>
<li><a class="" href="heatmap-annotations.html"><span class="header-section-number">3</span> Heatmap Annotations</a></li>
<li><a class="" href="a-list-of-heatmaps.html"><span class="header-section-number">4</span> A List of Heatmaps</a></li>
<li><a class="" href="legends.html"><span class="header-section-number">5</span> Legends</a></li>
<li><a class="" href="heatmap-decoration.html"><span class="header-section-number">6</span> Heatmap Decoration</a></li>
<li><a class="active" href="oncoprint.html"><span class="header-section-number">7</span> OncoPrint</a></li>
<li><a class="" href="upset-plot.html"><span class="header-section-number">8</span> UpSet plot</a></li>
<li><a class="" href="interactive.html"><span class="header-section-number">9</span> Interactive ComplexHeatmap</a></li>
<li><a class="" href="integrate-with-other-packages.html"><span class="header-section-number">10</span> Integrate with other packages</a></li>
<li><a class="" href="other-high-level-plots.html"><span class="header-section-number">11</span> Other High-level Plots</a></li>
<li><a class="" href="three-d-heatmap.html"><span class="header-section-number">12</span> Three-dimensional ComplexHeatmap</a></li>
<li><a class="" href="genome-level-heatmap.html"><span class="header-section-number">13</span> Genome-level heatmap</a></li>
<li><a class="" href="more-examples.html"><span class="header-section-number">14</span> More Examples</a></li>
<li><a class="" href="other-tricks.html"><span class="header-section-number">15</span> Other Tricks</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/jokergoo/ComplexHeatmap">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="oncoprint" class="section level1" number="7">
<h1>
<span class="header-section-number">7</span> OncoPrint<a class="anchor" aria-label="anchor" href="#oncoprint"><i class="fas fa-link"></i></a>
</h1>
<p><a href="http://www.cbioportal.org/faq#what-are-oncoprints">OncoPrint</a> is a
way to visualize multiple genomic alteration events by heatmap. Here the
<strong>ComplexHeatmap</strong> package provides a <code>oncoPrint()</code> function which makes
oncoPrints. Besides the default style which is provided by <a href="http://www.cbioportal.org/index.do">cBioPortal</a>, there are additional
barplots at both sides of the heatmap which show numbers of different
alterations for each sample and for each gene. Also with the functionality of
<strong>ComplexHeatmap</strong>, you can concatenate oncoPrints with additional heatmaps
and annotations to correspond more types of information.</p>
<div id="oncoprint-general-settings" class="section level2" number="7.1">
<h2>
<span class="header-section-number">7.1</span> General settings<a class="anchor" aria-label="anchor" href="#oncoprint-general-settings"><i class="fas fa-link"></i></a>
</h2>
<div id="input-data-format" class="section level3" number="7.1.1">
<h3>
<span class="header-section-number">7.1.1</span> Input data format<a class="anchor" aria-label="anchor" href="#input-data-format"><i class="fas fa-link"></i></a>
</h3>
<p>There are two different formats of input data. The first is represented as a
matrix in which each value can include multiple alterations in a form of a
complicated string. In follow example, ‘g1’ in ‘s1’ has two types of
alterations which are ‘snv’ and ‘indel.’</p>
<div class="sourceCode" id="cb519"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/textconnections.html">textConnection</a></span><span class="op">(</span>
<span class="st">"s1,s2,s3
g1,snv;indel,snv,indel
g2,,snv;indel,snv
g3,snv,,indel;snv"</span><span class="op">)</span>, row.names <span class="op">=</span> <span class="fl">1</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">","</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">mat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span>
<span class="va">mat</span></code></pre></div>
<pre><code>##    s1          s2          s3         
## g1 "snv;indel" "snv"       "indel"    
## g2 ""          "snv;indel" "snv"      
## g3 "snv"       ""          "indel;snv"</code></pre>
<p>In this case, we need to define a function to extract different alteration
types from these long strings. The definition of such function is always
simple, it accepts the complicated string and returns a vector of alteration
types.</p>
<p>For <code>mat</code>, we can define the function as:</p>
<div class="sourceCode" id="cb521"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">get_type_fun</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">";"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="fu">get_type_fun</span><span class="op">(</span><span class="va">mat</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "snv"   "indel"</code></pre>
<div class="sourceCode" id="cb523"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">get_type_fun</span><span class="op">(</span><span class="va">mat</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "snv"</code></pre>
<p>So, if the alterations are encoded as <code>snv|indel</code>, you can define the function
as <code>function(x) strsplit(x, "|")[[1]]</code>. This self-defined function is assigned
to the <code>get_type</code> argument in <code>oncoPrint()</code>.</p>
<p><strong>Since in most cases, the separators are only single characters, If the
separators are in <code>;:,|</code>, <code>oncoPrint()</code> automatically spit the alteration
strings so that you don’t need to explicitely specify <code>get_type</code> in
<code>oncoPrint()</code> function.</strong></p>
<p>For one gene in one sample, since different alteration types may be drawn into
one same grid in the heatmap, we need to define how to add the graphics by
providing a list of self-defined functions to <code>alter_fun</code> argument. Here if
the graphics have no transparency, order of adding graphics matters. In
following example, snv are first drawn and then the indel. You can see
rectangles for indels are actually smaller (<code>0.4*h</code>) than that for snvs
(<code>0.9*h</code>) so that you can visualize both snvs and indels if they are in a same
grid. Names of the function list should correspond to the alteration types
(here, <code>snv</code> and <code>indel</code>).</p>
<p>For the self-defined graphic function (the functions in <code>alter_fun</code>, there
should be four arguments which are positions of the grids on the oncoPrint
(<code>x</code> and <code>y</code>), and widths and heights of the grids (<code>w</code> and <code>h</code>, which is
measured in <code>npc</code> unit). Proper values for the four arguments are sent to these
functions automatically from <code>oncoPrint()</code>.</p>
<p>Colors for different alterations are defined in <code>col</code>. It should be a named
vector for which names correspond to alteration types. It is used to generate
the barplots.</p>
<div class="sourceCode" id="cb525"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">col</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>snv <span class="op">=</span> <span class="st">"red"</span>, indel <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span>
<span class="fu">oncoPrint</span><span class="op">(</span><span class="va">mat</span>,
    alter_fun <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        snv <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span><span class="op">)</span> <span class="fu">grid.rect</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span><span class="op">*</span><span class="fl">0.9</span>, <span class="va">h</span><span class="op">*</span><span class="fl">0.9</span>, 
            gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="st">"snv"</span><span class="op">]</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>,
        indel <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span><span class="op">)</span> <span class="fu">grid.rect</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span><span class="op">*</span><span class="fl">0.9</span>, <span class="va">h</span><span class="op">*</span><span class="fl">0.4</span>, 
            gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="st">"indel"</span><span class="op">]</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>, col <span class="op">=</span> <span class="va">col</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="07-oncoprint_files/figure-html/unnamed-chunk-4-1.png" width="384" style="display: block; margin: auto;"></div>
<p>You can see the order in barplots also correspond to the order defined in
<code>alter_fun</code>. The grahpics in legend are based on the functions defined in <code>alter_fun</code>.</p>
<p>If you are confused of how to generated the matrix, there is a second way. The
second type of input data is a list of matrix for which each matrix contains
binary value representing whether the alteration is absent or present. The
list should have names which correspond to the alteration types.</p>
<div class="sourceCode" id="cb526"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mat_list</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>snv <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,
                indel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">mat_list</span><span class="op">$</span><span class="va">snv</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">mat_list</span><span class="op">$</span><span class="va">indel</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"g1"</span>, <span class="st">"g2"</span>, <span class="st">"g3"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">mat_list</span><span class="op">$</span><span class="va">snv</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">mat_list</span><span class="op">$</span><span class="va">indel</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"s1"</span>, <span class="st">"s2"</span>, <span class="st">"s3"</span><span class="op">)</span>
<span class="va">mat_list</span></code></pre></div>
<pre><code>## $snv
##    s1 s2 s3
## g1  1  1  0
## g2  0  1  1
## g3  1  0  1
## 
## $indel
##    s1 s2 s3
## g1  1  0  1
## g2  0  1  0
## g3  0  0  0</code></pre>
<p><code>oncoPrint()</code> expects all matrices in <code>mat_list</code> having same row names and
column names.</p>
<p>Pass <code>mat_list</code> to <code>oncoPrint()</code>:</p>
<div class="sourceCode" id="cb528"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># now you don't need `get_type`</span>
<span class="fu">oncoPrint</span><span class="op">(</span><span class="va">mat_list</span>,
    alter_fun <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        snv <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span><span class="op">)</span> <span class="fu">grid.rect</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span><span class="op">*</span><span class="fl">0.9</span>, <span class="va">h</span><span class="op">*</span><span class="fl">0.9</span>, 
            gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="st">"snv"</span><span class="op">]</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>,
        indel <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span><span class="op">)</span> <span class="fu">grid.rect</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span><span class="op">*</span><span class="fl">0.9</span>, <span class="va">h</span><span class="op">*</span><span class="fl">0.4</span>, 
            gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="st">"indel"</span><span class="op">]</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>, col <span class="op">=</span> <span class="va">col</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="07-oncoprint_files/figure-html/unnamed-chunk-6-1.png" width="384" style="display: block; margin: auto;"></div>
<p>In following parts of this chapter, we still use the single matrix form <code>mat</code>
to specify the input data.</p>
</div>
<div id="define-the-alter-fun" class="section level3" number="7.1.2">
<h3>
<span class="header-section-number">7.1.2</span> Define the alter_fun()<a class="anchor" aria-label="anchor" href="#define-the-alter-fun"><i class="fas fa-link"></i></a>
</h3>
<p><code>alter_fun</code> is a list of functons which add graphics layer by layer (i.e.
first draw for <code>snv</code>, then for <code>indel</code>). Graphics can also be added in a
grid-by-grid style by specifying <code>alter_fun</code> as a single function. The
difference from the function list is now <code>alter_fun</code> should accept a fifth
argument which is a logical vector. This logical vector shows whether
different alterations exist for current gene in current sample.</p>
<p>Let’s assume in a grid there is only snv event, then <code>v</code> for this grid is:</p>
<pre><code>##   snv indel 
##  TRUE FALSE</code></pre>
<div class="sourceCode" id="cb530"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">oncoPrint</span><span class="op">(</span><span class="va">mat</span>,
    alter_fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span>, <span class="va">v</span><span class="op">)</span> <span class="op">{</span>
        <span class="kw">if</span><span class="op">(</span><span class="va">v</span><span class="op">[</span><span class="st">"snv"</span><span class="op">]</span><span class="op">)</span> <span class="fu">grid.rect</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span><span class="op">*</span><span class="fl">0.9</span>, <span class="va">h</span><span class="op">*</span><span class="fl">0.9</span>, <span class="co"># v["snv"] is a logical value</span>
            gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="st">"snv"</span><span class="op">]</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>
        <span class="kw">if</span><span class="op">(</span><span class="va">v</span><span class="op">[</span><span class="st">"indel"</span><span class="op">]</span><span class="op">)</span> <span class="fu">grid.rect</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span><span class="op">*</span><span class="fl">0.9</span>, <span class="va">h</span><span class="op">*</span><span class="fl">0.4</span>, <span class="co"># v["indel"] is a logical value</span>
            gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="st">"indel"</span><span class="op">]</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>
    <span class="op">}</span>, col <span class="op">=</span> <span class="va">col</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="07-oncoprint_files/figure-html/unnamed-chunk-8-1.png" width="384" style="display: block; margin: auto;"></div>
<p>If <code>alter_fun</code> is set as a single function, customization can be more
flexible. In following example, the blue rectangles can have different height
in different grid.</p>
<div class="sourceCode" id="cb531"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">oncoPrint</span><span class="op">(</span><span class="va">mat</span>,
    alter_fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span>, <span class="va">v</span><span class="op">)</span> <span class="op">{</span>
        <span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span>  <span class="co"># how many alterations for current gene in current sample</span>
        <span class="va">h</span> <span class="op">=</span> <span class="va">h</span><span class="op">*</span><span class="fl">0.9</span>
        <span class="co"># use `names(which(v))` to correctly map between `v` and `col`</span>
        <span class="kw">if</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu">grid.rect</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span> <span class="op">-</span> <span class="va">h</span><span class="op">*</span><span class="fl">0.5</span> <span class="op">+</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">/</span><span class="va">n</span><span class="op">*</span><span class="va">h</span>, <span class="va">w</span><span class="op">*</span><span class="fl">0.9</span>, <span class="fl">1</span><span class="op">/</span><span class="va">n</span><span class="op">*</span><span class="va">h</span>, 
            gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>, just <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span>
    <span class="op">}</span>, col <span class="op">=</span> <span class="va">col</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="07-oncoprint_files/figure-html/unnamed-chunk-9-1.png" width="384" style="display: block; margin: auto;"></div>
<p>Following is a complicated example for <code>alter_fun</code> where triangles are used:</p>
<div class="sourceCode" id="cb532"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">oncoPrint</span><span class="op">(</span><span class="va">mat</span>,
    alter_fun <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        background <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span><span class="op">)</span> <span class="op">{</span>
            <span class="fu">grid.polygon</span><span class="op">(</span>
                <span class="fu">unit.c</span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fl">0.5</span><span class="op">*</span><span class="va">w</span>, <span class="va">x</span> <span class="op">-</span> <span class="fl">0.5</span><span class="op">*</span><span class="va">w</span>, <span class="va">x</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span><span class="va">w</span><span class="op">)</span>, 
                <span class="fu">unit.c</span><span class="op">(</span><span class="va">y</span> <span class="op">-</span> <span class="fl">0.5</span><span class="op">*</span><span class="va">h</span>, <span class="va">y</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span><span class="va">h</span>, <span class="va">y</span> <span class="op">-</span> <span class="fl">0.5</span><span class="op">*</span><span class="va">h</span><span class="op">)</span>,
                gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"grey"</span>, col <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span><span class="op">)</span>
            <span class="fu">grid.polygon</span><span class="op">(</span>
                <span class="fu">unit.c</span><span class="op">(</span><span class="va">x</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span><span class="va">w</span>, <span class="va">x</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span><span class="va">w</span>, <span class="va">x</span> <span class="op">-</span> <span class="fl">0.5</span><span class="op">*</span><span class="va">w</span><span class="op">)</span>, 
                <span class="fu">unit.c</span><span class="op">(</span><span class="va">y</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span><span class="va">h</span>, <span class="va">y</span> <span class="op">-</span> <span class="fl">0.5</span><span class="op">*</span><span class="va">h</span>, <span class="va">y</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span><span class="va">h</span><span class="op">)</span>,
                gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"grey"</span>, col <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span><span class="op">)</span>
        <span class="op">}</span>,
        snv <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span><span class="op">)</span> <span class="op">{</span>
            <span class="fu">grid.polygon</span><span class="op">(</span>
                <span class="fu">unit.c</span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fl">0.5</span><span class="op">*</span><span class="va">w</span>, <span class="va">x</span> <span class="op">-</span> <span class="fl">0.5</span><span class="op">*</span><span class="va">w</span>, <span class="va">x</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span><span class="va">w</span><span class="op">)</span>, 
                <span class="fu">unit.c</span><span class="op">(</span><span class="va">y</span> <span class="op">-</span> <span class="fl">0.5</span><span class="op">*</span><span class="va">h</span>, <span class="va">y</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span><span class="va">h</span>, <span class="va">y</span> <span class="op">-</span> <span class="fl">0.5</span><span class="op">*</span><span class="va">h</span><span class="op">)</span>,
                gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="st">"snv"</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span><span class="op">)</span>
        <span class="op">}</span>,
        indel <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span><span class="op">)</span> <span class="op">{</span>
            <span class="fu">grid.polygon</span><span class="op">(</span>
                <span class="fu">unit.c</span><span class="op">(</span><span class="va">x</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span><span class="va">w</span>, <span class="va">x</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span><span class="va">w</span>, <span class="va">x</span> <span class="op">-</span> <span class="fl">0.5</span><span class="op">*</span><span class="va">w</span><span class="op">)</span>, 
                <span class="fu">unit.c</span><span class="op">(</span><span class="va">y</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span><span class="va">h</span>, <span class="va">y</span> <span class="op">-</span> <span class="fl">0.5</span><span class="op">*</span><span class="va">h</span>, <span class="va">y</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span><span class="va">h</span><span class="op">)</span>,
                gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="st">"indel"</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span><span class="op">)</span>
        <span class="op">}</span>
    <span class="op">)</span>, col <span class="op">=</span> <span class="va">col</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="07-oncoprint_files/figure-html/unnamed-chunk-10-1.png" width="384" style="display: block; margin: auto;"></div>
<p>In some cases, you might need to define <code>alter_fun</code> for many alteration types.
If you are not sure about the visual effect of your <code>alter_fun</code>, you can use
<code>test_alter_fun()</code> to test your <code>alter_fun</code>. In following example, we defined
seven alteration functions:</p>
<div class="sourceCode" id="cb533"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">alter_fun</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    mut1 <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span><span class="op">)</span> 
        <span class="fu">grid.rect</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"red"</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>,
    mut2 <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span><span class="op">)</span> 
        <span class="fu">grid.rect</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"blue"</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>,
    mut3 <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span><span class="op">)</span> 
        <span class="fu">grid.rect</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"yellow"</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>,
    mut4 <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span><span class="op">)</span> 
        <span class="fu">grid.rect</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"purple"</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>,
    mut5 <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span><span class="op">)</span> 
        <span class="fu">grid.rect</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">NA</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,
    mut6 <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span><span class="op">)</span> 
        <span class="fu">grid.points</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,
    mut7 <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span><span class="op">)</span> 
        <span class="fu">grid.segments</span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">w</span><span class="op">*</span><span class="fl">0.5</span>, <span class="va">y</span> <span class="op">-</span> <span class="va">h</span><span class="op">*</span><span class="fl">0.5</span>, <span class="va">x</span> <span class="op">+</span> <span class="va">w</span><span class="op">*</span><span class="fl">0.5</span>, <span class="va">y</span> <span class="op">+</span> <span class="va">h</span><span class="op">*</span><span class="fl">0.5</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu">test_alter_fun</span><span class="op">(</span><span class="va">alter_fun</span><span class="op">)</span></code></pre></div>
<pre><code>## `alter_fun` is defined as a list of functions.
## Functions are defined for following alteration types:
##   mut1, mut2, mut3, mut4, mut5, mut6, mut7</code></pre>
<div class="inline-figure"><img src="07-oncoprint_files/figure-html/unnamed-chunk-11-1.png" width="288" style="display: block; margin: auto;"></div>
<p>For the combination of alteration types, <code>test_alter_fun()</code> randomly samples
some of them.</p>
<p><code>test_alter_fun()</code> works both for <code>alter_fun</code> as a list and as a single
function.</p>
</div>
<div id="oncoprint-background" class="section level3" number="7.1.3">
<h3>
<span class="header-section-number">7.1.3</span> Background<a class="anchor" aria-label="anchor" href="#oncoprint-background"><i class="fas fa-link"></i></a>
</h3>
<p>If <code>alter_fun</code> is specified as a list, the order of the elements controls the
order of adding graphics. There is a special element called <code>background</code> which
defines how to draw background and it should be always put as the first
element in the <code>alter_fun</code> list. In following example, backgrond color is
changed to light green with borders.</p>
<div class="sourceCode" id="cb535"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">oncoPrint</span><span class="op">(</span><span class="va">mat</span>,
    alter_fun <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        background <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span><span class="op">)</span> <span class="fu">grid.rect</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span>, 
            gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#00FF0020"</span><span class="op">)</span><span class="op">)</span>,
        snv <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span><span class="op">)</span> <span class="fu">grid.rect</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span><span class="op">*</span><span class="fl">0.9</span>, <span class="va">h</span><span class="op">*</span><span class="fl">0.9</span>, 
            gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="st">"snv"</span><span class="op">]</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>,
        indel <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span><span class="op">)</span> <span class="fu">grid.rect</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span><span class="op">*</span><span class="fl">0.9</span>, <span class="va">h</span><span class="op">*</span><span class="fl">0.4</span>, 
            gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="st">"indel"</span><span class="op">]</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>, col <span class="op">=</span> <span class="va">col</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="07-oncoprint_files/figure-html/unnamed-chunk-12-1.png" width="384" style="display: block; margin: auto;"></div>
<p>Or just remove the background (don’t set it to <code>NULL</code>. Setting <code>background</code>
directly to <code>NULL</code> means to use the default style of background whch is in
grey):</p>
<div class="sourceCode" id="cb536"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">oncoPrint</span><span class="op">(</span><span class="va">mat</span>,
    alter_fun <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        background <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="cn">NULL</span>,
        snv <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span><span class="op">)</span> <span class="fu">grid.rect</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span><span class="op">*</span><span class="fl">0.9</span>, <span class="va">h</span><span class="op">*</span><span class="fl">0.9</span>, 
            gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="st">"snv"</span><span class="op">]</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>,
        indel <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span><span class="op">)</span> <span class="fu">grid.rect</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span><span class="op">*</span><span class="fl">0.9</span>, <span class="va">h</span><span class="op">*</span><span class="fl">0.4</span>, 
            gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="st">"indel"</span><span class="op">]</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>, col <span class="op">=</span> <span class="va">col</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="07-oncoprint_files/figure-html/unnamed-chunk-13-1.png" width="384" style="display: block; margin: auto;"></div>
</div>
<div id="complex-alteration-types" class="section level3" number="7.1.4">
<h3>
<span class="header-section-number">7.1.4</span> Complex alteration types<a class="anchor" aria-label="anchor" href="#complex-alteration-types"><i class="fas fa-link"></i></a>
</h3>
<p>It is very easy to have many more different alteration types when integrating
information from multiple analysis results. It is sometimes difficult to
design graphics and assign different colors for them (e.g. <a href="https://user-images.githubusercontent.com/13846735/51974483-fab20b00-24ba-11e9-91d3-3358e5f1017e.png">see plot in this
link</a>.
On the other hand, in these alteration types, there are primary classes of
alteration types which is more important to distinguish, while there are
secondary classes which is less important. For example, we may have alteration
types of “intronic snv,” “exonic snv,” “intronic indel” and “exonic indel.”
Actually we can classify them into two classes where “snv/indel” is more
important and they belong to the primary class, and “intronic/exonic” is less
important and they belong to the secondary class. Reflecting on the oncoPrint,
for the “intronic snv” and “exonic snv,” we want to use similar graphics
because they are snvs and we want them visually similar, and we add slightly
different symbols to represent “intronic” and “exonic,” E.g. we can use red
rectangle for snv and above the red rectangles, we use dots to represent
“intronic” and cross lines to represent “exonic.” On the barplot annotations
which summarize the number of different alteration types, we don’t want to
separate “intronic snv” and “exonic snv” while we prefer to simply get the
total number of snv to get rid of too many categories in the barplots.</p>
<p>Let’s demonstrate this scenario by following simulated data. To simplify the
example, we assume for a single gene in a single sample, it only has either
snv or indel and it can only be either intronic or exonic. If there is no
“intronic” or “exonic” attached to the gene, it basically means we don’t have
this gene-related information (maybe it is an intergenic snv/indel).</p>
<div class="sourceCode" id="cb537"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>
<span class="va">x1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"snv"</span><span class="op">)</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="va">x2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"indel"</span><span class="op">)</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="va">x2</span><span class="op">[</span><span class="va">x1</span> <span class="op">==</span> <span class="st">"snv"</span><span class="op">]</span> <span class="op">=</span> <span class="st">""</span>
<span class="va">x3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"intronic"</span><span class="op">)</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>
<span class="va">x4</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"exonic"</span><span class="op">)</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>
<span class="va">x3</span><span class="op">[</span><span class="va">x1</span> <span class="op">==</span> <span class="st">""</span> <span class="op">&amp;</span> <span class="va">x2</span> <span class="op">==</span> <span class="st">""</span><span class="op">]</span> <span class="op">=</span> <span class="st">""</span>
<span class="va">x4</span><span class="op">[</span><span class="va">x1</span> <span class="op">==</span> <span class="st">""</span> <span class="op">&amp;</span> <span class="va">x2</span> <span class="op">==</span> <span class="st">""</span><span class="op">]</span> <span class="op">=</span> <span class="st">""</span>
<span class="va">x4</span><span class="op">[</span><span class="va">x3</span> <span class="op">==</span> <span class="st">"intronic"</span><span class="op">]</span> <span class="op">=</span> <span class="st">""</span>
<span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, <span class="va">x3</span>, <span class="va">x4</span><span class="op">)</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">x</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="va">x</span> <span class="op">!=</span> <span class="st">""</span><span class="op">]</span>
    <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">x</span>, collapse <span class="op">=</span> <span class="st">";"</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span>
<span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">x</span>, nrow <span class="op">=</span> <span class="fl">10</span>, ncol <span class="op">=</span> <span class="fl">10</span>, dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"g"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"s"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">m</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></code></pre></div>
<pre><code>##    s1    s2             s3             s4            
## g1 ""    "snv;intronic" "snv;intronic" "snv"         
## g2 ""    ""             ""             "snv;intronic"
## g3 ""    ""             ""             ""            
## g4 "snv" "indel;exonic" "snv"          ""</code></pre>
<p>Now in <code>m</code>, there are four different alteration types: <code>snv</code>, <code>indel</code>,
<code>intronic</code> and <code>exonic</code>. Next we define <code>alter_fun</code> for the four alterations.</p>
<div class="sourceCode" id="cb539"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">alter_fun</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    background <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span><span class="op">)</span> 
        <span class="fu">grid.rect</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span><span class="op">*</span><span class="fl">0.9</span>, <span class="va">h</span><span class="op">*</span><span class="fl">0.9</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#CCCCCC"</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>,
    <span class="co"># red rectangles</span>
    snv <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span><span class="op">)</span> 
        <span class="fu">grid.rect</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span><span class="op">*</span><span class="fl">0.9</span>, <span class="va">h</span><span class="op">*</span><span class="fl">0.9</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"red"</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>,
    <span class="co"># blue rectangles</span>
    indel <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span><span class="op">)</span> 
        <span class="fu">grid.rect</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span><span class="op">*</span><span class="fl">0.9</span>, <span class="va">h</span><span class="op">*</span><span class="fl">0.9</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"blue"</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>,
    <span class="co"># dots</span>
    intronic <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span><span class="op">)</span> 
        <span class="fu">grid.points</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,
    <span class="co"># crossed lines</span>
    exonic <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span><span class="op">)</span> <span class="op">{</span>
        <span class="fu">grid.segments</span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">w</span><span class="op">*</span><span class="fl">0.4</span>, <span class="va">y</span> <span class="op">-</span> <span class="va">h</span><span class="op">*</span><span class="fl">0.4</span>, <span class="va">x</span> <span class="op">+</span> <span class="va">w</span><span class="op">*</span><span class="fl">0.4</span>, <span class="va">y</span> <span class="op">+</span> <span class="va">h</span><span class="op">*</span><span class="fl">0.4</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
        <span class="fu">grid.segments</span><span class="op">(</span><span class="va">x</span> <span class="op">+</span> <span class="va">w</span><span class="op">*</span><span class="fl">0.4</span>, <span class="va">y</span> <span class="op">-</span> <span class="va">h</span><span class="op">*</span><span class="fl">0.4</span>, <span class="va">x</span> <span class="op">-</span> <span class="va">w</span><span class="op">*</span><span class="fl">0.4</span>, <span class="va">y</span> <span class="op">+</span> <span class="va">h</span><span class="op">*</span><span class="fl">0.4</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
    <span class="op">}</span>
<span class="op">)</span></code></pre></div>
<p>For the alteration types in the primary class (<code>snv</code> and <code>indel</code>), we use
colorred rectangles to represent them because the rectangles are visually
obvious, while for the alteration types in the secondary class (<code>intronic</code> and
<code>exonic</code>), we only use simple symbols (dots for <code>intronic</code> and crossed
diagonal lines for <code>exonic</code>). Since there is no color corresponding to
<code>intronic</code> and <code>exonic</code>, we don’t need to define colors for these two types,
and on the barplot annotation for genes and samples, only <code>snv</code> and <code>indel</code>
are visualized (so the height for <code>snv</code> in the barplot corresponds the number
of intronic snv plus exonic snv).</p>
<div class="sourceCode" id="cb540"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># we only define color for snv and indel, so barplot annotations only show snv and indel</span>
<span class="fu">oncoPrint</span><span class="op">(</span><span class="va">m</span>, alter_fun <span class="op">=</span> <span class="va">alter_fun</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>snv <span class="op">=</span> <span class="st">"red"</span>, indel <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="07-oncoprint_files/figure-html/unnamed-chunk-16-1.png" width="528" style="display: block; margin: auto;"></div>
</div>
<div id="simplify-alter_fun" class="section level3" number="7.1.5">
<h3>
<span class="header-section-number">7.1.5</span> Simplify alter_fun<a class="anchor" aria-label="anchor" href="#simplify-alter_fun"><i class="fas fa-link"></i></a>
</h3>
<p>If the graphics are only simple graphics, e.g., rectangles, points, the graphic
functions can be automatically generated by <code>alter_graphic()</code> function. One of previous example
can be simplied as:</p>
<div class="sourceCode" id="cb541"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">oncoPrint</span><span class="op">(</span><span class="va">mat</span>,
    alter_fun <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        snv <span class="op">=</span> <span class="fu">alter_graphic</span><span class="op">(</span><span class="st">"rect"</span>, width <span class="op">=</span> <span class="fl">0.9</span>, height <span class="op">=</span> <span class="fl">0.9</span>, fill <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="st">"snv"</span><span class="op">]</span><span class="op">)</span>,
        indel <span class="op">=</span> <span class="fu">alter_graphic</span><span class="op">(</span><span class="st">"rect"</span>, width <span class="op">=</span> <span class="fl">0.9</span>, height <span class="op">=</span> <span class="fl">0.4</span>, fill <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="st">"indel"</span><span class="op">]</span><span class="op">)</span>
    <span class="op">)</span>, col <span class="op">=</span> <span class="va">col</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="07-oncoprint_files/figure-html/unnamed-chunk-17-1.png" width="384" style="display: block; margin: auto;"></div>
</div>
<div id="other-heatmap-related-settings" class="section level3" number="7.1.6">
<h3>
<span class="header-section-number">7.1.6</span> Other heatmap-related settings<a class="anchor" aria-label="anchor" href="#other-heatmap-related-settings"><i class="fas fa-link"></i></a>
</h3>
<p>Column names are by default not drawn in the plot. It is can be turned on by
setting <code>show_column_names = TRUE</code>.</p>
<div class="sourceCode" id="cb542"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">alter_fun</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    snv <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span><span class="op">)</span> <span class="fu">grid.rect</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span><span class="op">*</span><span class="fl">0.9</span>, <span class="va">h</span><span class="op">*</span><span class="fl">0.9</span>, 
        gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="st">"snv"</span><span class="op">]</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>,
    indel <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span><span class="op">)</span> <span class="fu">grid.rect</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span><span class="op">*</span><span class="fl">0.9</span>, <span class="va">h</span><span class="op">*</span><span class="fl">0.4</span>, 
        gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="st">"indel"</span><span class="op">]</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu">oncoPrint</span><span class="op">(</span><span class="va">mat</span>, alter_fun <span class="op">=</span> <span class="va">alter_fun</span>, col <span class="op">=</span> <span class="va">col</span>, show_column_names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="07-oncoprint_files/figure-html/unnamed-chunk-18-1.png" width="384" style="display: block; margin: auto;"></div>
<p>Row names and percent texts can be turned on/off by setting <code>show_pct</code>
and <code>show_row_names</code>. The side of both according to the oncoPrint is controlled
by <code>pct_side</code> and <code>row_names_side</code>. Digits of the percent values are controlled
by <code>pct_digits</code>.</p>
<div class="sourceCode" id="cb543"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">oncoPrint</span><span class="op">(</span><span class="va">mat</span>, alter_fun <span class="op">=</span> <span class="va">alter_fun</span>, col <span class="op">=</span> <span class="va">col</span>, 
    row_names_side <span class="op">=</span> <span class="st">"left"</span>, pct_side <span class="op">=</span> <span class="st">"right"</span>, pct_digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="07-oncoprint_files/figure-html/unnamed-chunk-19-1.png" width="384" style="display: block; margin: auto;"></div>
<p>The barplot annotations on the both side are controlled by
<code>anno_oncoprint_barplot()</code> annotation function. Customization such as the size
and the axes can be set directly in <code>anno_oncoprint_barplot()</code>. More examples
of setting <code>anno_oncoprint_barplot()</code> can be found in Section <a href="oncoprint.html#oncoprint-annotations">7.2.3</a>.</p>
<div class="sourceCode" id="cb544"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">oncoPrint</span><span class="op">(</span><span class="va">mat</span>, alter_fun <span class="op">=</span> <span class="va">alter_fun</span>, col <span class="op">=</span> <span class="va">col</span>, 
    top_annotation <span class="op">=</span> <span class="fu">HeatmapAnnotation</span><span class="op">(</span>
        cbar <span class="op">=</span> <span class="fu">anno_oncoprint_barplot</span><span class="op">(</span>height <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">1</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
    right_annotation <span class="op">=</span> <span class="fu">rowAnnotation</span><span class="op">(</span>
        rbar <span class="op">=</span> <span class="fu">anno_oncoprint_barplot</span><span class="op">(</span>
            width <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">4</span>, <span class="st">"cm"</span><span class="op">)</span>,
            axis_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span>, 
                labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"zero"</span>, <span class="st">"two"</span>, <span class="st">"four"</span><span class="op">)</span>,
                side <span class="op">=</span> <span class="st">"top"</span>,
                labels_rot <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
    <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="07-oncoprint_files/figure-html/unnamed-chunk-20-1.png" width="384" style="display: block; margin: auto;"></div>
<p>Some people might want to move the right barplots to the left of the oncoPrint:</p>
<div class="sourceCode" id="cb545"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">oncoPrint</span><span class="op">(</span><span class="va">mat</span>, alter_fun <span class="op">=</span> <span class="va">alter_fun</span>, col <span class="op">=</span> <span class="va">col</span>, 
    left_annotation <span class="op">=</span>  <span class="fu">rowAnnotation</span><span class="op">(</span>
        rbar <span class="op">=</span> <span class="fu">anno_oncoprint_barplot</span><span class="op">(</span>
            axis_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>direction <span class="op">=</span> <span class="st">"reverse"</span><span class="op">)</span>
    <span class="op">)</span><span class="op">)</span>,
    right_annotation <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="07-oncoprint_files/figure-html/unnamed-chunk-21-1.png" width="384" style="display: block; margin: auto;"></div>
<p>OncoPrints essentially are heatmaps, thus, there are many arguments set in
<code>Heatmap()</code> can also be set in <code>oncoPrint()</code>. In following section, we use a
real-world dataset to demonstrate more use of <code>oncoPrint()</code> function.</p>
</div>
</div>
<div id="apply-to-cbioportal-dataset" class="section level2" number="7.2">
<h2>
<span class="header-section-number">7.2</span> Apply to cBioPortal dataset<a class="anchor" aria-label="anchor" href="#apply-to-cbioportal-dataset"><i class="fas fa-link"></i></a>
</h2>
<p>We use a real-world dataset to demonstrate advanced usage of <code>oncoPrint()</code>.
The data is retrieved from <a href="http://www.cbioportal.org/">cBioPortal</a>.
Steps for getting the data are as follows:</p>
<ol style="list-style-type: decimal">
<li>go to <a href="http://www.cbioportal.org" class="uri">http://www.cbioportal.org</a>,</li>
<li>search Cancer Study: “<em>Lung Adenocarcinoma Carcinoma</em>” and select: “<em>Lung
Adenocarcinoma Carcinoma (TCGA, Provisinal)</em>,”</li>
<li>in “<em>Enter Gene Set</em>” field, select: “<em>General: Ras-Raf-MEK-Erk/JNK
signaling (26 genes)</em>,”</li>
<li>submit the form.</li>
</ol>
<p>In the result page,</p>
<ol start="5" style="list-style-type: decimal">
<li>go to “<em>Download</em>” tab, download text in “<em>Type of Genetic alterations
across all cases</em>.”</li>
</ol>
<p>The order of samples can also be downloaded from the results page,</p>
<ol start="6" style="list-style-type: decimal">
<li>go to “<em>OncoPrint</em>” tab, move the mouse above the plot, click “<em>download</em>”
icon and click “<em>Sample order</em>.”</li>
</ol>
<p>The data is already in <strong>ComplexHeatmap</strong> package. First we read the data and
make some pre-processing.</p>
<div class="sourceCode" id="cb546"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"ComplexHeatmap"</span>, 
    <span class="st">"tcga_lung_adenocarcinoma_provisional_ras_raf_mek_jnk_signalling.txt"</span><span class="op">)</span>, 
    header <span class="op">=</span> <span class="cn">TRUE</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span>, sep <span class="op">=</span> <span class="st">"\t"</span><span class="op">)</span>
<span class="va">mat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="st">""</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">=</span> <span class="va">mat</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>
<span class="va">mat</span> <span class="op">=</span> <span class="va">mat</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>
<span class="va">mat</span><span class="op">=</span>  <span class="va">mat</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">]</span>
<span class="va">mat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span>
<span class="va">mat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></code></pre></div>
<pre><code>##      TCGA-05-4384-01 TCGA-05-4390-01 TCGA-05-4425-01
## KRAS "  "            "MUT;"          "  "           
## HRAS "  "            "  "            "  "           
## BRAF "  "            "  "            "  "</code></pre>
<p>There are three different alterations in <code>mat</code>: <code>HOMDEL</code>, <code>AMP</code> and <code>MUT</code>. We first
define how to add graphics for different alterations.</p>
<div class="sourceCode" id="cb548"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">col</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"HOMDEL"</span> <span class="op">=</span> <span class="st">"blue"</span>, <span class="st">"AMP"</span> <span class="op">=</span> <span class="st">"red"</span>, <span class="st">"MUT"</span> <span class="op">=</span> <span class="st">"#008000"</span><span class="op">)</span>
<span class="va">alter_fun</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    background <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span><span class="op">)</span> <span class="op">{</span>
        <span class="fu">grid.rect</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span><span class="op">-</span><span class="fu">unit</span><span class="op">(</span><span class="fl">2</span>, <span class="st">"pt"</span><span class="op">)</span>, <span class="va">h</span><span class="op">-</span><span class="fu">unit</span><span class="op">(</span><span class="fl">2</span>, <span class="st">"pt"</span><span class="op">)</span>, 
            gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#CCCCCC"</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>
    <span class="op">}</span>,
    <span class="co"># big blue</span>
    HOMDEL <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span><span class="op">)</span> <span class="op">{</span>
        <span class="fu">grid.rect</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span><span class="op">-</span><span class="fu">unit</span><span class="op">(</span><span class="fl">2</span>, <span class="st">"pt"</span><span class="op">)</span>, <span class="va">h</span><span class="op">-</span><span class="fu">unit</span><span class="op">(</span><span class="fl">2</span>, <span class="st">"pt"</span><span class="op">)</span>, 
            gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="st">"HOMDEL"</span><span class="op">]</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>
    <span class="op">}</span>,
    <span class="co"># big red</span>
    AMP <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span><span class="op">)</span> <span class="op">{</span>
        <span class="fu">grid.rect</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span><span class="op">-</span><span class="fu">unit</span><span class="op">(</span><span class="fl">2</span>, <span class="st">"pt"</span><span class="op">)</span>, <span class="va">h</span><span class="op">-</span><span class="fu">unit</span><span class="op">(</span><span class="fl">2</span>, <span class="st">"pt"</span><span class="op">)</span>, 
            gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="st">"AMP"</span><span class="op">]</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>
    <span class="op">}</span>,
    <span class="co"># small green</span>
    MUT <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span>, <span class="va">h</span><span class="op">)</span> <span class="op">{</span>
        <span class="fu">grid.rect</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">w</span><span class="op">-</span><span class="fu">unit</span><span class="op">(</span><span class="fl">2</span>, <span class="st">"pt"</span><span class="op">)</span>, <span class="va">h</span><span class="op">*</span><span class="fl">0.33</span>, 
            gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="st">"MUT"</span><span class="op">]</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>
    <span class="op">}</span>
<span class="op">)</span></code></pre></div>
<p>Just a note, since the graphics are all rectangles, they can be simplied by generating by <code>alter_graphic()</code>:</p>
<div class="sourceCode" id="cb549"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># just for demonstration</span>
<span class="va">alter_fun</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    background <span class="op">=</span> <span class="fu">alter_graphic</span><span class="op">(</span><span class="st">"rect"</span>, fill <span class="op">=</span> <span class="st">"#CCCCCC"</span><span class="op">)</span>,   
    HOMDEL <span class="op">=</span> <span class="fu">alter_graphic</span><span class="op">(</span><span class="st">"rect"</span>, fill <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="st">"HOMDEL"</span><span class="op">]</span><span class="op">)</span>,
    AMP <span class="op">=</span> <span class="fu">alter_graphic</span><span class="op">(</span><span class="st">"rect"</span>, fill <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="st">"AMP"</span><span class="op">]</span><span class="op">)</span>,
    MUT <span class="op">=</span> <span class="fu">alter_graphic</span><span class="op">(</span><span class="st">"rect"</span>, height <span class="op">=</span> <span class="fl">0.33</span>, fill <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="st">"MUT"</span><span class="op">]</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>Now we make the oncoPrint. We save <code>column_title</code> and <code>heatmap_legend_param</code>
as varaibles because they are used multiple times in following code chunks.</p>
<div class="sourceCode" id="cb550"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">column_title</span> <span class="op">=</span> <span class="st">"OncoPrint for TCGA Lung Adenocarcinoma, genes in Ras Raf MEK JNK signalling"</span>
<span class="va">heatmap_legend_param</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Alternations"</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"HOMDEL"</span>, <span class="st">"AMP"</span>, <span class="st">"MUT"</span><span class="op">)</span>, 
        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Deep deletion"</span>, <span class="st">"Amplification"</span>, <span class="st">"Mutation"</span><span class="op">)</span><span class="op">)</span>
<span class="fu">oncoPrint</span><span class="op">(</span><span class="va">mat</span>,
    alter_fun <span class="op">=</span> <span class="va">alter_fun</span>, col <span class="op">=</span> <span class="va">col</span>, 
    column_title <span class="op">=</span> <span class="va">column_title</span>, heatmap_legend_param <span class="op">=</span> <span class="va">heatmap_legend_param</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="07-oncoprint_files/figure-html/unnamed-chunk-26-1.png" width="1152" style="display: block; margin: auto;"></div>
<p>As you see, the genes and samples are reordered automatically. Rows are sorted
based on the frequency of the alterations in all samples and columns are
reordered to visualize the mutual exclusivity between samples. The column
reordering is based on the “memo sort” method, adapted from
<a href="https://gist.github.com/armish/564a65ab874a770e2c26" class="uri">https://gist.github.com/armish/564a65ab874a770e2c26</a>.</p>
<div id="remove-empty-rows-and-columns" class="section level3" number="7.2.1">
<h3>
<span class="header-section-number">7.2.1</span> Remove empty rows and columns<a class="anchor" aria-label="anchor" href="#remove-empty-rows-and-columns"><i class="fas fa-link"></i></a>
</h3>
<p>By default, if samples or genes have no alterations, they will still remain in
the heatmap, but you can set <code>remove_empty_columns</code> and <code>remove_empty_rows</code> to
<code>TRUE</code> to remove them:</p>
<div class="sourceCode" id="cb551"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">oncoPrint</span><span class="op">(</span><span class="va">mat</span>,
    alter_fun <span class="op">=</span> <span class="va">alter_fun</span>, col <span class="op">=</span> <span class="va">col</span>, 
    remove_empty_columns <span class="op">=</span> <span class="cn">TRUE</span>, remove_empty_rows <span class="op">=</span> <span class="cn">TRUE</span>,
    column_title <span class="op">=</span> <span class="va">column_title</span>, heatmap_legend_param <span class="op">=</span> <span class="va">heatmap_legend_param</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="07-oncoprint_files/figure-html/unnamed-chunk-27-1.png" width="1152" style="display: block; margin: auto;"></div>
<p>The number of rows and columns may be reduced after empty rows and columns are
removed. All the components of the oncoPrint are adjusted accordingly. When
the oncoPrint is concatenated with other heatmaps and annotations, this may
cause a problem that the number of rows or columns are not all identical in
the heatmap list. So, if you put oncoPrint into a heatmap list and you don’t
want to see empty rows or columns, you need to remove them manually before
sending to <code>oncoPrint()</code> function (this preprocess should be very easy for
you!).</p>
</div>
<div id="reorder-the-oncoprint" class="section level3" number="7.2.2">
<h3>
<span class="header-section-number">7.2.2</span> Reorder the oncoPrint<a class="anchor" aria-label="anchor" href="#reorder-the-oncoprint"><i class="fas fa-link"></i></a>
</h3>
<p>As the normal <code>Heatmap()</code> function, <code>row_order</code> or <code>column_order</code> can be
assigned with a vector of orders (either numeric or character). In following
example, the order of samples are gathered from cBio as well. You can see the
difference for the sample order between ‘memo sort’ and the method used by
cBio.</p>
<div class="sourceCode" id="cb552"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sample_order</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scan.html">scan</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"ComplexHeatmap"</span><span class="op">)</span>, 
    <span class="st">"/sample_order.txt"</span><span class="op">)</span>, what <span class="op">=</span> <span class="st">"character"</span><span class="op">)</span>
<span class="fu">oncoPrint</span><span class="op">(</span><span class="va">mat</span>,
    alter_fun <span class="op">=</span> <span class="va">alter_fun</span>, col <span class="op">=</span> <span class="va">col</span>, 
    row_order <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span>, column_order <span class="op">=</span> <span class="va">sample_order</span>,
    remove_empty_columns <span class="op">=</span> <span class="cn">TRUE</span>, remove_empty_rows <span class="op">=</span> <span class="cn">TRUE</span>,
    column_title <span class="op">=</span> <span class="va">column_title</span>, heatmap_legend_param <span class="op">=</span> <span class="va">heatmap_legend_param</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="07-oncoprint_files/figure-html/unnamed-chunk-28-1.png" width="1152" style="display: block; margin: auto;"></div>
<p>Again, <code>row_order</code> and <code>column_order</code> are automatically adjusted if
<code>remove_empty_rows</code> and <code>remove_empty_columns</code> are set to <code>TRUE</code>.</p>
</div>
<div id="oncoprint-annotations" class="section level3" number="7.2.3">
<h3>
<span class="header-section-number">7.2.3</span> OncoPrint annotations<a class="anchor" aria-label="anchor" href="#oncoprint-annotations"><i class="fas fa-link"></i></a>
</h3>
<p>The oncoPrint has several pre-defined annotations.</p>
<p>On top and right of the oncoPrint, there are barplots showing the number of
different alterations for each gene or for each sample, and on the left of the
oncoPrint is a text annotation showing the percent of samples that have
alterations for every gene.</p>
<p>The barplot annotation is implemented by <code>anno_oncoprint_barplot()</code> where you
can set the the annotation there. Barplots by default draw for all alteration
types, but you can also select subset of alterations to put on barplots by
setting in <code>anno_oncoprint_barplot()</code>. <code>anno_oncoprint_barplot()</code> is a simple
wrapper around <code>anno_barplot()</code> where the frequency matrix in just interanlly
calculated. See following example:</p>
<div class="sourceCode" id="cb553"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">oncoPrint</span><span class="op">(</span><span class="va">mat</span>,
    alter_fun <span class="op">=</span> <span class="va">alter_fun</span>, col <span class="op">=</span> <span class="va">col</span>, 
    top_annotation <span class="op">=</span> <span class="fu">HeatmapAnnotation</span><span class="op">(</span>
        column_barplot <span class="op">=</span> <span class="fu">anno_oncoprint_barplot</span><span class="op">(</span><span class="st">"MUT"</span>, border <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># only MUT</span>
            height <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">4</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>,
    right_annotation <span class="op">=</span> <span class="fu">rowAnnotation</span><span class="op">(</span>
        row_barplot <span class="op">=</span> <span class="fu">anno_oncoprint_barplot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AMP"</span>, <span class="st">"HOMDEL"</span><span class="op">)</span>,  <span class="co"># only AMP and HOMDEL</span>
            border <span class="op">=</span> <span class="cn">TRUE</span>, height <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">4</span>, <span class="st">"cm"</span><span class="op">)</span>, 
            axis_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>side <span class="op">=</span> <span class="st">"bottom"</span>, labels_rot <span class="op">=</span> <span class="fl">90</span><span class="op">)</span><span class="op">)</span>
    <span class="op">)</span>,
    remove_empty_columns <span class="op">=</span> <span class="cn">TRUE</span>, remove_empty_rows <span class="op">=</span> <span class="cn">TRUE</span>,
    column_title <span class="op">=</span> <span class="va">column_title</span>, heatmap_legend_param <span class="op">=</span> <span class="va">heatmap_legend_param</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="07-oncoprint_files/figure-html/unnamed-chunk-29-1.png" width="1152" style="display: block; margin: auto;"></div>
<p>By default the barplot annotation shows the frequencies. The values can be changed
to fraction by setting <code>show_fraction = TRUE</code> in <code>anno_oncoprint_barplot()</code>:</p>
<div class="sourceCode" id="cb554"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">oncoPrint</span><span class="op">(</span><span class="va">mat</span>,
    alter_fun <span class="op">=</span> <span class="va">alter_fun</span>, col <span class="op">=</span> <span class="va">col</span>, 
    top_annotation <span class="op">=</span> <span class="fu">HeatmapAnnotation</span><span class="op">(</span>
        column_barplot <span class="op">=</span> <span class="fu">anno_oncoprint_barplot</span><span class="op">(</span>show_fraction <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
    <span class="op">)</span>,
    right_annotation <span class="op">=</span> <span class="fu">rowAnnotation</span><span class="op">(</span>
        row_barplot <span class="op">=</span> <span class="fu">anno_oncoprint_barplot</span><span class="op">(</span>show_fraction <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
    <span class="op">)</span>,
    remove_empty_columns <span class="op">=</span> <span class="cn">TRUE</span>, remove_empty_rows <span class="op">=</span> <span class="cn">TRUE</span>,
    column_title <span class="op">=</span> <span class="va">column_title</span>, heatmap_legend_param <span class="op">=</span> <span class="va">heatmap_legend_param</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="07-oncoprint_files/figure-html/unnamed-chunk-30-1.png" width="1152" style="display: block; margin: auto;"></div>
<p>The percent values and row names are internally constructed as text
annotations. You can set <code>show_pct</code> and <code>show_row_names</code> to turn them on or
off. <code>pct_side</code> and <code>row_names_side</code> controls the sides where they are put.</p>
<div class="sourceCode" id="cb555"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">oncoPrint</span><span class="op">(</span><span class="va">mat</span>,
    alter_fun <span class="op">=</span> <span class="va">alter_fun</span>, col <span class="op">=</span> <span class="va">col</span>, 
    remove_empty_columns <span class="op">=</span> <span class="cn">TRUE</span>, remove_empty_rows <span class="op">=</span> <span class="cn">TRUE</span>,
    pct_side <span class="op">=</span> <span class="st">"right"</span>, row_names_side <span class="op">=</span> <span class="st">"left"</span>,
    column_title <span class="op">=</span> <span class="va">column_title</span>, heatmap_legend_param <span class="op">=</span> <span class="va">heatmap_legend_param</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="07-oncoprint_files/figure-html/unnamed-chunk-31-1.png" width="1152" style="display: block; margin: auto;"></div>
<p>The barplot annotation for oncoPrint are essentially normal annotations, you
can add more annotations in <code>HeatmapAnnotation()</code> or <code>rowAnnotation()</code> in the
normal way:</p>
<div class="sourceCode" id="cb556"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">oncoPrint</span><span class="op">(</span><span class="va">mat</span>,
    alter_fun <span class="op">=</span> <span class="va">alter_fun</span>, col <span class="op">=</span> <span class="va">col</span>, 
    remove_empty_columns <span class="op">=</span> <span class="cn">TRUE</span>, remove_empty_rows <span class="op">=</span> <span class="cn">TRUE</span>,
    top_annotation <span class="op">=</span> <span class="fu">HeatmapAnnotation</span><span class="op">(</span>cbar <span class="op">=</span> <span class="fu">anno_oncoprint_barplot</span><span class="op">(</span><span class="op">)</span>,
        foo1 <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">172</span>,
        bar1 <span class="op">=</span> <span class="fu">anno_points</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">172</span><span class="op">)</span>
    <span class="op">)</span>,
    left_annotation <span class="op">=</span> <span class="fu">rowAnnotation</span><span class="op">(</span>foo2 <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">26</span><span class="op">)</span>,
    right_annotation <span class="op">=</span> <span class="fu">rowAnnotation</span><span class="op">(</span>bar2 <span class="op">=</span> <span class="fu">anno_barplot</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">26</span><span class="op">)</span><span class="op">)</span>,
    column_title <span class="op">=</span> <span class="va">column_title</span>, heatmap_legend_param <span class="op">=</span> <span class="va">heatmap_legend_param</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="07-oncoprint_files/figure-html/unnamed-chunk-32-1.png" width="1152" style="display: block; margin: auto;"></div>
<p>As you see, the percent annotation, the row name annotation and the oncoPrint
annotation are appended to the user-specified annotation by default. Also
annotations are automatically adjusted if <code>remove_empty_columns</code> and
<code>remove_empty_rows</code> are set to <code>TRUE</code>.</p>
</div>
<div id="oncoprint-as-a-heatmap" class="section level3" number="7.2.4">
<h3>
<span class="header-section-number">7.2.4</span> oncoPrint as a Heatmap<a class="anchor" aria-label="anchor" href="#oncoprint-as-a-heatmap"><i class="fas fa-link"></i></a>
</h3>
<p><code>oncoPrint()</code> actually returns a <code>Heatmap</code> object, so you can add more
heatmaps and annotations horizontally or vertically to visualize more
complicated associations.</p>
<p>Following example adds a heatmap horizontally. Remember you can always add row
annotations to the heatmap list.</p>
<div class="sourceCode" id="cb557"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ht_list</span> <span class="op">=</span> <span class="fu">oncoPrint</span><span class="op">(</span><span class="va">mat</span>,
    alter_fun <span class="op">=</span> <span class="va">alter_fun</span>, col <span class="op">=</span> <span class="va">col</span>, 
    column_title <span class="op">=</span> <span class="va">column_title</span>, heatmap_legend_param <span class="op">=</span> <span class="va">heatmap_legend_param</span><span class="op">)</span> <span class="op">+</span>
<span class="fu">Heatmap</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">*</span><span class="fl">10</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"expr"</span>, width <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">4</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span>
<span class="fu">draw</span><span class="op">(</span><span class="va">ht_list</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="07-oncoprint_files/figure-html/unnamed-chunk-33-1.png" width="1152" style="display: block; margin: auto;"></div>
<p>or add it vertically:</p>
<div class="sourceCode" id="cb558"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ht_list</span> <span class="op">=</span> <span class="fu">oncoPrint</span><span class="op">(</span><span class="va">mat</span>,
    alter_fun <span class="op">=</span> <span class="va">alter_fun</span>, col <span class="op">=</span> <span class="va">col</span>, 
    column_title <span class="op">=</span> <span class="va">column_title</span>, heatmap_legend_param <span class="op">=</span> <span class="va">heatmap_legend_param</span><span class="op">)</span> <span class="op">%v%</span>
<span class="fu">Heatmap</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">*</span><span class="fl">10</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"expr"</span>, height <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">4</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span>
<span class="fu">draw</span><span class="op">(</span><span class="va">ht_list</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="07-oncoprint_files/figure-html/unnamed-chunk-34-1.png" width="1152" style="display: block; margin: auto;"></div>
<p>Similar as normal heatmap list, you can split the heatmap list:</p>
<div class="sourceCode" id="cb559"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ht_list</span> <span class="op">=</span> <span class="fu">oncoPrint</span><span class="op">(</span><span class="va">mat</span>,
    alter_fun <span class="op">=</span> <span class="va">alter_fun</span>, col <span class="op">=</span> <span class="va">col</span>, 
    column_title <span class="op">=</span> <span class="va">column_title</span>, heatmap_legend_param <span class="op">=</span> <span class="va">heatmap_legend_param</span><span class="op">)</span> <span class="op">+</span>
<span class="fu">Heatmap</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">*</span><span class="fl">10</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"expr"</span>, width <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">4</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span>
<span class="fu">draw</span><span class="op">(</span><span class="va">ht_list</span>, row_split <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="07-oncoprint_files/figure-html/unnamed-chunk-35-1.png" width="1152" style="display: block; margin: auto;"></div>
<p>When <code>remove_empty_columns</code> or <code>remove_empty_rows</code> is set to <code>TRUE</code>, the
number of genes or the samples may not be the original number. If the original
matrix has row names and column names. The subset of rows and columns can be
get as follows:</p>
<div class="sourceCode" id="cb560"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ht</span> <span class="op">=</span> <span class="fu">oncoPrint</span><span class="op">(</span><span class="va">mat</span>,
    alter_fun <span class="op">=</span> <span class="va">alter_fun</span>, col <span class="op">=</span> <span class="va">col</span>, 
    remove_empty_columns <span class="op">=</span> <span class="cn">TRUE</span>, remove_empty_rows <span class="op">=</span> <span class="cn">TRUE</span>,
    column_title <span class="op">=</span> <span class="va">column_title</span>, heatmap_legend_param <span class="op">=</span> <span class="va">heatmap_legend_param</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">ht</span><span class="op">@</span><span class="va">matrix</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] "KRAS"   "HRAS"   "BRAF"   "RAF1"   "MAP3K1" "MAP3K2" "MAP3K3" "MAP3K4"
##  [9] "MAP3K5" "MAP2K1" "MAP2K2" "MAP2K3" "MAP2K4" "MAPK3"  "MAPK4"  "MAPK7" 
## [17] "MAPK8"  "MAPK9"  "MAPK12" "MAPK14" "DAB2"   "RAB25"</code></pre>
<div class="sourceCode" id="cb562"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">ht</span><span class="op">@</span><span class="va">matrix</span><span class="op">)</span></code></pre></div>
<pre><code>##   [1] "TCGA-05-4390-01" "TCGA-38-4631-01" "TCGA-44-6144-01" "TCGA-44-6145-01"
##   [5] "TCGA-44-6146-01" "TCGA-49-4488-01" "TCGA-50-5930-01" "TCGA-50-5931-01"
##   [9] "TCGA-50-5932-01" "TCGA-50-5933-01" "TCGA-50-5941-01" "TCGA-50-5942-01"
##  [13] "TCGA-50-5944-01" "TCGA-50-5946-01" "TCGA-50-6591-01" "TCGA-50-6592-01"
##  [17] "TCGA-50-6594-01" "TCGA-67-4679-01" "TCGA-67-6215-01" "TCGA-73-4658-01"
##  [21] "TCGA-73-4676-01" "TCGA-75-5122-01" "TCGA-75-5125-01" "TCGA-75-5126-01"
##  [25] "TCGA-75-6206-01" "TCGA-75-6211-01" "TCGA-86-6562-01" "TCGA-05-4396-01"
##  [29] "TCGA-05-4405-01" "TCGA-05-4410-01" "TCGA-05-4415-01" "TCGA-05-4417-01"
##  [33] "TCGA-05-4424-01" "TCGA-05-4427-01" "TCGA-05-4433-01" "TCGA-44-6774-01"
##  [37] "TCGA-44-6775-01" "TCGA-44-6776-01" "TCGA-44-6777-01" "TCGA-44-6778-01"
##  [41] "TCGA-49-4487-01" "TCGA-49-4490-01" "TCGA-49-6744-01" "TCGA-49-6745-01"
##  [45] "TCGA-49-6767-01" "TCGA-50-5044-01" "TCGA-50-5051-01" "TCGA-50-5072-01"
##  [49] "TCGA-50-6590-01" "TCGA-55-6642-01" "TCGA-55-6712-01" "TCGA-71-6725-01"
##  [53] "TCGA-91-6828-01" "TCGA-91-6829-01" "TCGA-91-6835-01" "TCGA-91-6836-01"
##  [57] "TCGA-35-3615-01" "TCGA-44-2655-01" "TCGA-44-2656-01" "TCGA-44-2662-01"
##  [61] "TCGA-44-2666-01" "TCGA-44-2668-01" "TCGA-55-1592-01" "TCGA-55-1594-01"
##  [65] "TCGA-55-1595-01" "TCGA-64-1676-01" "TCGA-64-1677-01" "TCGA-64-1678-01"
##  [69] "TCGA-64-1680-01" "TCGA-67-3771-01" "TCGA-67-3773-01" "TCGA-67-3774-01"
##  [73] "TCGA-05-4244-01" "TCGA-05-4249-01" "TCGA-05-4250-01" "TCGA-35-4122-01"
##  [77] "TCGA-35-4123-01" "TCGA-44-2657-01" "TCGA-44-3398-01" "TCGA-44-3918-01"
##  [81] "TCGA-05-4382-01" "TCGA-05-4389-01" "TCGA-05-4395-01" "TCGA-05-4397-01"
##  [85] "TCGA-05-4398-01" "TCGA-05-4402-01" "TCGA-05-4403-01" "TCGA-05-4418-01"
##  [89] "TCGA-05-4420-01" "TCGA-05-4422-01" "TCGA-05-4426-01" "TCGA-05-4430-01"
##  [93] "TCGA-05-4434-01" "TCGA-38-4625-01" "TCGA-38-4626-01" "TCGA-38-4628-01"
##  [97] "TCGA-38-4630-01" "TCGA-44-3396-01" "TCGA-49-4486-01" "TCGA-49-4505-01"
## [101] "TCGA-49-4506-01" "TCGA-49-4507-01" "TCGA-49-4510-01" "TCGA-73-4659-01"
## [105] "TCGA-73-4662-01" "TCGA-73-4668-01" "TCGA-73-4670-01" "TCGA-73-4677-01"
## [109] "TCGA-05-5428-01" "TCGA-05-5715-01" "TCGA-50-5045-01" "TCGA-50-5049-01"
## [113] "TCGA-50-5936-01" "TCGA-55-5899-01" "TCGA-64-5774-01" "TCGA-64-5775-01"
## [117] "TCGA-64-5778-01" "TCGA-64-5815-01" "TCGA-75-5146-01" "TCGA-75-5147-01"
## [121] "TCGA-80-5611-01"</code></pre>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="heatmap-decoration.html"><span class="header-section-number">6</span> Heatmap Decoration</a></div>
<div class="next"><a href="upset-plot.html"><span class="header-section-number">8</span> UpSet plot</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#oncoprint"><span class="header-section-number">7</span> OncoPrint</a></li>
<li>
<a class="nav-link" href="#oncoprint-general-settings"><span class="header-section-number">7.1</span> General settings</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#input-data-format"><span class="header-section-number">7.1.1</span> Input data format</a></li>
<li><a class="nav-link" href="#define-the-alter-fun"><span class="header-section-number">7.1.2</span> Define the alter_fun()</a></li>
<li><a class="nav-link" href="#oncoprint-background"><span class="header-section-number">7.1.3</span> Background</a></li>
<li><a class="nav-link" href="#complex-alteration-types"><span class="header-section-number">7.1.4</span> Complex alteration types</a></li>
<li><a class="nav-link" href="#simplify-alter_fun"><span class="header-section-number">7.1.5</span> Simplify alter_fun</a></li>
<li><a class="nav-link" href="#other-heatmap-related-settings"><span class="header-section-number">7.1.6</span> Other heatmap-related settings</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#apply-to-cbioportal-dataset"><span class="header-section-number">7.2</span> Apply to cBioPortal dataset</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#remove-empty-rows-and-columns"><span class="header-section-number">7.2.1</span> Remove empty rows and columns</a></li>
<li><a class="nav-link" href="#reorder-the-oncoprint"><span class="header-section-number">7.2.2</span> Reorder the oncoPrint</a></li>
<li><a class="nav-link" href="#oncoprint-annotations"><span class="header-section-number">7.2.3</span> OncoPrint annotations</a></li>
<li><a class="nav-link" href="#oncoprint-as-a-heatmap"><span class="header-section-number">7.2.4</span> oncoPrint as a Heatmap</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/jokergoo/ComplexHeatmap/blob/master/07-oncoprint.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/jokergoo/ComplexHeatmap/edit/master/07-oncoprint.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>ComplexHeatmap Complete Reference</strong>" was written by Zuguang Gu. It was last built on last revised on 2022-07-31.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
