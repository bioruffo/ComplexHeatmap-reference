<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 4 A List of Heatmaps | ComplexHeatmap Complete Reference</title>
<meta name="author" content="Zuguang Gu">
<meta name="description" content="The main feature of ComplexHeatmap package is it supports to concatenate a list of heatmaps and annotations horizontally or vertically so that it makes it possible to visualize the associations...">
<meta name="generator" content="bookdown 0.27 with bs4_book()">
<meta property="og:title" content="Chapter 4 A List of Heatmaps | ComplexHeatmap Complete Reference">
<meta property="og:type" content="book">
<meta property="og:url" content="https://jokergoo.github.io/ComplexHeatmap-reference/book/a-list-of-heatmaps.html">
<meta property="og:image" content="https://jokergoo.github.io/ComplexHeatmap-reference/book/complexheatmap-cover.jpg">
<meta property="og:description" content="The main feature of ComplexHeatmap package is it supports to concatenate a list of heatmaps and annotations horizontally or vertically so that it makes it possible to visualize the associations...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 4 A List of Heatmaps | ComplexHeatmap Complete Reference">
<meta name="twitter:description" content="The main feature of ComplexHeatmap package is it supports to concatenate a list of heatmaps and annotations horizontally or vertically so that it makes it possible to visualize the associations...">
<meta name="twitter:image" content="https://jokergoo.github.io/ComplexHeatmap-reference/book/complexheatmap-cover.jpg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><style>
    #content {
    	font-size: 0.95rem;
    }
    </style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">ComplexHeatmap Complete Reference</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">About</a></li>
<li><a class="" href="introduction.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="a-single-heatmap.html"><span class="header-section-number">2</span> A Single Heatmap</a></li>
<li><a class="" href="heatmap-annotations.html"><span class="header-section-number">3</span> Heatmap Annotations</a></li>
<li><a class="active" href="a-list-of-heatmaps.html"><span class="header-section-number">4</span> A List of Heatmaps</a></li>
<li><a class="" href="legends.html"><span class="header-section-number">5</span> Legends</a></li>
<li><a class="" href="heatmap-decoration.html"><span class="header-section-number">6</span> Heatmap Decoration</a></li>
<li><a class="" href="oncoprint.html"><span class="header-section-number">7</span> OncoPrint</a></li>
<li><a class="" href="upset-plot.html"><span class="header-section-number">8</span> UpSet plot</a></li>
<li><a class="" href="interactive.html"><span class="header-section-number">9</span> Interactive ComplexHeatmap</a></li>
<li><a class="" href="integrate-with-other-packages.html"><span class="header-section-number">10</span> Integrate with other packages</a></li>
<li><a class="" href="other-high-level-plots.html"><span class="header-section-number">11</span> Other High-level Plots</a></li>
<li><a class="" href="three-d-heatmap.html"><span class="header-section-number">12</span> Three-dimensional ComplexHeatmap</a></li>
<li><a class="" href="genome-level-heatmap.html"><span class="header-section-number">13</span> Genome-level heatmap</a></li>
<li><a class="" href="more-examples.html"><span class="header-section-number">14</span> More Examples</a></li>
<li><a class="" href="other-tricks.html"><span class="header-section-number">15</span> Other Tricks</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/jokergoo/ComplexHeatmap">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="a-list-of-heatmaps" class="section level1" number="4">
<h1>
<span class="header-section-number">4</span> A List of Heatmaps<a class="anchor" aria-label="anchor" href="#a-list-of-heatmaps"><i class="fas fa-link"></i></a>
</h1>
<p>The main feature of <strong>ComplexHeatmap</strong> package is it supports to concatenate a
list of heatmaps and annotations horizontally or vertically so that it makes
it possible to visualize the associations from various sources of information.
In this chapter, we mainly introduce the horizontal concatenation because this
is the major case we will use in the analysis. In the end we show some
examples of vertical concatenation. The concept behind for horizontal and
vertical concatenation basically is similar.</p>
<p>For the horizontal concatenation, the number of rows for all heatmaps and
annotations should be the same. In following we first introduce the
concatenation of heatmaps and later we will show how to concatenate heatmaps
with annotations.</p>
<p>In following example, there are three matrices where the third heatmap is a
vector and it will be transformed as a one-column matrix. The one-column
heatmap is sometimes useful when you concatenate a list of heatmaps that it
can show e.g. annotations for each row or some scores of each row. E.g. if
rows are genes, the type of the genes (i.e. protein coding or not) can be
represented as a one-column character matrix, and the p-value or the fold
change from differential expression analysis can be represented as a
one-column numeric matrix, and be concatenated to the main expression heatmap.</p>
<div class="sourceCode" id="cb363"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>
<span class="va">mat1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fl">8</span>, <span class="fl">10</span><span class="op">)</span>
<span class="va">mat1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">mat1</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">40</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span>, <span class="fl">4</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">mat1</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">mat1</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>

<span class="va">mat2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">60</span>, max <span class="op">=</span> <span class="fl">3</span>, min <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, <span class="fl">6</span>, <span class="fl">10</span><span class="op">)</span>
<span class="va">mat2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">mat2</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">60</span>, max <span class="op">=</span> <span class="fl">2</span>, min <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, <span class="fl">6</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">mat2</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">mat2</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>

<span class="va">le</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="fl">12</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">le</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>

<span class="va">ind</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">12</span><span class="op">)</span>
<span class="va">mat1</span> <span class="op">=</span> <span class="va">mat1</span><span class="op">[</span><span class="va">ind</span>, <span class="op">]</span>
<span class="va">mat2</span> <span class="op">=</span> <span class="va">mat2</span><span class="op">[</span><span class="va">ind</span>, <span class="op">]</span>
<span class="va">le</span> <span class="op">=</span> <span class="va">le</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span></code></pre></div>
<p>To concatenate heatmaps, simply use <code>+</code> operator.</p>
<div class="sourceCode" id="cb364"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ht1</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat1</span>, name <span class="op">=</span> <span class="st">"rnorm"</span><span class="op">)</span>
<span class="va">ht2</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat2</span>, name <span class="op">=</span> <span class="st">"runif"</span><span class="op">)</span>
<span class="va">ht3</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">le</span>, name <span class="op">=</span> <span class="st">"letters"</span><span class="op">)</span>

<span class="va">ht1</span> <span class="op">+</span> <span class="va">ht2</span> <span class="op">+</span> <span class="va">ht3</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-2-1.png" width="864" style="display: block; margin: auto;"></div>
<p>Under default mode, dendrograms from the second heatmap will be removed and
row orders will be the same as the first one. Also row names for the first two
heatmaps are removed as well.</p>
<p>The returned value of the concatenation is a <code>HeatmapList</code> object. Similar as
explained in Section <a href="a-single-heatmap.html#plot-the-heatmap">2.11</a>, directly printing <code>ht_list</code> will
call <code>draw()</code> method with default settings. With explicitly calling <code>draw()</code>
method, you can have more controls on the heatmap list.</p>
<div class="sourceCode" id="cb365"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ht_list</span> <span class="op">=</span> <span class="va">ht1</span> <span class="op">+</span> <span class="va">ht2</span> <span class="op">+</span> <span class="va">ht3</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">ht_list</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "HeatmapList"
## attr(,"package")
## [1] "ComplexHeatmap"</code></pre>
<p>You can append any number of heatmaps to the heatmap list. Also you can append
a heatmap list to a heatmap list.</p>
<div class="sourceCode" id="cb367"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># code only for demonstration</span>
<span class="va">ht1</span> <span class="op">+</span> <span class="va">ht_list</span>
<span class="va">ht_list</span> <span class="op">+</span> <span class="va">ht1</span>
<span class="va">ht_list</span> <span class="op">+</span> <span class="va">ht_list</span></code></pre></div>
<p><code>NULL</code> can be added to the heatmap list. It would be convinient when users
want to construct a heatmap list through a <code>for</code> loop.</p>
<div class="sourceCode" id="cb368"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># code only for demonstration</span>
<span class="va">ht_list</span> <span class="op">=</span> <span class="cn">NULL</span>  <span class="co">## Heatmap(...) + NULL gives you a HeatmapList object</span>
<span class="kw">for</span><span class="op">(</span><span class="va">s</span> <span class="kw">in</span> <span class="va">sth</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">ht_list</span> <span class="op">=</span> <span class="va">ht_list</span> <span class="op">+</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">...</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>You can also add heatmap annotations to the heatmap list, see more details in
Section <a href="a-list-of-heatmaps.html#concatenate-with-annotations">4.7</a>.</p>
<div id="heatmap-list-titles" class="section level2" number="4.1">
<h2>
<span class="header-section-number">4.1</span> Titles<a class="anchor" aria-label="anchor" href="#heatmap-list-titles"><i class="fas fa-link"></i></a>
</h2>
<p>A heatmap list also has title which is like a global title covering all
heatmaps. <code>row_title</code> and <code>column_title</code> should be set in the <code>draw()</code>
function.</p>
<p>From following example, we set different colors for each heatmap to make them
distinguishable.</p>
<div class="sourceCode" id="cb369"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">col_rnorm</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html">colorRamp2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"green"</span>, <span class="st">"white"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span>
<span class="va">col_runif</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html">colorRamp2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"orange"</span><span class="op">)</span><span class="op">)</span>
<span class="va">col_letters</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span> <span class="op">=</span> <span class="st">"pink"</span>, <span class="st">"b"</span> <span class="op">=</span> <span class="st">"purple"</span>, <span class="st">"c"</span> <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span>
<span class="va">ht1</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat1</span>, name <span class="op">=</span> <span class="st">"rnorm"</span>, col <span class="op">=</span> <span class="va">col_rnorm</span>,
    row_title <span class="op">=</span> <span class="st">"Heatmap 1"</span>, column_title <span class="op">=</span> <span class="st">"Heatmap 1"</span><span class="op">)</span>
<span class="va">ht2</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat2</span>, name <span class="op">=</span> <span class="st">"runif"</span>, col <span class="op">=</span> <span class="va">col_runif</span>,
    row_title <span class="op">=</span> <span class="st">"Heatmap 2"</span>, column_title <span class="op">=</span> <span class="st">"Heatmap 2"</span><span class="op">)</span>
<span class="va">ht3</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">le</span>, name <span class="op">=</span> <span class="st">"letters"</span>, col <span class="op">=</span> <span class="va">col_letters</span><span class="op">)</span>
<span class="va">ht_list</span> <span class="op">=</span> <span class="va">ht1</span> <span class="op">+</span> <span class="va">ht2</span> <span class="op">+</span> <span class="va">ht3</span>

<span class="fu">draw</span><span class="op">(</span><span class="va">ht_list</span>, row_title <span class="op">=</span> <span class="st">"Three heatmaps, row title"</span>, row_title_gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>,
    column_title <span class="op">=</span> <span class="st">"Three heatmaps, column title"</span>, column_title_gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">16</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/heatmap_list_title-1.png" width="864" style="display: block; margin: auto;"></div>
<p>You can use <code>gt_render()</code> to construct complicated text, see Section <a href="integrate-with-other-packages.html#gridtext">10.3</a>.</p>
</div>
<div id="size-of-heatmaps" class="section level2" number="4.2">
<h2>
<span class="header-section-number">4.2</span> Size of heatmaps<a class="anchor" aria-label="anchor" href="#size-of-heatmaps"><i class="fas fa-link"></i></a>
</h2>
<p>The width for some heatmaps can be set to absolute units. Note <code>width</code>
controls the width of the heatmap body.</p>
<div class="sourceCode" id="cb370"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ht2</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat2</span>, name <span class="op">=</span> <span class="st">"runif"</span>, col <span class="op">=</span> <span class="va">col_runif</span>, width <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">4</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span>
<span class="va">ht3</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">le</span>, name <span class="op">=</span> <span class="st">"letters"</span>, col <span class="op">=</span> <span class="va">col_letters</span>, width <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">5</span>, <span class="st">"mm"</span><span class="op">)</span><span class="op">)</span>
<span class="va">ht1</span> <span class="op">+</span> <span class="va">ht2</span> <span class="op">+</span> <span class="va">ht3</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/heatmap_list_size-1.png" width="864" style="display: block; margin: auto;"></div>
<p>The width of all heatmaps can be set as absolute units.</p>
<div class="sourceCode" id="cb371"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ht1</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat1</span>, name <span class="op">=</span> <span class="st">"rnorm"</span>, col <span class="op">=</span> <span class="va">col_rnorm</span>, width <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">4</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span>
<span class="va">ht2</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat2</span>, name <span class="op">=</span> <span class="st">"runif"</span>, col <span class="op">=</span> <span class="va">col_runif</span>, width <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">6</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span>
<span class="va">ht3</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">le</span>, name <span class="op">=</span> <span class="st">"letters"</span>, col <span class="op">=</span> <span class="va">col_letters</span>, width <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">1</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span>
<span class="va">ht1</span> <span class="op">+</span> <span class="va">ht2</span> <span class="op">+</span> <span class="va">ht3</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/heatmap_list_relative_size-1.png" width="864" style="display: block; margin: auto;"></div>
<p>If <code>width</code> is numeric, it is converted as a <code>null</code> unit.</p>
<div class="sourceCode" id="cb372"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ht1</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat1</span>, name <span class="op">=</span> <span class="st">"rnorm"</span>, col <span class="op">=</span> <span class="va">col_rnorm</span>, width <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>
<span class="va">ht2</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat2</span>, name <span class="op">=</span> <span class="st">"runif"</span>, col <span class="op">=</span> <span class="va">col_runif</span>, width <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="va">ht3</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">le</span>, name <span class="op">=</span> <span class="st">"letters"</span>, col <span class="op">=</span> <span class="va">col_letters</span>, width <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">ht1</span> <span class="op">+</span> <span class="va">ht2</span> <span class="op">+</span> <span class="va">ht3</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-6-1.png" width="864" style="display: block; margin: auto;"></div>
<p><code>heatmap_width</code> also can control the width of the heatmap, but it is the total
width of the heatmap body plus the heatmap components.</p>
</div>
<div id="gap-between-heatmaps" class="section level2" number="4.3">
<h2>
<span class="header-section-number">4.3</span> Gap between heatmaps<a class="anchor" aria-label="anchor" href="#gap-between-heatmaps"><i class="fas fa-link"></i></a>
</h2>
<p><code>ht_gap</code> controls the space between heatmaps. The value can be a single unit
or a vector of units.</p>
<div class="sourceCode" id="cb373"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ht1</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat1</span>, name <span class="op">=</span> <span class="st">"rnorm"</span>, col <span class="op">=</span> <span class="va">col_rnorm</span><span class="op">)</span>
<span class="va">ht2</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat2</span>, name <span class="op">=</span> <span class="st">"runif"</span>, col <span class="op">=</span> <span class="va">col_runif</span><span class="op">)</span>
<span class="va">ht3</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">le</span>, name <span class="op">=</span> <span class="st">"letters"</span>, col <span class="op">=</span> <span class="va">col_letters</span><span class="op">)</span>
<span class="va">ht_list</span> <span class="op">=</span> <span class="va">ht1</span> <span class="op">+</span> <span class="va">ht2</span> <span class="op">+</span> <span class="va">ht3</span>
<span class="fu">draw</span><span class="op">(</span><span class="va">ht_list</span>, ht_gap <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">1</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/heatmap_list_gap-1.png" width="864" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb374"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">draw</span><span class="op">(</span><span class="va">ht_list</span>, ht_gap <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">10</span><span class="op">)</span>, <span class="st">"mm"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/heatmap_list_gap-2.png" width="864" style="display: block; margin: auto;"></div>
</div>
<div id="automatic-adjustment-to-the-main-heatmap" class="section level2" number="4.4">
<h2>
<span class="header-section-number">4.4</span> Automatic adjustment to the main heatmap<a class="anchor" aria-label="anchor" href="#automatic-adjustment-to-the-main-heatmap"><i class="fas fa-link"></i></a>
</h2>
<p>There is always a main heatmap in the heatmap list that controls the global
row ordering. All the other heatmaps are automatically adjusted according to
the settings in the main heatmap. For these non-main heatmaps, the adjustments
are:</p>
<ul>
<li>No row clustering is performed and they all take the row ordering of the
main heatmap.</li>
<li>Row titles are removed.</li>
<li>If the main heatmap is split by rows, all other heatmaps will also be split
by same levels as the main heatmap.</li>
<li>The height of the main heatmap are taken as the height of all heatmaps.</li>
</ul>
<p>By default, the first heatmap is taken as the main heatmap.</p>
<div class="sourceCode" id="cb375"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ht1</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat1</span>, name <span class="op">=</span> <span class="st">"rnorm"</span>, col <span class="op">=</span> <span class="va">col_rnorm</span>, row_km <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">ht2</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat2</span>, name <span class="op">=</span> <span class="st">"runif"</span>, col <span class="op">=</span> <span class="va">col_runif</span><span class="op">)</span>
<span class="va">ht3</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">le</span>, name <span class="op">=</span> <span class="st">"letters"</span>, col <span class="op">=</span> <span class="va">col_letters</span><span class="op">)</span>
<span class="va">ht2</span> <span class="op">+</span> <span class="va">ht1</span> <span class="op">+</span> <span class="va">ht3</span> <span class="co"># ht2 is the main heatmap and row_km in ht1 is ignored</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/heatmap_list_auto_adjust-1.png" width="864" style="display: block; margin: auto;"></div>
<p>The main heatmap can be specified by <code>main_heatmap</code> argument. The value can be
a numeric index or the name of the heatmap (of course, you need to set the
heatmap name when you create the <code>Heatmap</code> object). In following example,
although <code>ht1</code> is the second heatmap, we can set it as the main heatmap.</p>
<div class="sourceCode" id="cb376"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ht_list</span> <span class="op">=</span> <span class="va">ht2</span> <span class="op">+</span> <span class="va">ht1</span> <span class="op">+</span> <span class="va">ht3</span>
<span class="fu">draw</span><span class="op">(</span><span class="va">ht_list</span>, main_heatmap <span class="op">=</span> <span class="st">"rnorm"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-7-1.png" width="864" style="display: block; margin: auto;"></div>
<p>By default, the dendrogram and the row title are plotted just beside the main
heatmap, just to emphasize the clustering or the splitting is calculated from
the main heatmap while not other heatmaps. However, the position of the
dendrogram and row title of the main heatmap can be controlled by
<code>row_dend_side</code> and <code>row_sub_title_side</code> in <code>draw()</code> function.</p>
<div class="sourceCode" id="cb377"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ht_list</span> <span class="op">=</span> <span class="va">ht2</span> <span class="op">+</span> <span class="va">ht1</span> <span class="op">+</span> <span class="va">ht3</span>
<span class="fu">draw</span><span class="op">(</span><span class="va">ht_list</span>, main_heatmap <span class="op">=</span> <span class="st">"rnorm"</span>, row_dend_side <span class="op">=</span> <span class="st">"right"</span>, row_sub_title_side <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-8-1.png" width="864" style="display: block; margin: auto;"></div>
<p>Similarly, if there is no row clustering in the main heatmap, all other
heatmaps are not clustered neither.</p>
<div class="sourceCode" id="cb378"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ht1</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat1</span>, name <span class="op">=</span> <span class="st">"rnorm"</span>, col <span class="op">=</span> <span class="va">col_rnorm</span>, cluster_rows <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">ht2</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat2</span>, name <span class="op">=</span> <span class="st">"runif"</span>, col <span class="op">=</span> <span class="va">col_runif</span><span class="op">)</span>
<span class="va">ht3</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">le</span>, name <span class="op">=</span> <span class="st">"letters"</span>, col <span class="op">=</span> <span class="va">col_letters</span><span class="op">)</span>
<span class="va">ht1</span> <span class="op">+</span> <span class="va">ht2</span> <span class="op">+</span> <span class="va">ht3</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/heatmap_list_auto_adjust_no_row_cluster-1.png" width="864" style="display: block; margin: auto;"></div>
<p>As you may have observed, all the row names between heatmaps are removed from
the plot. You can show them by setting <code>auto_adjust = FALSE</code>.</p>
<div class="sourceCode" id="cb379"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ht1</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat1</span>, name <span class="op">=</span> <span class="st">"rnorm"</span>, col <span class="op">=</span> <span class="va">col_rnorm</span><span class="op">)</span>
<span class="va">ht2</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat2</span>, name <span class="op">=</span> <span class="st">"runif"</span>, col <span class="op">=</span> <span class="va">col_runif</span><span class="op">)</span>
<span class="va">ht3</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">le</span>, name <span class="op">=</span> <span class="st">"letters"</span>, col <span class="op">=</span> <span class="va">col_letters</span><span class="op">)</span>
<span class="va">ht_list</span> <span class="op">=</span> <span class="va">ht1</span> <span class="op">+</span> <span class="va">ht2</span> <span class="op">+</span> <span class="va">ht3</span>
<span class="fu">draw</span><span class="op">(</span><span class="va">ht_list</span>, auto_adjust <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-9-1.png" width="864" style="display: block; margin: auto;"></div>
</div>
<div id="control-main-heatmap-in-draw-function" class="section level2" number="4.5">
<h2>
<span class="header-section-number">4.5</span> Control main heatmap in draw() function<a class="anchor" aria-label="anchor" href="#control-main-heatmap-in-draw-function"><i class="fas fa-link"></i></a>
</h2>
<p>Settings of the main heatmap can be controlled in the main <code>Heatmap()</code>
function. To make it convinient, settings that affect heatmap rows can also be
directly set in <code>draw()</code>. If some of these settings are set, corresponding
settings in the main <code>Heatmap()</code> will be overwritten.</p>
<p>In <code>draw()</code> function, following main heatmap settings control row orders of
all heatmaps.</p>
<ul>
<li><code>cluster_rows</code></li>
<li><code>clustering_distance_rows</code></li>
<li><code>clustering_method_rows</code></li>
<li><code>row_dend_width</code></li>
<li><code>show_row_dend</code></li>
<li><code>row_dend_reorder</code></li>
<li><code>row_dend_gp</code></li>
<li><code>row_order</code></li>
</ul>
<p>Following settings control the row slices.</p>
<ul>
<li><code>row_gap</code></li>
<li><code>row_km</code></li>
<li><code>row_km_repeats</code></li>
<li><code>row_split</code></li>
</ul>
<p>Following settings control the heatmap height.</p>
<ul>
<li><code>height</code></li>
<li><code>heatmap_height</code></li>
</ul>
<p>In following example, <code>row_km = 2, cluster_rows = FALSE</code> for <code>ht1</code> is
overwritten in <code>draw()</code>.</p>
<div class="sourceCode" id="cb380"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ht1</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat1</span>, name <span class="op">=</span> <span class="st">"rnorm"</span>, col <span class="op">=</span> <span class="va">col_rnorm</span>, row_km <span class="op">=</span> <span class="fl">2</span>, cluster_rows <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">ht2</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat2</span>, name <span class="op">=</span> <span class="st">"runif"</span>, col <span class="op">=</span> <span class="va">col_runif</span><span class="op">)</span>
<span class="va">ht3</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">le</span>, name <span class="op">=</span> <span class="st">"letters"</span>, col <span class="op">=</span> <span class="va">col_letters</span><span class="op">)</span>
<span class="va">ht_list</span> <span class="op">=</span> <span class="va">ht1</span> <span class="op">+</span> <span class="va">ht2</span> <span class="op">+</span> <span class="va">ht3</span>
<span class="fu">draw</span><span class="op">(</span><span class="va">ht_list</span>, row_km <span class="op">=</span> <span class="fl">1</span>, row_split <span class="op">=</span> <span class="va">le</span>, cluster_rows <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-10-1.png" width="864" style="display: block; margin: auto;"></div>
</div>
<div id="annotations-as-components-are-adjusted" class="section level2" number="4.6">
<h2>
<span class="header-section-number">4.6</span> Annotations as components are adjusted<a class="anchor" aria-label="anchor" href="#annotations-as-components-are-adjusted"><i class="fas fa-link"></i></a>
</h2>
<p>If some of the heatmaps in the heatmap list have annotations, in most of the
cases, the heights of the heatmap annotations are different for different
heatmaps. There are automatic adjustment for heatmap annotations, and this
adjustment will also involve adjustment of dendrograms.</p>
<p>Normally, the size of simple annotations will not change in the adjustment. In
following example, the dendrogram for the second heatmap is adjusted. Note you
still can change the size of simple annotation by setting <code>anno_simple_size</code>
in <code>HeatmapAnnotation()</code> or globally set <code>ht_opt$anno_simple_size</code>.</p>
<div class="sourceCode" id="cb381"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ha1</span> <span class="op">=</span> <span class="fu">HeatmapAnnotation</span><span class="op">(</span>foo1 <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, annotation_name_side <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span>
<span class="va">ht1</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat1</span>, name <span class="op">=</span> <span class="st">"rnorm"</span>, col <span class="op">=</span> <span class="va">col_rnorm</span>, top_annotation <span class="op">=</span> <span class="va">ha1</span><span class="op">)</span>
<span class="va">ht2</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat2</span>, name <span class="op">=</span> <span class="st">"runif"</span>, col <span class="op">=</span> <span class="va">col_runif</span><span class="op">)</span>
<span class="va">ht3</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">le</span>, name <span class="op">=</span> <span class="st">"letters"</span>, col <span class="op">=</span> <span class="va">col_letters</span><span class="op">)</span>
<span class="va">ht1</span> <span class="op">+</span> <span class="va">ht2</span> <span class="op">+</span> <span class="va">ht3</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;"></div>
<p>If the first two heatmaps all have annotations, since the size of simple
annotations keep unchanged, the size of complex annotations will be adjusted
to make the total heights of the two heatmap annotations the same.</p>
<div class="sourceCode" id="cb382"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ha1</span> <span class="op">=</span> <span class="fu">HeatmapAnnotation</span><span class="op">(</span>foo1 <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, bar1 <span class="op">=</span> <span class="fu">anno_points</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, 
    annotation_name_side <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span>
<span class="va">ha2</span> <span class="op">=</span> <span class="fu">HeatmapAnnotation</span><span class="op">(</span>bar2 <span class="op">=</span> <span class="fu">anno_barplot</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span>
<span class="va">ht1</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat1</span>, name <span class="op">=</span> <span class="st">"rnorm"</span>, col <span class="op">=</span> <span class="va">col_rnorm</span>, top_annotation <span class="op">=</span> <span class="va">ha1</span><span class="op">)</span>
<span class="va">ht2</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat2</span>, name <span class="op">=</span> <span class="st">"runif"</span>, col <span class="op">=</span> <span class="va">col_runif</span>, top_annotation <span class="op">=</span> <span class="va">ha2</span><span class="op">)</span>
<span class="va">ht3</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">le</span>, name <span class="op">=</span> <span class="st">"letters"</span>, col <span class="op">=</span> <span class="va">col_letters</span><span class="op">)</span>
<span class="va">ht_list</span> <span class="op">=</span> <span class="va">ht1</span> <span class="op">+</span> <span class="va">ht2</span> <span class="op">+</span> <span class="va">ht3</span>
<span class="fu">draw</span><span class="op">(</span><span class="va">ht_list</span>, ht_gap <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"mm"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-12-1.png" width="864" style="display: block; margin: auto;"></div>
<p>Similarly, if the first heatmap only contains simple annotatins, dendrogram
will be adjusted.</p>
<div class="sourceCode" id="cb383"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ha1</span> <span class="op">=</span> <span class="fu">HeatmapAnnotation</span><span class="op">(</span>foo1 <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, annotation_name_side <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span>
<span class="va">ha2</span> <span class="op">=</span> <span class="fu">HeatmapAnnotation</span><span class="op">(</span>bar2 <span class="op">=</span> <span class="fu">anno_barplot</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, height <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">2</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">ht1</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat1</span>, name <span class="op">=</span> <span class="st">"rnorm"</span>, col <span class="op">=</span> <span class="va">col_rnorm</span>, top_annotation <span class="op">=</span> <span class="va">ha1</span><span class="op">)</span>
<span class="va">ht2</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat2</span>, name <span class="op">=</span> <span class="st">"runif"</span>, col <span class="op">=</span> <span class="va">col_runif</span>, top_annotation <span class="op">=</span> <span class="va">ha2</span><span class="op">)</span>
<span class="va">ht3</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">le</span>, name <span class="op">=</span> <span class="st">"letters"</span>, col <span class="op">=</span> <span class="va">col_letters</span><span class="op">)</span>
<span class="va">ht_list</span> <span class="op">=</span> <span class="va">ht1</span> <span class="op">+</span> <span class="va">ht2</span> <span class="op">+</span> <span class="va">ht3</span>
<span class="fu">draw</span><span class="op">(</span><span class="va">ht_list</span>, ht_gap <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"mm"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-13-1.png" width="864" style="display: block; margin: auto;"></div>
<p>If the both heatmaps only contain simple annotations but with unequal number,
dendrogram will be adjusted.</p>
<div class="sourceCode" id="cb384"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ha1</span> <span class="op">=</span> <span class="fu">HeatmapAnnotation</span><span class="op">(</span>foo1 <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, annotation_name_side <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span>
<span class="va">ha2</span> <span class="op">=</span> <span class="fu">HeatmapAnnotation</span><span class="op">(</span>bar2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>b1 <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, b2 <span class="op">=</span> <span class="fl">11</span><span class="op">:</span><span class="fl">20</span>, b3 <span class="op">=</span> <span class="fl">21</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span><span class="op">)</span>
<span class="va">ht1</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat1</span>, name <span class="op">=</span> <span class="st">"rnorm"</span>, col <span class="op">=</span> <span class="va">col_rnorm</span>, top_annotation <span class="op">=</span> <span class="va">ha1</span><span class="op">)</span>
<span class="va">ht2</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat2</span>, name <span class="op">=</span> <span class="st">"runif"</span>, col <span class="op">=</span> <span class="va">col_runif</span>, top_annotation <span class="op">=</span> <span class="va">ha2</span><span class="op">)</span>
<span class="va">ht3</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">le</span>, name <span class="op">=</span> <span class="st">"letters"</span>, col <span class="op">=</span> <span class="va">col_letters</span><span class="op">)</span>
<span class="va">ht_list</span> <span class="op">=</span> <span class="va">ht1</span> <span class="op">+</span> <span class="va">ht2</span> <span class="op">+</span> <span class="va">ht3</span>
<span class="fu">draw</span><span class="op">(</span><span class="va">ht_list</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-14-1.png" width="864" style="display: block; margin: auto;"></div>
<p>If you also want to automatically adjust the size of simple annotations, set
<code>simple_anno_size_adjust = TRUE</code> in every <code>HeatmapAnnotation()</code> calls.</p>
<p>If the second heatmap has no bottom annotation, column names for the second
heatmap are adjusted to be put directly below the heatmap body.</p>
<div class="sourceCode" id="cb385"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ha1</span> <span class="op">=</span> <span class="fu">HeatmapAnnotation</span><span class="op">(</span>foo1 <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, bar1 <span class="op">=</span> <span class="fu">anno_points</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, annotation_name_side <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span>
<span class="va">ht1</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat1</span>, name <span class="op">=</span> <span class="st">"rnorm"</span>, col <span class="op">=</span> <span class="va">col_rnorm</span>, bottom_annotation <span class="op">=</span> <span class="va">ha1</span><span class="op">)</span>
<span class="va">ht2</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat2</span>, name <span class="op">=</span> <span class="st">"runif"</span>, col <span class="op">=</span> <span class="va">col_runif</span><span class="op">)</span>
<span class="va">ht3</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">le</span>, name <span class="op">=</span> <span class="st">"letters"</span>, col <span class="op">=</span> <span class="va">col_letters</span><span class="op">)</span>
<span class="va">ht_list</span> <span class="op">=</span> <span class="va">ht1</span> <span class="op">+</span> <span class="va">ht2</span> <span class="op">+</span> <span class="va">ht3</span>
<span class="fu">draw</span><span class="op">(</span><span class="va">ht_list</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-15-1.png" width="864" style="display: block; margin: auto;"></div>
</div>
<div id="concatenate-with-annotations" class="section level2" number="4.7">
<h2>
<span class="header-section-number">4.7</span> Concatenate with annotations<a class="anchor" aria-label="anchor" href="#concatenate-with-annotations"><i class="fas fa-link"></i></a>
</h2>
<p>Row annotations can be concatenated to the horizontal heatmap list, while not
only a component of the heatmap. See following examples which are very
straightforward.</p>
<div class="sourceCode" id="cb386"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ha1</span> <span class="op">=</span> <span class="fu">rowAnnotation</span><span class="op">(</span>foo <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, bar <span class="op">=</span> <span class="fu">anno_barplot</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, width <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">4</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">ht1</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat1</span>, name <span class="op">=</span> <span class="st">"rnorm"</span>, col <span class="op">=</span> <span class="va">col_rnorm</span>, row_km <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">ht1</span> <span class="op">+</span> <span class="va">ha1</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-16-1.png" width="672" style="display: block; margin: auto;"></div>
<p>The <code>foo</code> and <code>bar</code> annotations can be defined in two separated
<code>rowAnnotation()</code> calls.</p>
<div class="sourceCode" id="cb387"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat1</span>, name <span class="op">=</span> <span class="st">"rnorm"</span>, col <span class="op">=</span> <span class="va">col_rnorm</span>, row_km <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">rowAnnotation</span><span class="op">(</span>foo <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">rowAnnotation</span><span class="op">(</span>bar <span class="op">=</span> <span class="fu">anno_barplot</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, width <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">4</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-17-1.png" width="672" style="display: block; margin: auto;"></div>
<p>You may wonder how to recover the row names of <code>mat1</code>. There are two ways.</p>
<ol style="list-style-type: decimal">
<li>you can set the row annotation as the “right annotation” of the heatmap and
put the heatmap as the last one.</li>
</ol>
<div class="sourceCode" id="cb388"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat1</span>, name <span class="op">=</span> <span class="st">"rnorm"</span>, col <span class="op">=</span> <span class="va">col_rnorm</span>, row_km <span class="op">=</span> <span class="fl">2</span>, right_annotation <span class="op">=</span> <span class="va">ha1</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-18-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb389"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># or using the previous variable</span>
<span class="co"># attach_annotation(ht1, ha1, side = "right")</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>add the row names by adding a text annotation:</li>
</ol>
<div class="sourceCode" id="cb390"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ht1</span> <span class="op">+</span> <span class="va">ha1</span> <span class="op">+</span> <span class="fu">rowAnnotation</span><span class="op">(</span>rn <span class="op">=</span> <span class="fu">anno_text</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">mat1</span><span class="op">)</span>, 
    location <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">0</span>, <span class="st">"npc"</span><span class="op">)</span>, just <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-19-1.png" width="672" style="display: block; margin: auto;"></div>
<p>Basically heatmaps and row annotations can be concatenated arbitarily.</p>
<div class="sourceCode" id="cb391"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">rowAnnotation</span><span class="op">(</span>foo <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat1</span>, name <span class="op">=</span> <span class="st">"rnorm"</span>, col <span class="op">=</span> <span class="va">col_rnorm</span>, row_km <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu">rowAnnotation</span><span class="op">(</span>bar <span class="op">=</span> <span class="fu">anno_barplot</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, width <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">4</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat2</span>, name <span class="op">=</span> <span class="st">"runif"</span>, col <span class="op">=</span> <span class="va">col_runif</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-20-1.png" width="960" style="display: block; margin: auto;"></div>
<p>As mentioned in previous chapters, row annotations can also be heatmap
components as left annotations or right annotations. The difference of row
annotations as independent ones and as heatmap components is discussed in
Section <a href="a-list-of-heatmaps.html#vertical-concatenation">4.9</a>.</p>
</div>
<div id="concatenate-only-the-annotations" class="section level2" number="4.8">
<h2>
<span class="header-section-number">4.8</span> Concatenate only the annotations<a class="anchor" aria-label="anchor" href="#concatenate-only-the-annotations"><i class="fas fa-link"></i></a>
</h2>
<p>The concatenation can be done without any heatmap.</p>
<div class="sourceCode" id="cb392"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">rowAnnotation</span><span class="op">(</span>foo <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">rowAnnotation</span><span class="op">(</span>bar <span class="op">=</span> <span class="fu">anno_barplot</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, width <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">4</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-21-1.png" width="672" style="display: block; margin: auto;"></div>
<p>If there is only one <code>HeatmapAnnotation</code> object, you must concatenated with <code>NULL</code>.</p>
<div class="sourceCode" id="cb393"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">rowAnnotation</span><span class="op">(</span>bar <span class="op">=</span> <span class="fu">anno_barplot</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, width <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">4</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="cn">NULL</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-22-1.png" width="672" style="display: block; margin: auto;"></div>
<p>The annotation list is actually also a <code>HeatmapList</code> object.</p>
<div class="sourceCode" id="cb394"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">anno_list</span> <span class="op">=</span> <span class="fu">rowAnnotation</span><span class="op">(</span>foo <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">rowAnnotation</span><span class="op">(</span>bar <span class="op">=</span> <span class="fu">anno_barplot</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, width <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">4</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">anno_list</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "HeatmapList"
## attr(,"package")
## [1] "ComplexHeatmap"</code></pre>
<p>Thus, you can use some functionalities of the <code>draw()</code> function for the
annotation list, such as row splitting.</p>
<div class="sourceCode" id="cb396"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">draw</span><span class="op">(</span><span class="va">anno_list</span>, row_split <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-24-1.png" width="672" style="display: block; margin: auto;"></div>
<p>In Section <a href="other-high-level-plots.html#stacked-summary-plot">11.2</a>, we will show how to use a list of
annotations to visualize multiple summary statistics.</p>
</div>
<div id="vertical-concatenation" class="section level2" number="4.9">
<h2>
<span class="header-section-number">4.9</span> Vertical concatenation<a class="anchor" aria-label="anchor" href="#vertical-concatenation"><i class="fas fa-link"></i></a>
</h2>
<p>Heatmaps and annotations (now it is column annotation) can be concatenated
vertically by the <code>%v%</code> operator. All the relatated settings and adjustments
are very similar as the horizontal concatenation. Please check following
examples.</p>
<div class="sourceCode" id="cb397"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mat1t</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">mat1</span><span class="op">)</span>
<span class="va">mat2t</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">mat2</span><span class="op">)</span>
<span class="va">ht1</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat1t</span>, name <span class="op">=</span> <span class="st">"rnorm"</span>, col <span class="op">=</span> <span class="va">col_rnorm</span>, row_title <span class="op">=</span> <span class="st">"rnorm"</span><span class="op">)</span>
<span class="va">ht2</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat2t</span>, name <span class="op">=</span> <span class="st">"runif"</span>, col <span class="op">=</span> <span class="va">col_runif</span>, row_title <span class="op">=</span> <span class="st">"runif"</span><span class="op">)</span>
<span class="va">ht3</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span>letters <span class="op">=</span> <span class="va">le</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"letters"</span>, col <span class="op">=</span> <span class="va">col_letters</span><span class="op">)</span>
<span class="va">ht_list</span> <span class="op">=</span> <span class="va">ht1</span> <span class="op">%v%</span> <span class="va">ht2</span> <span class="op">%v%</span> <span class="va">ht3</span>
<span class="fu">draw</span><span class="op">(</span><span class="va">ht_list</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-25-1.png" width="499.2" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb398"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">draw</span><span class="op">(</span><span class="va">ht_list</span>, column_km <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-25-2.png" width="499.2" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb399"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ha</span> <span class="op">=</span> <span class="fu">HeatmapAnnotation</span><span class="op">(</span>foo <span class="op">=</span> <span class="fu">anno_barplot</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, height <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">2</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">ht_list</span> <span class="op">=</span> <span class="va">ht1</span> <span class="op">%v%</span> <span class="va">ha</span> <span class="op">%v%</span> <span class="va">ht2</span> <span class="op">%v%</span> <span class="va">ht3</span>
<span class="fu">draw</span><span class="op">(</span><span class="va">ht_list</span>, column_km <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-26-1.png" width="499.2" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb400"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ht1</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat1t</span>, name <span class="op">=</span> <span class="st">"rnorm"</span>, col <span class="op">=</span> <span class="va">col_rnorm</span>, row_km <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">ht2</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat2t</span>, name <span class="op">=</span> <span class="st">"runif"</span>, col <span class="op">=</span> <span class="va">col_runif</span>, row_km <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">ht3</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span>letters <span class="op">=</span> <span class="va">le</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"letters"</span>, col <span class="op">=</span> <span class="va">col_letters</span><span class="op">)</span>
<span class="va">ha</span> <span class="op">=</span> <span class="fu">HeatmapAnnotation</span><span class="op">(</span>foo <span class="op">=</span> <span class="fu">anno_barplot</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, height <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">2</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">ht_list</span> <span class="op">=</span> <span class="va">ht1</span> <span class="op">%v%</span> <span class="va">ha</span> <span class="op">%v%</span> <span class="va">ht2</span> <span class="op">%v%</span> <span class="va">ht3</span>
<span class="fu">draw</span><span class="op">(</span><span class="va">ht_list</span>, column_km <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-27-1.png" width="499.2" style="display: block; margin: auto;"></div>
<p>For the vertical heatmap list, now row annotations should be the heatmap
components (by <code>right_annotation</code> and <code>left_annotation</code>) and they are adjusted
just like column annotations for the horizontal heatmap list.</p>
<div class="sourceCode" id="cb401"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ht1</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat1t</span>, name <span class="op">=</span> <span class="st">"rnorm"</span>, col <span class="op">=</span> <span class="va">col_rnorm</span>, row_km <span class="op">=</span> <span class="fl">2</span>,
    left_annotation <span class="op">=</span> <span class="fu">rowAnnotation</span><span class="op">(</span>foo1 <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, bar1 <span class="op">=</span> <span class="fu">anno_barplot</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">ha</span> <span class="op">=</span> <span class="fu">HeatmapAnnotation</span><span class="op">(</span>foo <span class="op">=</span> <span class="fu">anno_barplot</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, height <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">2</span>, <span class="st">"cm"</span><span class="op">)</span>, 
    axis_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>side <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">ht2</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat2t</span>, name <span class="op">=</span> <span class="st">"runif"</span>, col <span class="op">=</span> <span class="va">col_runif</span>, row_km <span class="op">=</span> <span class="fl">2</span>,
    left_annotation <span class="op">=</span> <span class="fu">rowAnnotation</span><span class="op">(</span>foo2 <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span>
<span class="va">ht3</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span>letters <span class="op">=</span> <span class="va">le</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"letters"</span>, col <span class="op">=</span> <span class="va">col_letters</span><span class="op">)</span>
<span class="va">ht_list</span> <span class="op">=</span> <span class="va">ht1</span> <span class="op">%v%</span> <span class="va">ha</span> <span class="op">%v%</span> <span class="va">ht2</span> <span class="op">%v%</span> <span class="va">ht3</span>
<span class="fu">draw</span><span class="op">(</span><span class="va">ht_list</span>, column_km <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-28-1.png" width="499.2" style="display: block; margin: auto;"></div>
<p>Since <code>rowAnnotation()</code> allows arbitary number of annotations, the way showed
above is the only way to expand the heatmap list horizontally and vertically
at the same time.</p>
</div>
<div id="subset-heatmap-list" class="section level2" number="4.10">
<h2>
<span class="header-section-number">4.10</span> Subset the heatmap list<a class="anchor" aria-label="anchor" href="#subset-heatmap-list"><i class="fas fa-link"></i></a>
</h2>
<p>Similar as subsetting the <code>Heatmap</code> object (Section <a href="a-single-heatmap.html#subset-a-heatmap">2.13</a>),
the heatmap list can also be subsetted by providing row index and column
index. For horizontal heatmap list, row index correspond to rows in all
heatmaps and annotations, while column index only corresponds to a subset of
heatmaps and annotations. For vertical heatmap list, it’s the other way
around.</p>
<p>In following we use horizontal heatmap list as example.</p>
<div class="sourceCode" id="cb402"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ht1</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat1</span>, name <span class="op">=</span> <span class="st">"rnorm"</span>, col <span class="op">=</span> <span class="va">col_rnorm</span>, 
    left_annotation <span class="op">=</span> <span class="fu">rowAnnotation</span><span class="op">(</span>foo1 <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, bar1 <span class="op">=</span> <span class="fu">anno_points</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">ht2</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat2</span>, name <span class="op">=</span> <span class="st">"runif"</span>, col <span class="op">=</span> <span class="va">col_runif</span><span class="op">)</span>
<span class="va">ha</span> <span class="op">=</span> <span class="fu">rowAnnotation</span><span class="op">(</span>foo2 <span class="op">=</span> <span class="fu">anno_barplot</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>, bar2 <span class="op">=</span> <span class="fl">12</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>
<span class="va">ht_list</span> <span class="op">=</span> <span class="va">ht1</span> <span class="op">+</span> <span class="va">ht2</span> <span class="op">+</span> <span class="va">ha</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">ht_list</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "rnorm" "runif" "foo2"  "bar2"</code></pre>
<div class="sourceCode" id="cb404"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ht_list</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"rnorm"</span>, <span class="st">"bar2"</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-29-1.png" width="499.2" style="display: block; margin: auto;"></div>
<p><code>foo1</code> and <code>bar</code> are components of heatmap <code>rnorm</code>, so they can not be
selected in the subset function, while <code>foo2</code> and <code>bar2</code> are independent row
annotations and they can selected to take subset of them.</p>
</div>
<div id="plot-the-heamtap-list" class="section level2" number="4.11">
<h2>
<span class="header-section-number">4.11</span> Plot the heatmap list<a class="anchor" aria-label="anchor" href="#plot-the-heamtap-list"><i class="fas fa-link"></i></a>
</h2>
<p>Similar as described in Section <a href="a-single-heatmap.html#plot-the-heatmap">2.11</a>, directly entering the
HeatmapList object in interactive R session calls the <code>show()</code> method which
calls the <code>draw()</code> method internally. When there is no plot after you entering
the object, you should use <code>draw()</code> explicitly:</p>
<div class="sourceCode" id="cb405"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># code only for demonstration</span>
<span class="fu">draw</span><span class="op">(</span><span class="va">ht_list</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
</div>
<div id="get-orders-and-dendrograms-from-a-list-of-heatmaps" class="section level2" number="4.12">
<h2>
<span class="header-section-number">4.12</span> Get orders and dendrograms<a class="anchor" aria-label="anchor" href="#get-orders-and-dendrograms-from-a-list-of-heatmaps"><i class="fas fa-link"></i></a>
</h2>
<p><code>row_order()</code>, <code>column_order()</code>, <code>row_dend()</code> and <code>column_dend()</code> can be used
to retrieve corresponding information from the heatmap list. The usage is
straightforward by following examples. But remember you need to apply these
functions on the object returned by <code>draw()</code>.</p>
<div class="sourceCode" id="cb406"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ht1</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat1</span>, name <span class="op">=</span> <span class="st">"rnorm"</span>, col <span class="op">=</span> <span class="va">col_rnorm</span><span class="op">)</span>
<span class="va">ht2</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat2</span>, name <span class="op">=</span> <span class="st">"runif"</span>, col <span class="op">=</span> <span class="va">col_runif</span><span class="op">)</span>
<span class="va">ht_list</span> <span class="op">=</span> <span class="va">ht1</span> <span class="op">+</span> <span class="va">ht2</span>
<span class="va">ht_list</span> <span class="op">=</span> <span class="fu">draw</span><span class="op">(</span><span class="va">ht_list</span><span class="op">)</span>
<span class="fu">row_order</span><span class="op">(</span><span class="va">ht_list</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] 10  4  8  2  1 12 11  6  7  3  9  5</code></pre>
<div class="sourceCode" id="cb408"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">column_order</span><span class="op">(</span><span class="va">ht_list</span><span class="op">)</span></code></pre></div>
<pre><code>## $rnorm
##  [1]  5  2  7  6 10  1  9  8  4  3
## 
## $runif
##  [1]  4 10  2  5  7  6  1  3  8  9</code></pre>
<p>If rows or columns are split, the returned values will also be a list.</p>
<div class="sourceCode" id="cb410"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ht1</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat1</span>, name <span class="op">=</span> <span class="st">"rnorm"</span>, col <span class="op">=</span> <span class="va">col_rnorm</span><span class="op">)</span>
<span class="va">ht2</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat2</span>, name <span class="op">=</span> <span class="st">"runif"</span>, col <span class="op">=</span> <span class="va">col_runif</span>, column_km <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">ht_list</span> <span class="op">=</span> <span class="va">ht1</span> <span class="op">+</span> <span class="va">ht2</span>
<span class="va">ht_list</span> <span class="op">=</span> <span class="fu">draw</span><span class="op">(</span><span class="va">ht_list</span>, row_km <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu">row_order</span><span class="op">(</span><span class="va">ht_list</span><span class="op">)</span></code></pre></div>
<pre><code>## $`1`
## [1] 7 3 9 5
## 
## $`2`
## [1] 10  4  8  2  1 12 11  6</code></pre>
<div class="sourceCode" id="cb412"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">column_order</span><span class="op">(</span><span class="va">ht_list</span><span class="op">)</span></code></pre></div>
<pre><code>## $rnorm
## $rnorm[[1]]
##  [1]  5  2  7  6 10  1  9  8  4  3
## 
## 
## $runif
## $runif$`2`
## [1]  4 10  2  5
## 
## $runif$`1`
## [1] 7 6 1 3 8 9</code></pre>
<p>You can specify a certain heatmap for the column order.</p>
<div class="sourceCode" id="cb414"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">column_order</span><span class="op">(</span><span class="va">ht_list</span>, name <span class="op">=</span> <span class="st">"runif"</span><span class="op">)</span></code></pre></div>
<pre><code>## $`2`
## [1]  4 10  2  5
## 
## $`1`
## [1] 7 6 1 3 8 9</code></pre>
<p>The logic is the same for extracting dendrograms and also the same for vertical
heatmap list, so we don’t show more examples here.</p>
</div>
<div id="change-parameters-globally" class="section level2" number="4.13">
<h2>
<span class="header-section-number">4.13</span> Change parameters globally<a class="anchor" aria-label="anchor" href="#change-parameters-globally"><i class="fas fa-link"></i></a>
</h2>
<p><code>ht_opt()</code> is an option function which controls some parameters globally. You
can set some parameters for all heatmaps/annotations simultaneously by this
global function. Please note you should put it before your heatmap code and
reset all option values after drawing the heatmaps to get rid of affecting
next heatmap.</p>
<div class="sourceCode" id="cb416"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ht_opt</span></code></pre></div>
<pre><code>##  Option                       Value             
##  ----------------------------:--------------------
##  heatmap_row_names_gp         NULL              
##  heatmap_column_names_gp      NULL              
##  heatmap_row_title_gp         NULL              
##  heatmap_column_title_gp      NULL              
##  legend_title_gp              NULL              
##  legend_title_position        NULL              
##  legend_labels_gp             NULL              
##  legend_grid_height           NULL              
##  legend_grid_width            NULL              
##  legend_border                NULL              
##  legend_gap                   4mm, 4mm          
##  heatmap_border               NULL              
##  annotation_border            NULL              
##  fast_hclust                  FALSE             
##  show_parent_dend_line        TRUE              
##  verbose                      FALSE             
##  message                      TRUE              
##  show_vp                      FALSE             
##  simple_anno_size             5mm               
##  DENDROGRAM_PADDING           0.5mm             
##  DIMNAME_PADDING              1mm               
##  TITLE_PADDING                NULL              
##  COLUMN_ANNO_PADDING          1mm               
##  ROW_ANNO_PADDING             1mm               
##  HEATMAP_LEGEND_PADDING       2mm               
##  ANNOTATION_LEGEND_PADDING    2mm               
##  save_last                    FALSE             
##  validate_names               TRUE              
##  raster_temp_image_max_width  30000             
##  raster_temp_image_max_height 30000             
##  COLOR                        blue, #EEEEEE, red</code></pre>
<p>There are following parameters to control all heatmaps:</p>
<ul>
<li>
<code>heatmap_row_names_gp</code>: set <code>row_names_gp</code> in all <code>Heatmap()</code>.</li>
<li>
<code>heatmap_column_names_gp</code>: set <code>column_names_gp</code> in all <code>Heatmap()</code>.</li>
<li>
<code>heatmap_row_title_gp</code>: set <code>row_title_gp</code> in all <code>Heatmap()</code>.</li>
<li>
<code>heatmap_column_title_gp</code>: set <code>column_title_gp</code> in all <code>Heatmap()</code>.</li>
<li>
<code>heatmap_border</code>: set <code>border</code> in all <code>Heatmap()</code>.</li>
</ul>
<p>Following parameters control the legends:</p>
<ul>
<li>
<code>legend_title_gp</code>: set <code>title_gp</code> in all heatmap legends and annotation
legends.</li>
<li>
<code>legend_title_position</code>: set <code>title_position</code> in all heatmap legends and
annotation legends.</li>
<li>
<code>legend_labels_gp</code>: set <code>labels_gp</code> in all heatmap legends and annotation
legends.</li>
<li>
<code>legend_grid_width</code>: set <code>grid_width</code> in all heatmap legends and annotation
legends.</li>
<li>
<code>legend_grid_height</code>: set <code>grid_height</code> in all heatmap legends and
annotation legends.</li>
<li>
<code>legend_border</code>: set <code>border</code> in all heatmap legends and annotation legends.</li>
</ul>
<p>Following parameters control heatmap annotations:</p>
<ul>
<li>
<code>annotation_border</code>: set <code>border</code> in all <code>HeatmapAnnotation()</code>.</li>
<li>
<code>anno_simple_size</code>: set size for the simple annotation.</li>
</ul>
<p>Following parameters control the space between heatmap components:</p>
<ul>
<li>
<code>DENDROGRAM_PADDING</code>: space bewteen dendrograms and heatmap body.</li>
<li>
<code>DIMNAME_PADDING</code>: space between row/column names and heatmap body.</li>
<li>
<code>TITLE_PADDING</code>: space between row/column titles and heatmap body.</li>
<li>
<code>COLUMN_ANNO_PADDING</code>: space between column annotations and heatmap body.</li>
<li>
<code>ROW_ANNO_PADDING</code>: space between row annotations and heatmap body.</li>
</ul>
<p>Other parameters:</p>
<ul>
<li>
<code>fast_hclust</code>: whether use <code><a href="https://rdrr.io/pkg/fastcluster/man/hclust.html">fastcluster::hclust()</a></code> to speed up clustering?</li>
<li>
<code>show_parent_dend_line</code>: when heatmap is split, whether to add a dashed line
to mark parent dendrogram and children dendrograms?</li>
</ul>
<p>You can get or set option values by the traditional way (like
<code><a href="https://rdrr.io/r/base/options.html">base::options()</a></code>) or by <code>$</code> operator:</p>
<div class="sourceCode" id="cb418"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ht_opt</span><span class="op">(</span><span class="st">"heatmap_row_names_gp"</span><span class="op">)</span>
<span class="va">ht_opt</span><span class="op">$</span><span class="va">heatmap_row_names_gp</span>

<span class="co"># to set option values</span>
<span class="fu">ht_opt</span><span class="op">(</span><span class="st">"heatmap_row_names_gp"</span> <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span>
<span class="va">ht_opt</span><span class="op">$</span><span class="va">heatmap_row_names_gp</span> <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></code></pre></div>
<p>Reset to the default values by:</p>
<div class="sourceCode" id="cb419"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ht_opt</span><span class="op">(</span>RESET <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>Following example shows to control some graphic parameters globally.</p>
<div class="sourceCode" id="cb420"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ht_opt</span><span class="op">(</span>heatmap_column_names_gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fontface <span class="op">=</span> <span class="st">"italic"</span><span class="op">)</span>, 
    heatmap_column_title_gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,
    legend_border <span class="op">=</span> <span class="st">"black"</span>,
    heatmap_border <span class="op">=</span> <span class="cn">TRUE</span>,
    annotation_border <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span>
<span class="va">ht1</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat1</span>, name <span class="op">=</span> <span class="st">"ht1"</span>, column_title <span class="op">=</span> <span class="st">"Heatmap 1"</span>,
    top_annotation <span class="op">=</span> <span class="fu">HeatmapAnnotation</span><span class="op">(</span>foo <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span>
<span class="va">ht2</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat2</span>, name <span class="op">=</span> <span class="st">"ht2"</span>, column_title <span class="op">=</span> <span class="st">"Heatmap 2"</span>,
    top_annotation <span class="op">=</span> <span class="fu">HeatmapAnnotation</span><span class="op">(</span>bar <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span>
<span class="va">ht1</span> <span class="op">+</span> <span class="va">ht2</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-37-1.png" width="960" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb421"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ht_opt</span><span class="op">(</span>RESET <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>These global parameters can also be set in the <code>draw()</code> function to
temporarily change the global parameters, and they are reset back after the
plot is made. Please check the help page of <code>draw,HeatmapList-method</code>.</p>
</div>
<div id="adjust-blank-space-caused-by-annotations" class="section level2" number="4.14">
<h2>
<span class="header-section-number">4.14</span> Adjust blank space caused by annotations<a class="anchor" aria-label="anchor" href="#adjust-blank-space-caused-by-annotations"><i class="fas fa-link"></i></a>
</h2>
<p>Heatmap annotations may have annotation names and axes, for which the spaces
are also taken into account when arranging heatmap components in the final
layout. Sometimes, this adjustment is not smart that you may see blank areas
in the plot that are not necessary.</p>
<p>One scenario is for a matrix with no row names, the space to the right of the
heatmap is determined by the size of annotation name, which results in blank
space between the heatmap and the legend. Also the heatmap list level row
title is plotted to the left of the annotation axis, which gives blank area if
there is no row dendrogram.</p>
<p><code>adjust_annotation_extension</code> controls whether to take account of the space of
annotation names and axes for the layout. Compare following two plots.</p>
<div class="sourceCode" id="cb422"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span>
<span class="va">ht</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">m</span>, name <span class="op">=</span> <span class="st">"mat"</span>,
    top_annotation <span class="op">=</span> <span class="fu">HeatmapAnnotation</span><span class="op">(</span>foo <span class="op">=</span> <span class="fu">anno_points</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span>,
    show_row_dend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu">draw</span><span class="op">(</span><span class="va">ht</span>, row_title <span class="op">=</span> <span class="st">"fooooooooooo"</span>, adjust_annotation_extension <span class="op">=</span> <span class="cn">TRUE</span>,  <span class="co"># default</span>
    column_title <span class="op">=</span> <span class="st">"adjust_annotation_extension = TRUE"</span><span class="op">)</span>
<span class="fu">draw</span><span class="op">(</span><span class="va">ht</span>, row_title <span class="op">=</span> <span class="st">"fooooooooooo"</span>, adjust_annotation_extension <span class="op">=</span> <span class="cn">FALSE</span>,
    column_title <span class="op">=</span> <span class="st">"adjust_annotation_extension = FALSE"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-39-1.png" width="960" style="display: block; margin: auto;"></div>
<p>Another way to partially solve the space problem is to move the annotation name
to the left and use heamtap-level row title.</p>
<div class="sourceCode" id="cb423"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">Heatmap</span><span class="op">(</span><span class="va">m</span>, name <span class="op">=</span> <span class="st">"mat"</span>,
    top_annotation <span class="op">=</span> <span class="fu">HeatmapAnnotation</span><span class="op">(</span>foo <span class="op">=</span> <span class="fu">anno_points</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>,
        annotation_name_side <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span>,
    row_title <span class="op">=</span> <span class="st">"fooooooooooo"</span>,
    show_row_dend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-40-1.png" width="672" style="display: block; margin: auto;"></div>
<p>However, this adjustment for annotations sometimes is also necessary, e.g. when the heatmap is
very short:</p>
<div class="sourceCode" id="cb424"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ht</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">m</span>, name <span class="op">=</span> <span class="st">"mat"</span>,
    top_annotation <span class="op">=</span> <span class="fu">HeatmapAnnotation</span><span class="op">(</span>foo <span class="op">=</span> <span class="fu">anno_points</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span>,
    show_row_dend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu">draw</span><span class="op">(</span><span class="va">ht</span>, row_title <span class="op">=</span> <span class="st">"fooooooooooo"</span>, adjust_annotation_extension <span class="op">=</span> <span class="cn">TRUE</span>,
    column_title <span class="op">=</span> <span class="st">"adjust_annotation_extension = TRUE"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-41-1.png" width="672" style="display: block; margin: auto;"></div>
<p>Therefore, we set <code>TRUE</code> as the default of <code>adjust_annotation_extension</code> and users can configure
it based on specific scenarios.</p>
</div>
<div id="manually-increase-space-around-the-plot" class="section level2" number="4.15">
<h2>
<span class="header-section-number">4.15</span> Manually increase space around the plot<a class="anchor" aria-label="anchor" href="#manually-increase-space-around-the-plot"><i class="fas fa-link"></i></a>
</h2>
<p>The layout of the <strong>ComplexHeatmap</strong> is not perfect that it is still possible some of the text are
drawn out of the plotting region. In this case, you can manually set the <code>padding</code> argument in <code>draw()</code> function
to increase the blank areas around the final plot.</p>
<p>The value of <code>padding</code> should be a unit vector with length of four. The four values correspond to the space at
the bottom, left, top and right sides.</p>
<p>The following example is not a perfect example because the maximal width for row names can be controlled
by <code>max_row_name_width</code> argument, but we can still use it to demonstrate the use of <code>padding</code>.</p>
<div class="sourceCode" id="cb425"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m2</span> <span class="op">=</span> <span class="va">m</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">m2</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="st">"a long long long long long row name"</span>
<span class="va">ht</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">m2</span>, name <span class="op">=</span> <span class="st">"mat"</span>, row_names_side <span class="op">=</span> <span class="st">"left"</span>, show_row_dend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu">draw</span><span class="op">(</span><span class="va">ht</span>, padding <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">20</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"mm"</span><span class="op">)</span><span class="op">)</span> <span class="co">## see right heatmap in following</span></code></pre></div>
<div class="inline-figure"><img src="04-a_list_of_heatmaps_files/figure-html/unnamed-chunk-43-1.png" width="960" style="display: block; margin: auto;"></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="heatmap-annotations.html"><span class="header-section-number">3</span> Heatmap Annotations</a></div>
<div class="next"><a href="legends.html"><span class="header-section-number">5</span> Legends</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#a-list-of-heatmaps"><span class="header-section-number">4</span> A List of Heatmaps</a></li>
<li><a class="nav-link" href="#heatmap-list-titles"><span class="header-section-number">4.1</span> Titles</a></li>
<li><a class="nav-link" href="#size-of-heatmaps"><span class="header-section-number">4.2</span> Size of heatmaps</a></li>
<li><a class="nav-link" href="#gap-between-heatmaps"><span class="header-section-number">4.3</span> Gap between heatmaps</a></li>
<li><a class="nav-link" href="#automatic-adjustment-to-the-main-heatmap"><span class="header-section-number">4.4</span> Automatic adjustment to the main heatmap</a></li>
<li><a class="nav-link" href="#control-main-heatmap-in-draw-function"><span class="header-section-number">4.5</span> Control main heatmap in draw() function</a></li>
<li><a class="nav-link" href="#annotations-as-components-are-adjusted"><span class="header-section-number">4.6</span> Annotations as components are adjusted</a></li>
<li><a class="nav-link" href="#concatenate-with-annotations"><span class="header-section-number">4.7</span> Concatenate with annotations</a></li>
<li><a class="nav-link" href="#concatenate-only-the-annotations"><span class="header-section-number">4.8</span> Concatenate only the annotations</a></li>
<li><a class="nav-link" href="#vertical-concatenation"><span class="header-section-number">4.9</span> Vertical concatenation</a></li>
<li><a class="nav-link" href="#subset-heatmap-list"><span class="header-section-number">4.10</span> Subset the heatmap list</a></li>
<li><a class="nav-link" href="#plot-the-heamtap-list"><span class="header-section-number">4.11</span> Plot the heatmap list</a></li>
<li><a class="nav-link" href="#get-orders-and-dendrograms-from-a-list-of-heatmaps"><span class="header-section-number">4.12</span> Get orders and dendrograms</a></li>
<li><a class="nav-link" href="#change-parameters-globally"><span class="header-section-number">4.13</span> Change parameters globally</a></li>
<li><a class="nav-link" href="#adjust-blank-space-caused-by-annotations"><span class="header-section-number">4.14</span> Adjust blank space caused by annotations</a></li>
<li><a class="nav-link" href="#manually-increase-space-around-the-plot"><span class="header-section-number">4.15</span> Manually increase space around the plot</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/jokergoo/ComplexHeatmap/blob/master/04-a_list_of_heatmaps.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/jokergoo/ComplexHeatmap/edit/master/04-a_list_of_heatmaps.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>ComplexHeatmap Complete Reference</strong>" was written by Zuguang Gu. It was last built on last revised on 2022-07-31.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
