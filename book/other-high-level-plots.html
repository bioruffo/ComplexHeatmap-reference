<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 11 Other High-level Plots | ComplexHeatmap Complete Reference</title>
  <meta name="description" content="Complex heatmaps are efficient to visualize associations between different sources of data sets and reveal potential patterns. Here the ComplexHeatmap R package provides a highly flexible way to arrange multiple heatmaps and supports various annotation graphics. This book is the complete reference to ComplexHeatmap pacakge." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 11 Other High-level Plots | ComplexHeatmap Complete Reference" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://jokergoo.github.io/ComplexHeatmap-reference/book" />
  <meta property="og:image" content="https://jokergoo.github.io/ComplexHeatmap-reference/book/complexheatmap-cover.jpg" />
  <meta property="og:description" content="Complex heatmaps are efficient to visualize associations between different sources of data sets and reveal potential patterns. Here the ComplexHeatmap R package provides a highly flexible way to arrange multiple heatmaps and supports various annotation graphics. This book is the complete reference to ComplexHeatmap pacakge." />
  <meta name="github-repo" content="jokergoo/ComplexHeatmap-reference" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 11 Other High-level Plots | ComplexHeatmap Complete Reference" />
  
  <meta name="twitter:description" content="Complex heatmaps are efficient to visualize associations between different sources of data sets and reveal potential patterns. Here the ComplexHeatmap R package provides a highly flexible way to arrange multiple heatmaps and supports various annotation graphics. This book is the complete reference to ComplexHeatmap pacakge." />
  <meta name="twitter:image" content="https://jokergoo.github.io/ComplexHeatmap-reference/book/complexheatmap-cover.jpg" />

<meta name="author" content="Zuguang Gu" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="integrate-with-other-packages.html"/>
<link rel="next" href="three-dimensional-complexheatmap-3d-heatmap.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ComplexHeatmap Complete Reference</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#general-design"><i class="fa fa-check"></i><b>1.1</b> General design</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#a-brief-description-of-following-chapters"><i class="fa fa-check"></i><b>1.2</b> A brief description of following chapters</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html"><i class="fa fa-check"></i><b>2</b> A Single Heatmap</a>
<ul>
<li class="chapter" data-level="2.1" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#colors"><i class="fa fa-check"></i><b>2.1</b> Colors</a></li>
<li class="chapter" data-level="2.2" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#heatmap-titles"><i class="fa fa-check"></i><b>2.2</b> Titles</a></li>
<li class="chapter" data-level="2.3" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#clustering"><i class="fa fa-check"></i><b>2.3</b> Clustering</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#distance-methods"><i class="fa fa-check"></i><b>2.3.1</b> Distance methods</a></li>
<li class="chapter" data-level="2.3.2" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#clustering-methods"><i class="fa fa-check"></i><b>2.3.2</b> Clustering methods</a></li>
<li class="chapter" data-level="2.3.3" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#render-dendrograms"><i class="fa fa-check"></i><b>2.3.3</b> Render dendrograms</a></li>
<li class="chapter" data-level="2.3.4" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#reorder-dendrograms"><i class="fa fa-check"></i><b>2.3.4</b> Reorder dendrograms</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#row-and_column_orders"><i class="fa fa-check"></i><b>2.4</b> Set row and column orders</a></li>
<li class="chapter" data-level="2.5" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#heatmap-seriation"><i class="fa fa-check"></i><b>2.5</b> Seriation</a></li>
<li class="chapter" data-level="2.6" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#dimension-names"><i class="fa fa-check"></i><b>2.6</b> Dimension names</a></li>
<li class="chapter" data-level="2.7" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#heatmap-split"><i class="fa fa-check"></i><b>2.7</b> Heatmap split</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#split-by-kmeans-clustering"><i class="fa fa-check"></i><b>2.7.1</b> Split by k-means clustering</a></li>
<li class="chapter" data-level="2.7.2" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#split-by-categorical-variables"><i class="fa fa-check"></i><b>2.7.2</b> Split by categorical variables</a></li>
<li class="chapter" data-level="2.7.3" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#spilt-by-dendrogram"><i class="fa fa-check"></i><b>2.7.3</b> Split by dendrogram</a></li>
<li class="chapter" data-level="2.7.4" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#order-of-slices"><i class="fa fa-check"></i><b>2.7.4</b> Order of slices</a></li>
<li class="chapter" data-level="2.7.5" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#titles-for-splitting"><i class="fa fa-check"></i><b>2.7.5</b> Titles for splitting</a></li>
<li class="chapter" data-level="2.7.6" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#graphic-parameters-for-splitting"><i class="fa fa-check"></i><b>2.7.6</b> Graphic parameters for splitting</a></li>
<li class="chapter" data-level="2.7.7" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#gaps-between-slices"><i class="fa fa-check"></i><b>2.7.7</b> Gaps between slices</a></li>
<li class="chapter" data-level="2.7.8" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#split-heatmap-annotations"><i class="fa fa-check"></i><b>2.7.8</b> Split heatmap annotations</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#heatmap-as-raster-image"><i class="fa fa-check"></i><b>2.8</b> Heatmap as raster image</a></li>
<li class="chapter" data-level="2.9" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#customize-the-heatmap-body"><i class="fa fa-check"></i><b>2.9</b> Customize the heatmap body</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#cell-fun"><i class="fa fa-check"></i><b>2.9.1</b> cell_fun</a></li>
<li class="chapter" data-level="2.9.2" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#layer-fun"><i class="fa fa-check"></i><b>2.9.2</b> layer_fun</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#size-of-the-heatmap"><i class="fa fa-check"></i><b>2.10</b> Size of the heatmap</a></li>
<li class="chapter" data-level="2.11" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#plot-the-heatmap"><i class="fa fa-check"></i><b>2.11</b> Plot the heatmap</a></li>
<li class="chapter" data-level="2.12" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#get-orders-and-dendrograms-from-heatmap"><i class="fa fa-check"></i><b>2.12</b> Get orders and dendrograms</a></li>
<li class="chapter" data-level="2.13" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#subset-a-heatmap"><i class="fa fa-check"></i><b>2.13</b> Subset a heatmap</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html"><i class="fa fa-check"></i><b>3</b> Heatmap Annotations</a>
<ul>
<li class="chapter" data-level="3.1" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#simple-annotation"><i class="fa fa-check"></i><b>3.1</b> Simple annotation</a></li>
<li class="chapter" data-level="3.2" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#simple-annotation-as-an-annotation-function"><i class="fa fa-check"></i><b>3.2</b> Simple annotation as an annotation function</a></li>
<li class="chapter" data-level="3.3" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#empty-annotation"><i class="fa fa-check"></i><b>3.3</b> Empty annotation</a></li>
<li class="chapter" data-level="3.4" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#block-annotation"><i class="fa fa-check"></i><b>3.4</b> Block annotation</a></li>
<li class="chapter" data-level="3.5" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#image-annotation"><i class="fa fa-check"></i><b>3.5</b> Image annotation</a></li>
<li class="chapter" data-level="3.6" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#points-annotation"><i class="fa fa-check"></i><b>3.6</b> Points annotation</a></li>
<li class="chapter" data-level="3.7" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#lines-annotation"><i class="fa fa-check"></i><b>3.7</b> Lines annotation</a></li>
<li class="chapter" data-level="3.8" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#barplot_annotation"><i class="fa fa-check"></i><b>3.8</b> Barplot annotation</a></li>
<li class="chapter" data-level="3.9" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#box-annotation"><i class="fa fa-check"></i><b>3.9</b> Boxplot annotation</a></li>
<li class="chapter" data-level="3.10" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#histogram-annotation"><i class="fa fa-check"></i><b>3.10</b> Histogram annotation</a></li>
<li class="chapter" data-level="3.11" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#density-annotation"><i class="fa fa-check"></i><b>3.11</b> Density annotation</a></li>
<li class="chapter" data-level="3.12" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#joyplot-annotation"><i class="fa fa-check"></i><b>3.12</b> Joyplot annotation</a></li>
<li class="chapter" data-level="3.13" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#horizon-chart-annotation"><i class="fa fa-check"></i><b>3.13</b> Horizon chart annotation</a></li>
<li class="chapter" data-level="3.14" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#text-annotation"><i class="fa fa-check"></i><b>3.14</b> Text annotation</a></li>
<li class="chapter" data-level="3.15" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#mark-annotation"><i class="fa fa-check"></i><b>3.15</b> Mark annotation</a></li>
<li class="chapter" data-level="3.16" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#summary-annotation"><i class="fa fa-check"></i><b>3.16</b> Summary annotation</a></li>
<li class="chapter" data-level="3.17" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#zoom-annotation"><i class="fa fa-check"></i><b>3.17</b> Zoom/link annotation</a></li>
<li class="chapter" data-level="3.18" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#multiple-annotations"><i class="fa fa-check"></i><b>3.18</b> Multiple annotations</a>
<ul>
<li class="chapter" data-level="3.18.1" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#heatmap-annotation-general-settings"><i class="fa fa-check"></i><b>3.18.1</b> General settings</a></li>
<li class="chapter" data-level="3.18.2" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#size-of-annotations"><i class="fa fa-check"></i><b>3.18.2</b> Size of annotations</a></li>
<li class="chapter" data-level="3.18.3" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#annotation-labels"><i class="fa fa-check"></i><b>3.18.3</b> Annotation labels</a></li>
</ul></li>
<li class="chapter" data-level="3.19" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#heatmap-annotation-utility-function"><i class="fa fa-check"></i><b>3.19</b> Utility functions</a></li>
<li class="chapter" data-level="3.20" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#implement-new-annotation-functions"><i class="fa fa-check"></i><b>3.20</b> Implement new annotation functions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html"><i class="fa fa-check"></i><b>4</b> A List of Heatmaps</a>
<ul>
<li class="chapter" data-level="4.1" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#heatmap-list-titles"><i class="fa fa-check"></i><b>4.1</b> Titles</a></li>
<li class="chapter" data-level="4.2" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#size-of-heatmaps"><i class="fa fa-check"></i><b>4.2</b> Size of heatmaps</a></li>
<li class="chapter" data-level="4.3" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#gap-between-heatmaps"><i class="fa fa-check"></i><b>4.3</b> Gap between heatmaps</a></li>
<li class="chapter" data-level="4.4" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#automatic-adjustment-to-the-main-heatmap"><i class="fa fa-check"></i><b>4.4</b> Automatic adjustment to the main heatmap</a></li>
<li class="chapter" data-level="4.5" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#control-main-heatmap-in-draw-function"><i class="fa fa-check"></i><b>4.5</b> Control main heatmap in draw() function</a></li>
<li class="chapter" data-level="4.6" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#annotations-as-components-are-adjusted"><i class="fa fa-check"></i><b>4.6</b> Annotations as components are adjusted</a></li>
<li class="chapter" data-level="4.7" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#concatenate-with-annotations"><i class="fa fa-check"></i><b>4.7</b> Concatenate with annotations</a></li>
<li class="chapter" data-level="4.8" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#concatenate-only-the-annotations"><i class="fa fa-check"></i><b>4.8</b> Concatenate only the annotations</a></li>
<li class="chapter" data-level="4.9" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#vertical-concatenation"><i class="fa fa-check"></i><b>4.9</b> Vertical concatenation</a></li>
<li class="chapter" data-level="4.10" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#subset-heatmap-list"><i class="fa fa-check"></i><b>4.10</b> Subset the heatmap list</a></li>
<li class="chapter" data-level="4.11" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#plot-the-heamtap-list"><i class="fa fa-check"></i><b>4.11</b> Plot the heatmap list</a></li>
<li class="chapter" data-level="4.12" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#get-orders-and-dendrograms-from-a-list-of-heatmaps"><i class="fa fa-check"></i><b>4.12</b> Get orders and dendrograms</a></li>
<li class="chapter" data-level="4.13" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#change-parameters-globally"><i class="fa fa-check"></i><b>4.13</b> Change parameters globally</a></li>
<li class="chapter" data-level="4.14" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#adjust-blank-space-caused-by-annotations"><i class="fa fa-check"></i><b>4.14</b> Adjust blank space caused by annotations</a></li>
<li class="chapter" data-level="4.15" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#manually-increase-space-around-the-plot"><i class="fa fa-check"></i><b>4.15</b> Manually increase space around the plot</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="legends.html"><a href="legends.html"><i class="fa fa-check"></i><b>5</b> Legends</a>
<ul>
<li class="chapter" data-level="5.1" data-path="legends.html"><a href="legends.html#continuous-legends"><i class="fa fa-check"></i><b>5.1</b> Continuous legends</a></li>
<li class="chapter" data-level="5.2" data-path="legends.html"><a href="legends.html#discrete-legends"><i class="fa fa-check"></i><b>5.2</b> Discrete legends</a></li>
<li class="chapter" data-level="5.3" data-path="legends.html"><a href="legends.html#a-list-of-legends"><i class="fa fa-check"></i><b>5.3</b> A list of legends</a></li>
<li class="chapter" data-level="5.4" data-path="legends.html"><a href="legends.html#heatmap-and-annotation-legends"><i class="fa fa-check"></i><b>5.4</b> Heatmap and annotation legends</a></li>
<li class="chapter" data-level="5.5" data-path="legends.html"><a href="legends.html#add-customized-legends"><i class="fa fa-check"></i><b>5.5</b> Add customized legends</a></li>
<li class="chapter" data-level="5.6" data-path="legends.html"><a href="legends.html#the-side-of-legends"><i class="fa fa-check"></i><b>5.6</b> The side of legends</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="heatmap-decoration.html"><a href="heatmap-decoration.html"><i class="fa fa-check"></i><b>6</b> Heatmap Decoration</a>
<ul>
<li class="chapter" data-level="6.1" data-path="heatmap-decoration.html"><a href="heatmap-decoration.html#decoration-functions"><i class="fa fa-check"></i><b>6.1</b> Decoration functions</a></li>
<li class="chapter" data-level="6.2" data-path="heatmap-decoration.html"><a href="heatmap-decoration.html#decoration-examples"><i class="fa fa-check"></i><b>6.2</b> Examples</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="heatmap-decoration.html"><a href="heatmap-decoration.html#barplot-for-single-column-heatmap"><i class="fa fa-check"></i><b>6.2.1</b> Barplot for single-column heatmap</a></li>
<li class="chapter" data-level="6.2.2" data-path="heatmap-decoration.html"><a href="heatmap-decoration.html#add-titles-for-row-annotations"><i class="fa fa-check"></i><b>6.2.2</b> Add titles for row annotations</a></li>
<li class="chapter" data-level="6.2.3" data-path="heatmap-decoration.html"><a href="heatmap-decoration.html#other-possible-use-of-decorations"><i class="fa fa-check"></i><b>6.2.3</b> Other possible use of decorations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="oncoprint.html"><a href="oncoprint.html"><i class="fa fa-check"></i><b>7</b> OncoPrint</a>
<ul>
<li class="chapter" data-level="7.1" data-path="oncoprint.html"><a href="oncoprint.html#oncoprint-general-settings"><i class="fa fa-check"></i><b>7.1</b> General settings</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="oncoprint.html"><a href="oncoprint.html#input-data-format"><i class="fa fa-check"></i><b>7.1.1</b> Input data format</a></li>
<li class="chapter" data-level="7.1.2" data-path="oncoprint.html"><a href="oncoprint.html#define-the-alter-fun"><i class="fa fa-check"></i><b>7.1.2</b> Define the alter_fun()</a></li>
<li class="chapter" data-level="7.1.3" data-path="oncoprint.html"><a href="oncoprint.html#oncoprint-background"><i class="fa fa-check"></i><b>7.1.3</b> Background</a></li>
<li class="chapter" data-level="7.1.4" data-path="oncoprint.html"><a href="oncoprint.html#complex-alteration-types"><i class="fa fa-check"></i><b>7.1.4</b> Complex alteration types</a></li>
<li class="chapter" data-level="7.1.5" data-path="oncoprint.html"><a href="oncoprint.html#simplify-alter_fun"><i class="fa fa-check"></i><b>7.1.5</b> Simplify alter_fun</a></li>
<li class="chapter" data-level="7.1.6" data-path="oncoprint.html"><a href="oncoprint.html#other-heatmap-related-settings"><i class="fa fa-check"></i><b>7.1.6</b> Other heatmap-related settings</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="oncoprint.html"><a href="oncoprint.html#apply-to-cbioportal-dataset"><i class="fa fa-check"></i><b>7.2</b> Apply to cBioPortal dataset</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="oncoprint.html"><a href="oncoprint.html#remove-empty-rows-and-columns"><i class="fa fa-check"></i><b>7.2.1</b> Remove empty rows and columns</a></li>
<li class="chapter" data-level="7.2.2" data-path="oncoprint.html"><a href="oncoprint.html#reorder-the-oncoprint"><i class="fa fa-check"></i><b>7.2.2</b> Reorder the oncoPrint</a></li>
<li class="chapter" data-level="7.2.3" data-path="oncoprint.html"><a href="oncoprint.html#oncoprint-annotations"><i class="fa fa-check"></i><b>7.2.3</b> OncoPrint annotations</a></li>
<li class="chapter" data-level="7.2.4" data-path="oncoprint.html"><a href="oncoprint.html#oncoprint-as-a-heatmap"><i class="fa fa-check"></i><b>7.2.4</b> oncoPrint as a Heatmap</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="upset-plot.html"><a href="upset-plot.html"><i class="fa fa-check"></i><b>8</b> UpSet plot</a>
<ul>
<li class="chapter" data-level="8.1" data-path="upset-plot.html"><a href="upset-plot.html#input-data"><i class="fa fa-check"></i><b>8.1</b> Input data</a></li>
<li class="chapter" data-level="8.2" data-path="upset-plot.html"><a href="upset-plot.html#upset-mode"><i class="fa fa-check"></i><b>8.2</b> Mode</a></li>
<li class="chapter" data-level="8.3" data-path="upset-plot.html"><a href="upset-plot.html#make-the-combination-matrix"><i class="fa fa-check"></i><b>8.3</b> Make the combination matrix</a></li>
<li class="chapter" data-level="8.4" data-path="upset-plot.html"><a href="upset-plot.html#upset-utility-functions"><i class="fa fa-check"></i><b>8.4</b> Utility functions</a></li>
<li class="chapter" data-level="8.5" data-path="upset-plot.html"><a href="upset-plot.html#upset-making-the-plot"><i class="fa fa-check"></i><b>8.5</b> Make the plot</a></li>
<li class="chapter" data-level="8.6" data-path="upset-plot.html"><a href="upset-plot.html#upset-plots-as-heatmaps"><i class="fa fa-check"></i><b>8.6</b> UpSet plots as heatmaps</a></li>
<li class="chapter" data-level="8.7" data-path="upset-plot.html"><a href="upset-plot.html#example-with-the-movies-dataset"><i class="fa fa-check"></i><b>8.7</b> Example with the movies dataset</a></li>
<li class="chapter" data-level="8.8" data-path="upset-plot.html"><a href="upset-plot.html#example-with-the-genomic-regions"><i class="fa fa-check"></i><b>8.8</b> Example with the genomic regions</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="interactive.html"><a href="interactive.html"><i class="fa fa-check"></i><b>9</b> Interactive ComplexHeatmap</a></li>
<li class="chapter" data-level="10" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html"><i class="fa fa-check"></i><b>10</b> Integrate with other packages</a>
<ul>
<li class="chapter" data-level="10.1" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html#pheatmap"><i class="fa fa-check"></i><b>10.1</b> pheatmap</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html#examples"><i class="fa fa-check"></i><b>10.1.1</b> Examples</a></li>
<li class="chapter" data-level="10.1.2" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html#translation"><i class="fa fa-check"></i><b>10.1.2</b> Translation</a></li>
<li class="chapter" data-level="10.1.3" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html#comparisons"><i class="fa fa-check"></i><b>10.1.3</b> Comparisons</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html#cowplot"><i class="fa fa-check"></i><b>10.2</b> cowplot</a></li>
<li class="chapter" data-level="10.3" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html#gridtext"><i class="fa fa-check"></i><b>10.3</b> gridtext</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html#gridtext-title"><i class="fa fa-check"></i><b>10.3.1</b> Titles</a></li>
<li class="chapter" data-level="10.3.2" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html#gridtext-dimnames"><i class="fa fa-check"></i><b>10.3.2</b> Row/column names</a></li>
<li class="chapter" data-level="10.3.3" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html#gridtext-annotations"><i class="fa fa-check"></i><b>10.3.3</b> Annotation labels</a></li>
<li class="chapter" data-level="10.3.4" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html#gridtext-anno-text"><i class="fa fa-check"></i><b>10.3.4</b> Text annotation</a></li>
<li class="chapter" data-level="10.3.5" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html#gridtext-legends"><i class="fa fa-check"></i><b>10.3.5</b> Legend</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="other-high-level-plots.html"><a href="other-high-level-plots.html"><i class="fa fa-check"></i><b>11</b> Other High-level Plots</a>
<ul>
<li class="chapter" data-level="11.1" data-path="other-high-level-plots.html"><a href="other-high-level-plots.html#density-heatmap"><i class="fa fa-check"></i><b>11.1</b> Density heatmap</a></li>
<li class="chapter" data-level="11.2" data-path="other-high-level-plots.html"><a href="other-high-level-plots.html#stacked-summary-plot"><i class="fa fa-check"></i><b>11.2</b> Stacked summary plot</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="three-dimensional-complexheatmap-3d-heatmap.html"><a href="three-dimensional-complexheatmap-3d-heatmap.html"><i class="fa fa-check"></i><b>12</b> Three-dimensional ComplexHeatmap {#3d-heatmap}</a>
<ul>
<li class="chapter" data-level="12.1" data-path="three-dimensional-complexheatmap-3d-heatmap.html"><a href="three-dimensional-complexheatmap-3d-heatmap.html#motivation"><i class="fa fa-check"></i><b>12.1</b> Motivation</a></li>
<li class="chapter" data-level="12.2" data-path="three-dimensional-complexheatmap-3d-heatmap.html"><a href="three-dimensional-complexheatmap-3d-heatmap.html#implementation-of-3d-heatmap"><i class="fa fa-check"></i><b>12.2</b> Implementation of 3D heatmap</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="genome-level-heatmap.html"><a href="genome-level-heatmap.html"><i class="fa fa-check"></i><b>13</b> Genome-level heatmap</a></li>
<li class="chapter" data-level="14" data-path="more-examples.html"><a href="more-examples.html"><i class="fa fa-check"></i><b>14</b> More Examples</a>
<ul>
<li class="chapter" data-level="14.1" data-path="more-examples.html"><a href="more-examples.html#add-more-information-for-gene-expression-matrix"><i class="fa fa-check"></i><b>14.1</b> Add more information for gene expression matrix</a></li>
<li class="chapter" data-level="14.2" data-path="more-examples.html"><a href="more-examples.html#the-measles-vaccine-heatmap"><i class="fa fa-check"></i><b>14.2</b> The measles vaccine heatmap</a></li>
<li class="chapter" data-level="14.3" data-path="more-examples.html"><a href="more-examples.html#visualize-cell-heterogeneity-from-single-cell-rnaseq"><i class="fa fa-check"></i><b>14.3</b> Visualize Cell Heterogeneity from Single Cell RNASeq</a></li>
<li class="chapter" data-level="14.4" data-path="more-examples.html"><a href="more-examples.html#correlations-between-methylation-expression-and-other-genomic-features"><i class="fa fa-check"></i><b>14.4</b> Correlations between methylation, expression and other genomic features</a></li>
<li class="chapter" data-level="14.5" data-path="more-examples.html"><a href="more-examples.html#visualize-methylation-profile-with-complex-annotations"><i class="fa fa-check"></i><b>14.5</b> Visualize Methylation Profile with Complex Annotations</a></li>
<li class="chapter" data-level="14.6" data-path="more-examples.html"><a href="more-examples.html#add-multiple-boxplots-for-single-row"><i class="fa fa-check"></i><b>14.6</b> Add multiple boxplots for single row</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="other-tricks.html"><a href="other-tricks.html"><i class="fa fa-check"></i><b>15</b> Other Tricks</a>
<ul>
<li class="chapter" data-level="15.1" data-path="other-tricks.html"><a href="other-tricks.html#set-the-same-cell-size-for-different-heatmaps-with-different-dimensions"><i class="fa fa-check"></i><b>15.1</b> Set the same cell size for different heatmaps with different dimensions</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ComplexHeatmap Complete Reference</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="other-high-level-plots" class="section level1" number="11">
<h1><span class="header-section-number">Chapter 11</span> Other High-level Plots</h1>
<div id="density-heatmap" class="section level2" number="11.1">
<h2><span class="header-section-number">11.1</span> Density heatmap</h2>
<p>To visualize data distribution in a matrix or in a list, we normally use
boxplot or violin plot. We can also use colors to map the density values and
visualize distribution through a heatmap. It is useful if you have huge number
of columns in data to visualize.</p>
<p>In following examples, we use matrix as input data where the density is
calculated by columns. The input data can also be a list.</p>
<div class="sourceCode" id="cb676"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb676-1"><a href="other-high-level-plots.html#cb676-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb676-2"><a href="other-high-level-plots.html#cb676-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">10</span><span class="sc">*</span><span class="dv">100</span>), <span class="at">ncol =</span> <span class="dv">10</span>),</span>
<span id="cb676-3"><a href="other-high-level-plots.html#cb676-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">matrix</span>(<span class="fu">runif</span>(<span class="dv">10</span><span class="sc">*</span><span class="dv">100</span>, <span class="at">min =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">max =</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="fl">0.5</span>, <span class="at">ncol =</span> <span class="dv">10</span>))</span>
<span id="cb676-4"><a href="other-high-level-plots.html#cb676-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(m) <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">&quot;C&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(m))</span>
<span id="cb676-5"><a href="other-high-level-plots.html#cb676-5" aria-hidden="true" tabindex="-1"></a><span class="fu">densityHeatmap</span>(m)</span></code></pre></div>
<p><img src="11-other-high-level-plots_files/figure-html/unnamed-chunk-1-1.png" width="499.2" style="display: block; margin: auto;" /></p>
<p>On the heatmap, there are also lines representing five quantiles and mean
values.</p>
<p>Data range is controlled by <code>ylim</code>. Title is controlled by <code>title</code> or
<code>column_title</code>. Title on y-axis is controlled by <code>ylab</code>.</p>
<div class="sourceCode" id="cb677"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb677-1"><a href="other-high-level-plots.html#cb677-1" aria-hidden="true" tabindex="-1"></a><span class="fu">densityHeatmap</span>(m, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>), <span class="at">title =</span> <span class="st">&quot;Distribution as heatmap&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;some values&quot;</span>)</span></code></pre></div>
<p><img src="11-other-high-level-plots_files/figure-html/unnamed-chunk-2-1.png" width="499.2" style="display: block; margin: auto;" /></p>
<p>Column order is controlled by <code>column_order</code>.</p>
<div class="sourceCode" id="cb678"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb678-1"><a href="other-high-level-plots.html#cb678-1" aria-hidden="true" tabindex="-1"></a><span class="fu">densityHeatmap</span>(m, <span class="at">column_order =</span> <span class="fu">sample</span>(<span class="dv">20</span>, <span class="dv">20</span>))</span></code></pre></div>
<p><img src="11-other-high-level-plots_files/figure-html/unnamed-chunk-3-1.png" width="499.2" style="display: block; margin: auto;" /></p>
<p>The color for the density values is controlled by <code>col</code> which is a vector of
colors.</p>
<div class="sourceCode" id="cb679"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb679-1"><a href="other-high-level-plots.html#cb679-1" aria-hidden="true" tabindex="-1"></a><span class="fu">densityHeatmap</span>(m, <span class="at">col =</span> <span class="fu">topo.colors</span>(<span class="dv">10</span>))</span></code></pre></div>
<p><img src="11-other-high-level-plots_files/figure-html/unnamed-chunk-4-1.png" width="499.2" style="display: block; margin: auto;" /></p>
<p>Internally, the density for all columns are stored as a matrix where rows
correspond to the same bins. Since it is a matrix, clustering can be applied
on it. There is a special distance method <code>ks</code> for measuring similarity
between distributions which is the Kolmogorov-Smirnov statistic between two
distributions (<code>ks</code> distance is the default if <code>cluster_column = TRUE</code>).</p>
<div class="sourceCode" id="cb680"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb680-1"><a href="other-high-level-plots.html#cb680-1" aria-hidden="true" tabindex="-1"></a><span class="fu">densityHeatmap</span>(m, <span class="at">cluster_columns =</span> <span class="cn">TRUE</span>, <span class="at">clustering_distance_columns =</span> <span class="st">&quot;ks&quot;</span>)</span></code></pre></div>
<p><img src="11-other-high-level-plots_files/figure-html/unnamed-chunk-5-1.png" width="499.2" style="display: block; margin: auto;" /></p>
<p>When there are many distributions to calculate the pairwise Kolmogorov-Smirnov distance,
<code>mc.cores</code> argument can be set to make it running parallelly.</p>
<div class="sourceCode" id="cb681"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb681-1"><a href="other-high-level-plots.html#cb681-1" aria-hidden="true" tabindex="-1"></a><span class="fu">densityHeatmap</span>(m, <span class="at">cluster_columns =</span> <span class="cn">TRUE</span>, <span class="at">mc.cores =</span> ...)</span></code></pre></div>
<p>Column annotations can be added as top annotation or bottom annotation.</p>
<div class="sourceCode" id="cb682"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb682-1"><a href="other-high-level-plots.html#cb682-1" aria-hidden="true" tabindex="-1"></a>ha1 <span class="ot">=</span> <span class="fu">HeatmapAnnotation</span>(<span class="at">dist =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;rnorm&quot;</span>, <span class="dv">10</span>), <span class="fu">rep</span>(<span class="st">&quot;runif&quot;</span>, <span class="dv">10</span>)))</span>
<span id="cb682-2"><a href="other-high-level-plots.html#cb682-2" aria-hidden="true" tabindex="-1"></a>ha2 <span class="ot">=</span> <span class="fu">HeatmapAnnotation</span>(<span class="at">foo =</span> <span class="fu">anno_points</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>)))</span>
<span id="cb682-3"><a href="other-high-level-plots.html#cb682-3" aria-hidden="true" tabindex="-1"></a><span class="fu">densityHeatmap</span>(m, <span class="at">top_annotation =</span> ha1, <span class="at">bottom_annotation =</span> ha2)</span></code></pre></div>
<p><img src="11-other-high-level-plots_files/figure-html/unnamed-chunk-7-1.png" width="499.2" style="display: block; margin: auto;" /></p>
<p>Heatmaps and column annotations can only be concatenated to the density
heatmap vertically.</p>
<div class="sourceCode" id="cb683"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb683-1"><a href="other-high-level-plots.html#cb683-1" aria-hidden="true" tabindex="-1"></a><span class="fu">densityHeatmap</span>(m) <span class="sc">%v%</span></span>
<span id="cb683-2"><a href="other-high-level-plots.html#cb683-2" aria-hidden="true" tabindex="-1"></a><span class="fu">HeatmapAnnotation</span>(<span class="at">foo =</span> <span class="fu">anno_barplot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)) <span class="sc">%v%</span></span>
<span id="cb683-3"><a href="other-high-level-plots.html#cb683-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Heatmap</span>(<span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">20</span><span class="sc">*</span><span class="dv">20</span>), <span class="at">ncol =</span> <span class="dv">20</span>), <span class="at">name =</span> <span class="st">&quot;mat&quot;</span>, <span class="at">height =</span> <span class="fu">unit</span>(<span class="dv">6</span>, <span class="st">&quot;cm&quot;</span>))</span></code></pre></div>
<p><img src="11-other-high-level-plots_files/figure-html/unnamed-chunk-8-1.png" width="499.2" style="display: block; margin: auto;" /></p>
<p>There is also a function <code>frequencyHeatmap()</code> which is like a histogram-version
of density heatmap. The usage is similar as <code>densityHeatmap()</code>:</p>
<div class="sourceCode" id="cb684"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb684-1"><a href="other-high-level-plots.html#cb684-1" aria-hidden="true" tabindex="-1"></a><span class="fu">frequencyHeatmap</span>(m)</span></code></pre></div>
</div>
<div id="stacked-summary-plot" class="section level2" number="11.2">
<h2><span class="header-section-number">11.2</span> Stacked summary plot</h2>
<p>Multiple annotations and heatmaps can be used to visualize multiple summary statistics for a same
set of features. In following example, there are multiple statistics for differential methylated
regions (DMRs) from four different subgroups.</p>
<div class="sourceCode" id="cb685"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb685-1"><a href="other-high-level-plots.html#cb685-1" aria-hidden="true" tabindex="-1"></a>lt <span class="ot">=</span> <span class="fu">readRDS</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="at">package =</span> <span class="st">&quot;ComplexHeatmap&quot;</span>, <span class="st">&quot;dmr_summary.rds&quot;</span>))</span>
<span id="cb685-2"><a href="other-high-level-plots.html#cb685-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(lt)</span></code></pre></div>
<pre><code>##  [1] &quot;label&quot;         &quot;mean_meth&quot;     &quot;n_gr&quot;          &quot;n_corr&quot;       
##  [5] &quot;dist_tss&quot;      &quot;gene_anno&quot;     &quot;cgi_anno&quot;      &quot;mat_enrich_gf&quot;
##  [9] &quot;mat_pct_st&quot;    &quot;mat_enrich_st&quot;</code></pre>
<p>These statistics for DMRs are:</p>
<ul>
<li><code>label</code>: The labels for the sets of DMRs. There are DMRs for four subgroups
and for each subgroup, DMRs are separated into hyper-methylated DMRs and
hypo-methylated DMRs.</li>
<li><code>mean_meth</code>: The mean methylation in DMRs in tumor samples and in normal
samples.</li>
<li><code>n_gr</code> Number of DMRs in each set.</li>
<li><code>n_corr</code>: Percent of DMRs that show significant correlation to nearby genes.
The positive correlation and negative correlation are calculated
separatedly.</li>
<li><code>dist_tss</code>: Distance to nearby gene TSS. The value is proportion of DMRs in
current set which have distance less in 1kb, between 1kb and 5kb, between
5kb and 10kb and more than 10kb.</li>
<li><code>gene_anno</code>: The proportion of DMRs that overlap to genes or intergenic
regions.</li>
<li><code>cgi_anno</code>: The proportion of DMRs that overlap to CpG islands or CGI
shores.</li>
<li><code>mat_enrich_gf</code>: The enrichment to a list of genomic features. Positive
values mean over representation.</li>
<li><code>mat_pct_st</code>: The proprotion of DMRs that overlap to chromatin states.</li>
<li><code>mat_enrich_st</code>: The enrichment to the chromatin states.</li>
</ul>
<p>Attach all these variables to the working environment.</p>
<div class="sourceCode" id="cb687"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb687-1"><a href="other-high-level-plots.html#cb687-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(lt)</span></code></pre></div>
<p>Since we have many statistics to visualize, we first define the colors. We
define color mapping functions for the statistics which we want to visualize
as heatmaps and color vectors for those we want to visualize as barplots.</p>
<div class="sourceCode" id="cb688"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb688-1"><a href="other-high-level-plots.html#cb688-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb688-2"><a href="other-high-level-plots.html#cb688-2" aria-hidden="true" tabindex="-1"></a>meth_col_fun <span class="ot">=</span> <span class="fu">colorRamp2</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;red&quot;</span>))</span>
<span id="cb688-3"><a href="other-high-level-plots.html#cb688-3" aria-hidden="true" tabindex="-1"></a>corr_col <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;green&quot;</span>, <span class="st">&quot;red&quot;</span>)</span>
<span id="cb688-4"><a href="other-high-level-plots.html#cb688-4" aria-hidden="true" tabindex="-1"></a>dist_tss_col <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;#FF0000&quot;</span>, <span class="st">&quot;#FF7352&quot;</span>, <span class="st">&quot;#FFB299&quot;</span>, <span class="st">&quot;#FFD9CB&quot;</span>)</span>
<span id="cb688-5"><a href="other-high-level-plots.html#cb688-5" aria-hidden="true" tabindex="-1"></a>gene_anno_col <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb688-6"><a href="other-high-level-plots.html#cb688-6" aria-hidden="true" tabindex="-1"></a>cgi_anno_col <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;#FFA500&quot;</span>, <span class="st">&quot;#FFD191&quot;</span>)</span>
<span id="cb688-7"><a href="other-high-level-plots.html#cb688-7" aria-hidden="true" tabindex="-1"></a>z_score_col_fun <span class="ot">=</span> <span class="fu">colorRamp2</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">200</span>, <span class="dv">0</span>, <span class="dv">200</span>), <span class="fu">c</span>(<span class="st">&quot;green&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;red&quot;</span>))</span>
<span id="cb688-8"><a href="other-high-level-plots.html#cb688-8" aria-hidden="true" tabindex="-1"></a>state_col <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;#FF0000&quot;</span>, <span class="st">&quot;#008000&quot;</span>, <span class="st">&quot;#C2E105&quot;</span>, <span class="st">&quot;#8A91D0&quot;</span>, <span class="st">&quot;#CD5C5C&quot;</span>, <span class="st">&quot;#808080&quot;</span>, <span class="st">&quot;#000000&quot;</span>)</span></code></pre></div>
<p>The construction of the heatmap list very straightforward. Each statistic is
constructed as a heatmap or a row annotation.</p>
<div class="sourceCode" id="cb689"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb689-1"><a href="other-high-level-plots.html#cb689-1" aria-hidden="true" tabindex="-1"></a>anno_width <span class="ot">=</span> <span class="fu">unit</span>(<span class="dv">3</span>, <span class="st">&quot;cm&quot;</span>)</span>
<span id="cb689-2"><a href="other-high-level-plots.html#cb689-2" aria-hidden="true" tabindex="-1"></a>ht_list <span class="ot">=</span> <span class="fu">rowAnnotation</span>(<span class="at">text =</span> <span class="fu">anno_text</span>(label, <span class="at">location =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>), <span class="at">just =</span> <span class="st">&quot;right&quot;</span>, </span>
<span id="cb689-3"><a href="other-high-level-plots.html#cb689-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">12</span>)))</span>
<span id="cb689-4"><a href="other-high-level-plots.html#cb689-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb689-5"><a href="other-high-level-plots.html#cb689-5" aria-hidden="true" tabindex="-1"></a>ht_list <span class="ot">=</span> ht_list <span class="sc">+</span> <span class="fu">Heatmap</span>(mean_meth, <span class="at">name =</span> <span class="st">&quot;mean_meth&quot;</span>, <span class="at">col =</span> meth_col_fun, </span>
<span id="cb689-6"><a href="other-high-level-plots.html#cb689-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">cluster_rows =</span> <span class="cn">FALSE</span>, <span class="at">row_title =</span> <span class="cn">NULL</span>, <span class="at">cluster_columns =</span> <span class="cn">FALSE</span>, <span class="at">show_row_names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb689-7"><a href="other-high-level-plots.html#cb689-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">heatmap_legend_param =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&quot;Methylation&quot;</span>), <span class="at">width =</span> <span class="fu">ncol</span>(mean_meth)<span class="sc">*</span><span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">&quot;mm&quot;</span>)) <span class="sc">+</span></span>
<span id="cb689-8"><a href="other-high-level-plots.html#cb689-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rowAnnotation</span>(<span class="st">&quot;n_gr&quot;</span> <span class="ot">=</span> <span class="fu">anno_barplot</span>(n_gr, <span class="at">bar_width =</span> <span class="dv">1</span>, <span class="at">width =</span> anno_width), </span>
<span id="cb689-9"><a href="other-high-level-plots.html#cb689-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">show_annotation_name =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb689-10"><a href="other-high-level-plots.html#cb689-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rowAnnotation</span>(<span class="st">&quot;n_corr&quot;</span> <span class="ot">=</span> <span class="fu">anno_barplot</span>(n_corr, <span class="at">bar_width =</span> <span class="dv">1</span>, <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> corr_col), </span>
<span id="cb689-11"><a href="other-high-level-plots.html#cb689-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> anno_width), <span class="at">show_annotation_name =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb689-12"><a href="other-high-level-plots.html#cb689-12" aria-hidden="true" tabindex="-1"></a><span class="fu">rowAnnotation</span>(<span class="st">&quot;dist_tss&quot;</span> <span class="ot">=</span> <span class="fu">anno_barplot</span>(dist_tss, <span class="at">bar_width =</span> <span class="dv">1</span>, <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> dist_tss_col), </span>
<span id="cb689-13"><a href="other-high-level-plots.html#cb689-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> anno_width), <span class="at">show_annotation_name =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb689-14"><a href="other-high-level-plots.html#cb689-14" aria-hidden="true" tabindex="-1"></a><span class="fu">rowAnnotation</span>(<span class="st">&quot;gene_anno&quot;</span> <span class="ot">=</span> <span class="fu">anno_barplot</span>(gene_anno, <span class="at">bar_width =</span> <span class="dv">1</span>, <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> gene_anno_col), </span>
<span id="cb689-15"><a href="other-high-level-plots.html#cb689-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> anno_width), <span class="at">show_annotation_name =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb689-16"><a href="other-high-level-plots.html#cb689-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rowAnnotation</span>(<span class="st">&quot;cgi_anno&quot;</span> <span class="ot">=</span> <span class="fu">anno_barplot</span>(cgi_anno, <span class="at">bar_width =</span> <span class="dv">1</span>, <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> cgi_anno_col), </span>
<span id="cb689-17"><a href="other-high-level-plots.html#cb689-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> anno_width), <span class="at">show_annotation_name =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb689-18"><a href="other-high-level-plots.html#cb689-18" aria-hidden="true" tabindex="-1"></a><span class="fu">Heatmap</span>(mat_enrich_gf, <span class="at">name =</span> <span class="st">&quot;enrich_gf&quot;</span>, <span class="at">col =</span> z_score_col_fun, <span class="at">cluster_columns =</span> <span class="cn">FALSE</span>,</span>
<span id="cb689-19"><a href="other-high-level-plots.html#cb689-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fu">unit</span>(<span class="fu">ncol</span>(mat_enrich_gf)<span class="sc">*</span><span class="dv">4</span>, <span class="st">&quot;mm&quot;</span>), <span class="at">column_title =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb689-20"><a href="other-high-level-plots.html#cb689-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">heatmap_legend_param =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&quot;Z-score&quot;</span>)) <span class="sc">+</span></span>
<span id="cb689-21"><a href="other-high-level-plots.html#cb689-21" aria-hidden="true" tabindex="-1"></a><span class="fu">rowAnnotation</span>(<span class="st">&quot;pct_st&quot;</span> <span class="ot">=</span> <span class="fu">anno_barplot</span>(mat_pct_st, <span class="at">bar_width =</span> <span class="dv">1</span>, <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> state_col), </span>
<span id="cb689-22"><a href="other-high-level-plots.html#cb689-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> anno_width), <span class="at">show_annotation_name =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb689-23"><a href="other-high-level-plots.html#cb689-23" aria-hidden="true" tabindex="-1"></a><span class="fu">Heatmap</span>(mat_enrich_st, <span class="at">name =</span> <span class="st">&quot;enrich_st&quot;</span>, <span class="at">col =</span> z_score_col_fun, <span class="at">cluster_columns =</span> <span class="cn">FALSE</span>, </span>
<span id="cb689-24"><a href="other-high-level-plots.html#cb689-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fu">unit</span>(<span class="fu">ncol</span>(mat_enrich_st)<span class="sc">*</span><span class="dv">6</span>, <span class="st">&quot;mm&quot;</span>), <span class="at">column_title =</span> <span class="st">&quot;&quot;</span>, <span class="at">show_heatmap_legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb689-25"><a href="other-high-level-plots.html#cb689-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_names_gp =</span> <span class="fu">gpar</span>(<span class="at">col =</span> state_col), <span class="at">show_row_names =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>Since annotation barplots do not generate legends, we manually construct these legends
with <code>Legend()</code> function.</p>
<div class="sourceCode" id="cb690"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb690-1"><a href="other-high-level-plots.html#cb690-1" aria-hidden="true" tabindex="-1"></a>lgd_list <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb690-2"><a href="other-high-level-plots.html#cb690-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Legend</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;gene&quot;</span>, <span class="st">&quot;intergenic&quot;</span>), <span class="at">title =</span> <span class="st">&quot;Gene annotation&quot;</span>, </span>
<span id="cb690-3"><a href="other-high-level-plots.html#cb690-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend_gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> gene_anno_col)),</span>
<span id="cb690-4"><a href="other-high-level-plots.html#cb690-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Legend</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;&lt;1kb&quot;</span>, <span class="st">&quot;1kb~5kb&quot;</span>, <span class="st">&quot;5kb~10kb&quot;</span>, <span class="st">&quot;&gt;10kb&quot;</span>), <span class="at">title =</span> <span class="st">&quot;Distance to TSS&quot;</span>, </span>
<span id="cb690-5"><a href="other-high-level-plots.html#cb690-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend_gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> dist_tss_col)),</span>
<span id="cb690-6"><a href="other-high-level-plots.html#cb690-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Legend</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;CGI&quot;</span>, <span class="st">&quot;CGI shore&quot;</span>), <span class="at">title =</span> <span class="st">&quot;CGI annotation&quot;</span>, </span>
<span id="cb690-7"><a href="other-high-level-plots.html#cb690-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend_gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> cgi_anno_col)),</span>
<span id="cb690-8"><a href="other-high-level-plots.html#cb690-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Legend</span>(<span class="at">labels =</span> <span class="fu">colnames</span>(mat_enrich_st), <span class="at">title =</span> <span class="st">&quot;Chromatin states&quot;</span>, </span>
<span id="cb690-9"><a href="other-high-level-plots.html#cb690-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend_gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> state_col))</span>
<span id="cb690-10"><a href="other-high-level-plots.html#cb690-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>When drawing the heatmap list, the rows of all heatmaps and annotations are split into two major
groups. Note in the first <code>Heatmap()</code> which corresponds to the mean methylation matrix, we set
<code>row_title = NULL</code> to remove the row titles which is from row splitting.</p>
<p>Since later we will add titles for the annotations, we allocate white space on top of the whole
plotting region by <code>padding</code> argument. Also we concatenate the self-defined legend list to the
heatmap legend list and put them horizontally at the bottom of the heatmap list.</p>
<div class="sourceCode" id="cb691"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb691-1"><a href="other-high-level-plots.html#cb691-1" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(ht_list, <span class="at">padding =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">20</span>, <span class="dv">2</span>), <span class="st">&quot;mm&quot;</span>), <span class="at">row_split =</span> <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">d+$&quot;</span>, <span class="st">&quot;&quot;</span>, label), </span>
<span id="cb691-2"><a href="other-high-level-plots.html#cb691-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">heatmap_legend_list =</span> lgd_list, <span class="at">heatmap_legend_side =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb691-3"><a href="other-high-level-plots.html#cb691-3" aria-hidden="true" tabindex="-1"></a>anno_title <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;n_gr&quot;</span> <span class="ot">=</span> <span class="st">&quot;Number of</span><span class="sc">\n</span><span class="st">DMRs&quot;</span>, <span class="st">&quot;n_corr&quot;</span> <span class="ot">=</span> <span class="st">&quot;Significantly</span><span class="sc">\n</span><span class="st">correlated genes&quot;</span>,</span>
<span id="cb691-4"><a href="other-high-level-plots.html#cb691-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;gene_anno&quot;</span> <span class="ot">=</span> <span class="st">&quot;Gene annotation&quot;</span>, <span class="st">&quot;dist_tss&quot;</span> <span class="ot">=</span> <span class="st">&quot;Distance to TSS&quot;</span>,</span>
<span id="cb691-5"><a href="other-high-level-plots.html#cb691-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;cgi_anno&quot;</span> <span class="ot">=</span> <span class="st">&quot;CGI annotation&quot;</span>, <span class="st">&quot;pct_st&quot;</span> <span class="ot">=</span> <span class="st">&quot;Overlap to</span><span class="sc">\n</span><span class="st">Chromatin states&quot;</span>)</span>
<span id="cb691-6"><a href="other-high-level-plots.html#cb691-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(an <span class="cf">in</span> <span class="fu">names</span>(anno_title)) {</span>
<span id="cb691-7"><a href="other-high-level-plots.html#cb691-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">decorate_annotation</span>(an, {</span>
<span id="cb691-8"><a href="other-high-level-plots.html#cb691-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">grid.text</span>(anno_title[an], <span class="at">y =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>) <span class="sc">+</span> <span class="fu">unit</span>(<span class="dv">3</span>, <span class="st">&quot;mm&quot;</span>), <span class="at">just =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb691-9"><a href="other-high-level-plots.html#cb691-9" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb691-10"><a href="other-high-level-plots.html#cb691-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb691-11"><a href="other-high-level-plots.html#cb691-11" aria-hidden="true" tabindex="-1"></a>ht_title <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;mean_meth&quot;</span> <span class="ot">=</span> <span class="st">&quot;Mean</span><span class="sc">\n</span><span class="st">methylation&quot;</span>, <span class="st">&quot;enrich_gf&quot;</span> <span class="ot">=</span> <span class="st">&quot;Enrichment to</span><span class="sc">\n</span><span class="st">genomic features&quot;</span>,</span>
<span id="cb691-12"><a href="other-high-level-plots.html#cb691-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;enrich_st&quot;</span> <span class="ot">=</span> <span class="st">&quot;Enrichment to</span><span class="sc">\n</span><span class="st">chromatin states&quot;</span>)</span>
<span id="cb691-13"><a href="other-high-level-plots.html#cb691-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(an <span class="cf">in</span> <span class="fu">names</span>(ht_title)) {</span>
<span id="cb691-14"><a href="other-high-level-plots.html#cb691-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">decorate_heatmap_body</span>(an, {</span>
<span id="cb691-15"><a href="other-high-level-plots.html#cb691-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">grid.text</span>(ht_title[an], <span class="at">y =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>) <span class="sc">+</span> <span class="fu">unit</span>(<span class="dv">3</span>, <span class="st">&quot;mm&quot;</span>), <span class="at">just =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb691-16"><a href="other-high-level-plots.html#cb691-16" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb691-17"><a href="other-high-level-plots.html#cb691-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="11-other-high-level-plots_files/figure-html/unnamed-chunk-15-1.png" width="1344" style="display: block; margin: auto;" /></p>
<p>Similarlly, the multiple statistics can also be arranged vertically.
In following example, we visualize several statistics for a list of genomic regions in 40 samples,
from four subgroups. The statistics are:</p>
<ul>
<li><code>prop</code>: The proportion in the genome.</li>
<li><code>median_length</code>: The median length of regions in each sample.</li>
<li><code>group</code>: subgroup labels.</li>
</ul>
<div class="sourceCode" id="cb692"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb692-1"><a href="other-high-level-plots.html#cb692-1" aria-hidden="true" tabindex="-1"></a>prop <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb692-2"><a href="other-high-level-plots.html#cb692-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">runif</span>(<span class="dv">10</span>, <span class="at">min =</span> <span class="fl">0.1</span>, <span class="at">max =</span> <span class="fl">0.5</span>),</span>
<span id="cb692-3"><a href="other-high-level-plots.html#cb692-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">runif</span>(<span class="dv">10</span>, <span class="at">min =</span> <span class="fl">0.2</span>, <span class="at">max =</span> <span class="fl">0.4</span>),</span>
<span id="cb692-4"><a href="other-high-level-plots.html#cb692-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">runif</span>(<span class="dv">10</span>, <span class="at">min =</span> <span class="fl">0.3</span>, <span class="at">max =</span> <span class="fl">0.6</span>),</span>
<span id="cb692-5"><a href="other-high-level-plots.html#cb692-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">runif</span>(<span class="dv">10</span>, <span class="at">min =</span> <span class="fl">0.4</span>, <span class="at">max =</span> <span class="fl">0.8</span>)</span>
<span id="cb692-6"><a href="other-high-level-plots.html#cb692-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb692-7"><a href="other-high-level-plots.html#cb692-7" aria-hidden="true" tabindex="-1"></a>median_length <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb692-8"><a href="other-high-level-plots.html#cb692-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">runif</span>(<span class="dv">10</span>, <span class="at">min =</span> <span class="dv">5000</span>, <span class="at">max =</span> <span class="dv">10000</span>),</span>
<span id="cb692-9"><a href="other-high-level-plots.html#cb692-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">runif</span>(<span class="dv">10</span>, <span class="at">min =</span> <span class="dv">6000</span>, <span class="at">max =</span> <span class="dv">20000</span>),</span>
<span id="cb692-10"><a href="other-high-level-plots.html#cb692-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">runif</span>(<span class="dv">10</span>, <span class="at">min =</span> <span class="dv">7000</span>, <span class="at">max =</span> <span class="dv">15000</span>),</span>
<span id="cb692-11"><a href="other-high-level-plots.html#cb692-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">runif</span>(<span class="dv">10</span>, <span class="at">min =</span> <span class="dv">6000</span>, <span class="at">max =</span> <span class="dv">30000</span>)</span>
<span id="cb692-12"><a href="other-high-level-plots.html#cb692-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb692-13"><a href="other-high-level-plots.html#cb692-13" aria-hidden="true" tabindex="-1"></a>group <span class="ot">=</span> <span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">each =</span> <span class="dv">10</span>)</span></code></pre></div>
<p>Note in following example, there is no heatmap in the list.</p>
<div class="sourceCode" id="cb693"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb693-1"><a href="other-high-level-plots.html#cb693-1" aria-hidden="true" tabindex="-1"></a>ht_list <span class="ot">=</span> <span class="fu">HeatmapAnnotation</span>(<span class="at">prop =</span> <span class="fu">anno_barplot</span>(prop, <span class="at">height =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb693-2"><a href="other-high-level-plots.html#cb693-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis_param =</span> <span class="fu">list</span>(<span class="at">at =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>), </span>
<span id="cb693-3"><a href="other-high-level-plots.html#cb693-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0%&quot;</span>, <span class="st">&quot;20%&quot;</span>, <span class="st">&quot;40%&quot;</span>, <span class="st">&quot;60%&quot;</span>, <span class="st">&quot;80%&quot;</span>))),</span>
<span id="cb693-4"><a href="other-high-level-plots.html#cb693-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">annotation_name_rot =</span> <span class="dv">90</span>) <span class="sc">%v%</span></span>
<span id="cb693-5"><a href="other-high-level-plots.html#cb693-5" aria-hidden="true" tabindex="-1"></a><span class="fu">HeatmapAnnotation</span>(<span class="at">median_length =</span> <span class="fu">anno_barplot</span>(median_length, <span class="at">height =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb693-6"><a href="other-high-level-plots.html#cb693-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis_param =</span> <span class="fu">list</span>(<span class="at">at =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10000</span>, <span class="dv">20000</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0kb&quot;</span>, <span class="st">&quot;10kb&quot;</span>, <span class="st">&quot;20kb&quot;</span>))),</span>
<span id="cb693-7"><a href="other-high-level-plots.html#cb693-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">annotation_name_rot =</span> <span class="dv">90</span>) <span class="sc">%v%</span></span>
<span id="cb693-8"><a href="other-high-level-plots.html#cb693-8" aria-hidden="true" tabindex="-1"></a><span class="fu">HeatmapAnnotation</span>(<span class="at">group =</span> group)</span>
<span id="cb693-9"><a href="other-high-level-plots.html#cb693-9" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(ht_list, <span class="at">column_title =</span> <span class="st">&quot;Statistics for a list of genomic regions&quot;</span>)</span></code></pre></div>
<p><img src="11-other-high-level-plots_files/figure-html/unnamed-chunk-17-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>For concatenation of multiple annotations, individual annotations can also be put into one single
<code>HeatmapAnnotation()</code>. E.g. previous code is almost exactly the same as following code:</p>
<div class="sourceCode" id="cb694"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb694-1"><a href="other-high-level-plots.html#cb694-1" aria-hidden="true" tabindex="-1"></a><span class="co"># code only for demonstration</span></span>
<span id="cb694-2"><a href="other-high-level-plots.html#cb694-2" aria-hidden="true" tabindex="-1"></a><span class="fu">HeatmapAnnotation</span>(</span>
<span id="cb694-3"><a href="other-high-level-plots.html#cb694-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">prop =</span> <span class="fu">anno_barplot</span>(prop, <span class="at">height =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb694-4"><a href="other-high-level-plots.html#cb694-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis_param =</span> <span class="fu">list</span>(<span class="at">at =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>), </span>
<span id="cb694-5"><a href="other-high-level-plots.html#cb694-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0%&quot;</span>, <span class="st">&quot;20%&quot;</span>, <span class="st">&quot;40%&quot;</span>, <span class="st">&quot;60%&quot;</span>, <span class="st">&quot;80%&quot;</span>))),</span>
<span id="cb694-6"><a href="other-high-level-plots.html#cb694-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_length =</span> <span class="fu">anno_barplot</span>(median_length, <span class="at">height =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb694-7"><a href="other-high-level-plots.html#cb694-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis_param =</span> <span class="fu">list</span>(<span class="at">at =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10000</span>, <span class="dv">20000</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0kb&quot;</span>, <span class="st">&quot;10kb&quot;</span>, <span class="st">&quot;20kb&quot;</span>))),</span>
<span id="cb694-8"><a href="other-high-level-plots.html#cb694-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> group,</span>
<span id="cb694-9"><a href="other-high-level-plots.html#cb694-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">annotation_name_rot =</span> <span class="fu">c</span>(<span class="dv">90</span>, <span class="dv">90</span>, <span class="dv">0</span>),</span>
<span id="cb694-10"><a href="other-high-level-plots.html#cb694-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">gap =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">&quot;mm&quot;</span>)</span>
<span id="cb694-11"><a href="other-high-level-plots.html#cb694-11" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%v%</span> <span class="cn">NULL</span> <span class="co"># add NULL to convert single HeatmapAnnotation to HeatmapList</span></span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="integrate-with-other-packages.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="three-dimensional-complexheatmap-3d-heatmap.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jokergoo/ComplexHeatmap-reference/edit/master/11-other-high-level-plots.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["ComplexHeatmap-reference.epub"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
