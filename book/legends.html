<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Legends | ComplexHeatmap Complete Reference</title>
  <meta name="description" content="Complex heatmaps are efficient to visualize associations between different sources of data sets and reveal potential patterns. Here the ComplexHeatmap R package provides a highly flexible way to arrange multiple heatmaps and supports various annotation graphics. This book is the complete reference to ComplexHeatmap pacakge." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Legends | ComplexHeatmap Complete Reference" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://jokergoo.github.io/ComplexHeatmap-reference/book" />
  <meta property="og:image" content="https://jokergoo.github.io/ComplexHeatmap-reference/book/complexheatmap-cover.jpg" />
  <meta property="og:description" content="Complex heatmaps are efficient to visualize associations between different sources of data sets and reveal potential patterns. Here the ComplexHeatmap R package provides a highly flexible way to arrange multiple heatmaps and supports various annotation graphics. This book is the complete reference to ComplexHeatmap pacakge." />
  <meta name="github-repo" content="jokergoo/ComplexHeatmap-reference" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Legends | ComplexHeatmap Complete Reference" />
  
  <meta name="twitter:description" content="Complex heatmaps are efficient to visualize associations between different sources of data sets and reveal potential patterns. Here the ComplexHeatmap R package provides a highly flexible way to arrange multiple heatmaps and supports various annotation graphics. This book is the complete reference to ComplexHeatmap pacakge." />
  <meta name="twitter:image" content="https://jokergoo.github.io/ComplexHeatmap-reference/book/complexheatmap-cover.jpg" />

<meta name="author" content="Zuguang Gu" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="a-list-of-heatmaps.html"/>
<link rel="next" href="heatmap-decoration.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ComplexHeatmap Complete Reference</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#general-design"><i class="fa fa-check"></i><b>1.1</b> General design</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#a-brief-description-of-following-chapters"><i class="fa fa-check"></i><b>1.2</b> A brief description of following chapters</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html"><i class="fa fa-check"></i><b>2</b> A Single Heatmap</a>
<ul>
<li class="chapter" data-level="2.1" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#colors"><i class="fa fa-check"></i><b>2.1</b> Colors</a></li>
<li class="chapter" data-level="2.2" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#heatmap-titles"><i class="fa fa-check"></i><b>2.2</b> Titles</a></li>
<li class="chapter" data-level="2.3" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#clustering"><i class="fa fa-check"></i><b>2.3</b> Clustering</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#distance-methods"><i class="fa fa-check"></i><b>2.3.1</b> Distance methods</a></li>
<li class="chapter" data-level="2.3.2" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#clustering-methods"><i class="fa fa-check"></i><b>2.3.2</b> Clustering methods</a></li>
<li class="chapter" data-level="2.3.3" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#render-dendrograms"><i class="fa fa-check"></i><b>2.3.3</b> Render dendrograms</a></li>
<li class="chapter" data-level="2.3.4" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#reorder-dendrograms"><i class="fa fa-check"></i><b>2.3.4</b> Reorder dendrograms</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#row-and_column_orders"><i class="fa fa-check"></i><b>2.4</b> Set row and column orders</a></li>
<li class="chapter" data-level="2.5" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#heatmap-seriation"><i class="fa fa-check"></i><b>2.5</b> Seriation</a></li>
<li class="chapter" data-level="2.6" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#dimension-names"><i class="fa fa-check"></i><b>2.6</b> Dimension names</a></li>
<li class="chapter" data-level="2.7" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#heatmap-split"><i class="fa fa-check"></i><b>2.7</b> Heatmap split</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#split-by-kmeans-clustering"><i class="fa fa-check"></i><b>2.7.1</b> Split by k-means clustering</a></li>
<li class="chapter" data-level="2.7.2" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#split-by-categorical-variables"><i class="fa fa-check"></i><b>2.7.2</b> Split by categorical variables</a></li>
<li class="chapter" data-level="2.7.3" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#spilt-by-dendrogram"><i class="fa fa-check"></i><b>2.7.3</b> Split by dendrogram</a></li>
<li class="chapter" data-level="2.7.4" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#order-of-slices"><i class="fa fa-check"></i><b>2.7.4</b> Order of slices</a></li>
<li class="chapter" data-level="2.7.5" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#titles-for-splitting"><i class="fa fa-check"></i><b>2.7.5</b> Titles for splitting</a></li>
<li class="chapter" data-level="2.7.6" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#graphic-parameters-for-splitting"><i class="fa fa-check"></i><b>2.7.6</b> Graphic parameters for splitting</a></li>
<li class="chapter" data-level="2.7.7" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#gaps-between-slices"><i class="fa fa-check"></i><b>2.7.7</b> Gaps between slices</a></li>
<li class="chapter" data-level="2.7.8" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#split-heatmap-annotations"><i class="fa fa-check"></i><b>2.7.8</b> Split heatmap annotations</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#heatmap-as-raster-image"><i class="fa fa-check"></i><b>2.8</b> Heatmap as raster image</a></li>
<li class="chapter" data-level="2.9" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#customize-the-heatmap-body"><i class="fa fa-check"></i><b>2.9</b> Customize the heatmap body</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#cell-fun"><i class="fa fa-check"></i><b>2.9.1</b> cell_fun</a></li>
<li class="chapter" data-level="2.9.2" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#layer-fun"><i class="fa fa-check"></i><b>2.9.2</b> layer_fun</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#size-of-the-heatmap"><i class="fa fa-check"></i><b>2.10</b> Size of the heatmap</a></li>
<li class="chapter" data-level="2.11" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#plot-the-heatmap"><i class="fa fa-check"></i><b>2.11</b> Plot the heatmap</a></li>
<li class="chapter" data-level="2.12" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#get-orders-and-dendrograms-from-heatmap"><i class="fa fa-check"></i><b>2.12</b> Get orders and dendrograms</a></li>
<li class="chapter" data-level="2.13" data-path="a-single-heatmap.html"><a href="a-single-heatmap.html#subset-a-heatmap"><i class="fa fa-check"></i><b>2.13</b> Subset a heatmap</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html"><i class="fa fa-check"></i><b>3</b> Heatmap Annotations</a>
<ul>
<li class="chapter" data-level="3.1" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#simple-annotation"><i class="fa fa-check"></i><b>3.1</b> Simple annotation</a></li>
<li class="chapter" data-level="3.2" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#simple-annotation-as-an-annotation-function"><i class="fa fa-check"></i><b>3.2</b> Simple annotation as an annotation function</a></li>
<li class="chapter" data-level="3.3" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#empty-annotation"><i class="fa fa-check"></i><b>3.3</b> Empty annotation</a></li>
<li class="chapter" data-level="3.4" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#block-annotation"><i class="fa fa-check"></i><b>3.4</b> Block annotation</a></li>
<li class="chapter" data-level="3.5" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#image-annotation"><i class="fa fa-check"></i><b>3.5</b> Image annotation</a></li>
<li class="chapter" data-level="3.6" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#points-annotation"><i class="fa fa-check"></i><b>3.6</b> Points annotation</a></li>
<li class="chapter" data-level="3.7" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#lines-annotation"><i class="fa fa-check"></i><b>3.7</b> Lines annotation</a></li>
<li class="chapter" data-level="3.8" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#barplot_annotation"><i class="fa fa-check"></i><b>3.8</b> Barplot annotation</a></li>
<li class="chapter" data-level="3.9" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#box-annotation"><i class="fa fa-check"></i><b>3.9</b> Boxplot annotation</a></li>
<li class="chapter" data-level="3.10" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#histogram-annotation"><i class="fa fa-check"></i><b>3.10</b> Histogram annotation</a></li>
<li class="chapter" data-level="3.11" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#density-annotation"><i class="fa fa-check"></i><b>3.11</b> Density annotation</a></li>
<li class="chapter" data-level="3.12" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#joyplot-annotation"><i class="fa fa-check"></i><b>3.12</b> Joyplot annotation</a></li>
<li class="chapter" data-level="3.13" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#horizon-chart-annotation"><i class="fa fa-check"></i><b>3.13</b> Horizon chart annotation</a></li>
<li class="chapter" data-level="3.14" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#text-annotation"><i class="fa fa-check"></i><b>3.14</b> Text annotation</a></li>
<li class="chapter" data-level="3.15" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#mark-annotation"><i class="fa fa-check"></i><b>3.15</b> Mark annotation</a></li>
<li class="chapter" data-level="3.16" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#summary-annotation"><i class="fa fa-check"></i><b>3.16</b> Summary annotation</a></li>
<li class="chapter" data-level="3.17" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#zoom-annotation"><i class="fa fa-check"></i><b>3.17</b> Zoom/link annotation</a></li>
<li class="chapter" data-level="3.18" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#multiple-annotations"><i class="fa fa-check"></i><b>3.18</b> Multiple annotations</a>
<ul>
<li class="chapter" data-level="3.18.1" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#heatmap-annotation-general-settings"><i class="fa fa-check"></i><b>3.18.1</b> General settings</a></li>
<li class="chapter" data-level="3.18.2" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#size-of-annotations"><i class="fa fa-check"></i><b>3.18.2</b> Size of annotations</a></li>
<li class="chapter" data-level="3.18.3" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#annotation-labels"><i class="fa fa-check"></i><b>3.18.3</b> Annotation labels</a></li>
</ul></li>
<li class="chapter" data-level="3.19" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#heatmap-annotation-utility-function"><i class="fa fa-check"></i><b>3.19</b> Utility functions</a></li>
<li class="chapter" data-level="3.20" data-path="heatmap-annotations.html"><a href="heatmap-annotations.html#implement-new-annotation-functions"><i class="fa fa-check"></i><b>3.20</b> Implement new annotation functions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html"><i class="fa fa-check"></i><b>4</b> A List of Heatmaps</a>
<ul>
<li class="chapter" data-level="4.1" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#heatmap-list-titles"><i class="fa fa-check"></i><b>4.1</b> Titles</a></li>
<li class="chapter" data-level="4.2" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#size-of-heatmaps"><i class="fa fa-check"></i><b>4.2</b> Size of heatmaps</a></li>
<li class="chapter" data-level="4.3" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#gap-between-heatmaps"><i class="fa fa-check"></i><b>4.3</b> Gap between heatmaps</a></li>
<li class="chapter" data-level="4.4" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#automatic-adjustment-to-the-main-heatmap"><i class="fa fa-check"></i><b>4.4</b> Automatic adjustment to the main heatmap</a></li>
<li class="chapter" data-level="4.5" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#control-main-heatmap-in-draw-function"><i class="fa fa-check"></i><b>4.5</b> Control main heatmap in draw() function</a></li>
<li class="chapter" data-level="4.6" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#annotations-as-components-are-adjusted"><i class="fa fa-check"></i><b>4.6</b> Annotations as components are adjusted</a></li>
<li class="chapter" data-level="4.7" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#concatenate-with-annotations"><i class="fa fa-check"></i><b>4.7</b> Concatenate with annotations</a></li>
<li class="chapter" data-level="4.8" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#concatenate-only-the-annotations"><i class="fa fa-check"></i><b>4.8</b> Concatenate only the annotations</a></li>
<li class="chapter" data-level="4.9" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#vertical-concatenation"><i class="fa fa-check"></i><b>4.9</b> Vertical concatenation</a></li>
<li class="chapter" data-level="4.10" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#subset-heatmap-list"><i class="fa fa-check"></i><b>4.10</b> Subset the heatmap list</a></li>
<li class="chapter" data-level="4.11" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#plot-the-heamtap-list"><i class="fa fa-check"></i><b>4.11</b> Plot the heatmap list</a></li>
<li class="chapter" data-level="4.12" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#get-orders-and-dendrograms-from-a-list-of-heatmaps"><i class="fa fa-check"></i><b>4.12</b> Get orders and dendrograms</a></li>
<li class="chapter" data-level="4.13" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#change-parameters-globally"><i class="fa fa-check"></i><b>4.13</b> Change parameters globally</a></li>
<li class="chapter" data-level="4.14" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#adjust-blank-space-caused-by-annotations"><i class="fa fa-check"></i><b>4.14</b> Adjust blank space caused by annotations</a></li>
<li class="chapter" data-level="4.15" data-path="a-list-of-heatmaps.html"><a href="a-list-of-heatmaps.html#manually-increase-space-around-the-plot"><i class="fa fa-check"></i><b>4.15</b> Manually increase space around the plot</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="legends.html"><a href="legends.html"><i class="fa fa-check"></i><b>5</b> Legends</a>
<ul>
<li class="chapter" data-level="5.1" data-path="legends.html"><a href="legends.html#continuous-legends"><i class="fa fa-check"></i><b>5.1</b> Continuous legends</a></li>
<li class="chapter" data-level="5.2" data-path="legends.html"><a href="legends.html#discrete-legends"><i class="fa fa-check"></i><b>5.2</b> Discrete legends</a></li>
<li class="chapter" data-level="5.3" data-path="legends.html"><a href="legends.html#a-list-of-legends"><i class="fa fa-check"></i><b>5.3</b> A list of legends</a></li>
<li class="chapter" data-level="5.4" data-path="legends.html"><a href="legends.html#heatmap-and-annotation-legends"><i class="fa fa-check"></i><b>5.4</b> Heatmap and annotation legends</a></li>
<li class="chapter" data-level="5.5" data-path="legends.html"><a href="legends.html#add-customized-legends"><i class="fa fa-check"></i><b>5.5</b> Add customized legends</a></li>
<li class="chapter" data-level="5.6" data-path="legends.html"><a href="legends.html#the-side-of-legends"><i class="fa fa-check"></i><b>5.6</b> The side of legends</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="heatmap-decoration.html"><a href="heatmap-decoration.html"><i class="fa fa-check"></i><b>6</b> Heatmap Decoration</a>
<ul>
<li class="chapter" data-level="6.1" data-path="heatmap-decoration.html"><a href="heatmap-decoration.html#decoration-functions"><i class="fa fa-check"></i><b>6.1</b> Decoration functions</a></li>
<li class="chapter" data-level="6.2" data-path="heatmap-decoration.html"><a href="heatmap-decoration.html#decoration-examples"><i class="fa fa-check"></i><b>6.2</b> Examples</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="heatmap-decoration.html"><a href="heatmap-decoration.html#barplot-for-single-column-heatmap"><i class="fa fa-check"></i><b>6.2.1</b> Barplot for single-column heatmap</a></li>
<li class="chapter" data-level="6.2.2" data-path="heatmap-decoration.html"><a href="heatmap-decoration.html#add-titles-for-row-annotations"><i class="fa fa-check"></i><b>6.2.2</b> Add titles for row annotations</a></li>
<li class="chapter" data-level="6.2.3" data-path="heatmap-decoration.html"><a href="heatmap-decoration.html#other-possible-use-of-decorations"><i class="fa fa-check"></i><b>6.2.3</b> Other possible use of decorations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="oncoprint.html"><a href="oncoprint.html"><i class="fa fa-check"></i><b>7</b> OncoPrint</a>
<ul>
<li class="chapter" data-level="7.1" data-path="oncoprint.html"><a href="oncoprint.html#oncoprint-general-settings"><i class="fa fa-check"></i><b>7.1</b> General settings</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="oncoprint.html"><a href="oncoprint.html#input-data-format"><i class="fa fa-check"></i><b>7.1.1</b> Input data format</a></li>
<li class="chapter" data-level="7.1.2" data-path="oncoprint.html"><a href="oncoprint.html#define-the-alter-fun"><i class="fa fa-check"></i><b>7.1.2</b> Define the alter_fun()</a></li>
<li class="chapter" data-level="7.1.3" data-path="oncoprint.html"><a href="oncoprint.html#oncoprint-background"><i class="fa fa-check"></i><b>7.1.3</b> Background</a></li>
<li class="chapter" data-level="7.1.4" data-path="oncoprint.html"><a href="oncoprint.html#complex-alteration-types"><i class="fa fa-check"></i><b>7.1.4</b> Complex alteration types</a></li>
<li class="chapter" data-level="7.1.5" data-path="oncoprint.html"><a href="oncoprint.html#simplify-alter_fun"><i class="fa fa-check"></i><b>7.1.5</b> Simplify alter_fun</a></li>
<li class="chapter" data-level="7.1.6" data-path="oncoprint.html"><a href="oncoprint.html#other-heatmap-related-settings"><i class="fa fa-check"></i><b>7.1.6</b> Other heatmap-related settings</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="oncoprint.html"><a href="oncoprint.html#apply-to-cbioportal-dataset"><i class="fa fa-check"></i><b>7.2</b> Apply to cBioPortal dataset</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="oncoprint.html"><a href="oncoprint.html#remove-empty-rows-and-columns"><i class="fa fa-check"></i><b>7.2.1</b> Remove empty rows and columns</a></li>
<li class="chapter" data-level="7.2.2" data-path="oncoprint.html"><a href="oncoprint.html#reorder-the-oncoprint"><i class="fa fa-check"></i><b>7.2.2</b> Reorder the oncoPrint</a></li>
<li class="chapter" data-level="7.2.3" data-path="oncoprint.html"><a href="oncoprint.html#oncoprint-annotations"><i class="fa fa-check"></i><b>7.2.3</b> OncoPrint annotations</a></li>
<li class="chapter" data-level="7.2.4" data-path="oncoprint.html"><a href="oncoprint.html#oncoprint-as-a-heatmap"><i class="fa fa-check"></i><b>7.2.4</b> oncoPrint as a Heatmap</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="upset-plot.html"><a href="upset-plot.html"><i class="fa fa-check"></i><b>8</b> UpSet plot</a>
<ul>
<li class="chapter" data-level="8.1" data-path="upset-plot.html"><a href="upset-plot.html#input-data"><i class="fa fa-check"></i><b>8.1</b> Input data</a></li>
<li class="chapter" data-level="8.2" data-path="upset-plot.html"><a href="upset-plot.html#upset-mode"><i class="fa fa-check"></i><b>8.2</b> Mode</a></li>
<li class="chapter" data-level="8.3" data-path="upset-plot.html"><a href="upset-plot.html#make-the-combination-matrix"><i class="fa fa-check"></i><b>8.3</b> Make the combination matrix</a></li>
<li class="chapter" data-level="8.4" data-path="upset-plot.html"><a href="upset-plot.html#upset-utility-functions"><i class="fa fa-check"></i><b>8.4</b> Utility functions</a></li>
<li class="chapter" data-level="8.5" data-path="upset-plot.html"><a href="upset-plot.html#upset-making-the-plot"><i class="fa fa-check"></i><b>8.5</b> Make the plot</a></li>
<li class="chapter" data-level="8.6" data-path="upset-plot.html"><a href="upset-plot.html#upset-plots-as-heatmaps"><i class="fa fa-check"></i><b>8.6</b> UpSet plots as heatmaps</a></li>
<li class="chapter" data-level="8.7" data-path="upset-plot.html"><a href="upset-plot.html#example-with-the-movies-dataset"><i class="fa fa-check"></i><b>8.7</b> Example with the movies dataset</a></li>
<li class="chapter" data-level="8.8" data-path="upset-plot.html"><a href="upset-plot.html#example-with-the-genomic-regions"><i class="fa fa-check"></i><b>8.8</b> Example with the genomic regions</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="interactive.html"><a href="interactive.html"><i class="fa fa-check"></i><b>9</b> Interactive ComplexHeatmap</a></li>
<li class="chapter" data-level="10" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html"><i class="fa fa-check"></i><b>10</b> Integrate with other packages</a>
<ul>
<li class="chapter" data-level="10.1" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html#pheatmap"><i class="fa fa-check"></i><b>10.1</b> pheatmap</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html#examples"><i class="fa fa-check"></i><b>10.1.1</b> Examples</a></li>
<li class="chapter" data-level="10.1.2" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html#translation"><i class="fa fa-check"></i><b>10.1.2</b> Translation</a></li>
<li class="chapter" data-level="10.1.3" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html#comparisons"><i class="fa fa-check"></i><b>10.1.3</b> Comparisons</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html#cowplot"><i class="fa fa-check"></i><b>10.2</b> cowplot</a></li>
<li class="chapter" data-level="10.3" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html#gridtext"><i class="fa fa-check"></i><b>10.3</b> gridtext</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html#gridtext-title"><i class="fa fa-check"></i><b>10.3.1</b> Titles</a></li>
<li class="chapter" data-level="10.3.2" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html#gridtext-dimnames"><i class="fa fa-check"></i><b>10.3.2</b> Row/column names</a></li>
<li class="chapter" data-level="10.3.3" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html#gridtext-annotations"><i class="fa fa-check"></i><b>10.3.3</b> Annotation labels</a></li>
<li class="chapter" data-level="10.3.4" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html#gridtext-anno-text"><i class="fa fa-check"></i><b>10.3.4</b> Text annotation</a></li>
<li class="chapter" data-level="10.3.5" data-path="integrate-with-other-packages.html"><a href="integrate-with-other-packages.html#gridtext-legends"><i class="fa fa-check"></i><b>10.3.5</b> Legend</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="other-high-level-plots.html"><a href="other-high-level-plots.html"><i class="fa fa-check"></i><b>11</b> Other High-level Plots</a>
<ul>
<li class="chapter" data-level="11.1" data-path="other-high-level-plots.html"><a href="other-high-level-plots.html#density-heatmap"><i class="fa fa-check"></i><b>11.1</b> Density heatmap</a></li>
<li class="chapter" data-level="11.2" data-path="other-high-level-plots.html"><a href="other-high-level-plots.html#stacked-summary-plot"><i class="fa fa-check"></i><b>11.2</b> Stacked summary plot</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="three-dimensional-complexheatmap-3d-heatmap.html"><a href="three-dimensional-complexheatmap-3d-heatmap.html"><i class="fa fa-check"></i><b>12</b> Three-dimensional ComplexHeatmap {#3d-heatmap}</a>
<ul>
<li class="chapter" data-level="12.1" data-path="three-dimensional-complexheatmap-3d-heatmap.html"><a href="three-dimensional-complexheatmap-3d-heatmap.html#motivation"><i class="fa fa-check"></i><b>12.1</b> Motivation</a></li>
<li class="chapter" data-level="12.2" data-path="three-dimensional-complexheatmap-3d-heatmap.html"><a href="three-dimensional-complexheatmap-3d-heatmap.html#implementation-of-3d-heatmap"><i class="fa fa-check"></i><b>12.2</b> Implementation of 3D heatmap</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="genome-level-heatmap.html"><a href="genome-level-heatmap.html"><i class="fa fa-check"></i><b>13</b> Genome-level heatmap</a></li>
<li class="chapter" data-level="14" data-path="more-examples.html"><a href="more-examples.html"><i class="fa fa-check"></i><b>14</b> More Examples</a>
<ul>
<li class="chapter" data-level="14.1" data-path="more-examples.html"><a href="more-examples.html#add-more-information-for-gene-expression-matrix"><i class="fa fa-check"></i><b>14.1</b> Add more information for gene expression matrix</a></li>
<li class="chapter" data-level="14.2" data-path="more-examples.html"><a href="more-examples.html#the-measles-vaccine-heatmap"><i class="fa fa-check"></i><b>14.2</b> The measles vaccine heatmap</a></li>
<li class="chapter" data-level="14.3" data-path="more-examples.html"><a href="more-examples.html#visualize-cell-heterogeneity-from-single-cell-rnaseq"><i class="fa fa-check"></i><b>14.3</b> Visualize Cell Heterogeneity from Single Cell RNASeq</a></li>
<li class="chapter" data-level="14.4" data-path="more-examples.html"><a href="more-examples.html#correlations-between-methylation-expression-and-other-genomic-features"><i class="fa fa-check"></i><b>14.4</b> Correlations between methylation, expression and other genomic features</a></li>
<li class="chapter" data-level="14.5" data-path="more-examples.html"><a href="more-examples.html#visualize-methylation-profile-with-complex-annotations"><i class="fa fa-check"></i><b>14.5</b> Visualize Methylation Profile with Complex Annotations</a></li>
<li class="chapter" data-level="14.6" data-path="more-examples.html"><a href="more-examples.html#add-multiple-boxplots-for-single-row"><i class="fa fa-check"></i><b>14.6</b> Add multiple boxplots for single row</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="other-tricks.html"><a href="other-tricks.html"><i class="fa fa-check"></i><b>15</b> Other Tricks</a>
<ul>
<li class="chapter" data-level="15.1" data-path="other-tricks.html"><a href="other-tricks.html#set-the-same-cell-size-for-different-heatmaps-with-different-dimensions"><i class="fa fa-check"></i><b>15.1</b> Set the same cell size for different heatmaps with different dimensions</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ComplexHeatmap Complete Reference</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="legends" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> Legends</h1>
<p>The heatmaps and simple annotations automatically generate legends which are
put one the right side of the heatmap. By default there is no legend for
complex annotations, but they can be constructed and added manually (Section
<a href="legends.html#add-customized-legends">5.5</a>). All legends are internally constructed by
<code>Legend()</code> constructor. In later sections, we first introduce the settings for
continuous legends and discrete legends, then we will discuss how to configure
the legends associated with the heatmaps and annotations, and how to add new
legends to the plot.</p>
<p>All the legends (no matter a single legend or a pack of legends) all belong to
the <code>Legends</code> class. The class only has one slot <code>grob</code> which is the real
<code>grid::grob</code> object or the <code>grid::gTree</code> object that records how to draw the
graphics. The wrapping of the <code>Legends</code> class and the methods designed for the
class make legends as single objects and can be drawn like points with
specifying the positions on the viewport.</p>
<p>The legends for heatmaps and annotations can be controlled by
<code>heatmap_legend_param</code> argument in <code>Heatmap()</code>, or <code>annotation_legend_param</code>
argument in <code>HeatmapAnnotation()</code>. <strong>Most of the parameters in <code>Legend()</code>
function can be directly set in the two arguments with the same parameter
name.</strong> The details of setting heatmap legends and annotation legends
parameters are introduced in Section <a href="legends.html#heatmap-and-annotation-legends">5.4</a>.</p>
<div id="continuous-legends" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Continuous legends</h2>
<p>Since most of heatmaps contain continuous values, we first introduce the
settings for the continuous legend.</p>
<p>Continuous legend needs a color mapping function which should be generated by
<code>circlize::colorRamp2()</code>. In the heatmap legends and annotation legends that
are automatically generated, the color mapping functions are passed by the
<code>col</code> argument from <code>Heatmap()</code> or <code>HeatmapAnnotation()</code> function, while if
you construct a self-defined legend, you need to provide the color mapping
function.</p>
<p>The break values provided in the color mapping function (e.g. <code>c(0, 0.5, 1)</code>
in following example) will not exactly be the same as the break values in the
legends). The finally break values presented in the legend are internally
adjusted to make the numbers of labels close to 5 or 6.</p>
<p>First we show the default style of a vertical continuous legend:</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="legends.html#cb373-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlize)</span>
<span id="cb373-2"><a href="legends.html#cb373-2" aria-hidden="true" tabindex="-1"></a>col_fun <span class="ot">=</span> <span class="fu">colorRamp2</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;red&quot;</span>))</span>
<span id="cb373-3"><a href="legends.html#cb373-3" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">col_fun =</span> col_fun, <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-3-1.png" width="52.5490813648294" style="display: block; margin: auto;" /></p>
<p><code>lgd</code> is a <code>Legends</code> class object. The size of the legend can be obtained by
<code>ComplexHeatmap:::width()</code> and <code>ComplexHeatmap:::height()</code> function.</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="legends.html#cb374-1" aria-hidden="true" tabindex="-1"></a>ComplexHeatmap<span class="sc">:::</span><span class="fu">width</span>(lgd)</span></code></pre></div>
<pre><code>## [1] 9.90361111111111mm</code></pre>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="legends.html#cb376-1" aria-hidden="true" tabindex="-1"></a>ComplexHeatmap<span class="sc">:::</span><span class="fu">height</span>(lgd)</span></code></pre></div>
<pre><code>## [1] 30.2744052165491mm</code></pre>
<p>The legend is actually a packed graphic object composed of rectangles, lines
and texts. It can be added to the plot by <code>draw()</code> function. In
<strong>ComplexHeatmap</strong> pacakge, you don’t need to use <code>draw()</code> directly on legend
objects, but it might be useful if you use the legend objects in other places.</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="legends.html#cb378-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pushViewport</span>(<span class="fu">viewport</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">height =</span> <span class="fl">0.9</span>))</span>
<span id="cb378-2"><a href="legends.html#cb378-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.rect</span>()  <span class="co"># border</span></span>
<span id="cb378-3"><a href="legends.html#cb378-3" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(lgd, <span class="at">x =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>), <span class="at">y =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>), <span class="at">just =</span> <span class="fu">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;bottom&quot;</span>))</span>
<span id="cb378-4"><a href="legends.html#cb378-4" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(lgd, <span class="at">x =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">&quot;npc&quot;</span>), <span class="at">y =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">&quot;npc&quot;</span>))</span>
<span id="cb378-5"><a href="legends.html#cb378-5" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(lgd, <span class="at">x =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>), <span class="at">y =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>), <span class="at">just =</span> <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;top&quot;</span>))</span>
<span id="cb378-6"><a href="legends.html#cb378-6" aria-hidden="true" tabindex="-1"></a><span class="fu">popViewport</span>()</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>If you only want to configure the legends generated by heatmaps or
annotations, you don’t need to construct the <code>Legends</code> object by your own.
<strong>The parameters introduced later can be directly used to customize the
legends by <code>heatmap_legend_param</code> argument in <code>Heatmap()</code> and
<code>annotation_legend_param</code> argument in <code>HeatmapAnnotation()</code></strong> (introduced in
Section
<a href="legends.html#heatmap-and-annotation-legends">5.4</a>). It is still nice to see how these parameters change the
styles of the legend in following examples. Following is a simple example
showing how to configure legends in the heatmap and heatmap annotation.</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="legends.html#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Heatmap</span>(<span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>), <span class="dv">10</span>), </span>
<span id="cb379-2"><a href="legends.html#cb379-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">heatmap_legend_param =</span> <span class="fu">list</span>(</span>
<span id="cb379-3"><a href="legends.html#cb379-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">&quot;rnorm&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">2</span>), </span>
<span id="cb379-4"><a href="legends.html#cb379-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;neg_two&quot;</span>, <span class="st">&quot;zero&quot;</span>, <span class="st">&quot;pos_two&quot;</span>)</span>
<span id="cb379-5"><a href="legends.html#cb379-5" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb379-6"><a href="legends.html#cb379-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">top_annotation =</span> <span class="fu">HeatmapAnnotation</span>(</span>
<span id="cb379-7"><a href="legends.html#cb379-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">foo =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb379-8"><a href="legends.html#cb379-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">annotation_legend_param =</span> <span class="fu">list</span>(<span class="at">foo =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&quot;foo_top_anno&quot;</span>))</span>
<span id="cb379-9"><a href="legends.html#cb379-9" aria-hidden="true" tabindex="-1"></a>    ))</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-6-1.png" width="499.2" style="display: block; margin: auto;" /></p>
<p>In following examples, we only show how to construct the legend object, while
not show the code which draws the legends. Only remember you can use <code>draw()</code>
function on the <code>Legends</code> object to draw the single legend on the plot.</p>
<p>For continuous legend, you can manually adjust the break values in the legend
by setting <code>at</code>. Note the height is automatically adjusted.</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="legends.html#cb380-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">col_fun =</span> col_fun, <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-8-1.png" width="59.9624146981627" style="display: block; margin: auto;" /></p>
<p>The labels corresponding to the break values are set by <code>labels</code>.</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="legends.html#cb381-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">col_fun =</span> col_fun, <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>), </span>
<span id="cb381-2"><a href="legends.html#cb381-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;median&quot;</span>, <span class="st">&quot;high&quot;</span>))</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-10-1.png" width="77.7357480314961" style="display: block; margin: auto;" /></p>
<p>The height of the vertical continous legend is set by <code>legend_height</code>.
<code>legend_height</code> can only be set for the veritcal continous legend and the
value is the height of the legend body (excluding the legend title).</p>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="legends.html#cb382-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">col_fun =</span> col_fun, <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="at">legend_height =</span> <span class="fu">unit</span>(<span class="dv">6</span>, <span class="st">&quot;cm&quot;</span>))</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-12-1.png" width="52.5490813648294" style="display: block; margin: auto;" /></p>
<p>If it is a vertical legend, <code>grid_width</code> controls the widths of the legend
body. <code>grid_width</code> is originally designed for the discrete legends where the
each level in the legend is a grid, but here we use the same name for the
parameter that controls the width of the legend.</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="legends.html#cb383-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">col_fun =</span> col_fun, <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="at">grid_width =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>))</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-14-1.png" width="75.2262467191601" style="display: block; margin: auto;" /></p>
<p>The graphic parameters for the labels are controlled by <code>labels_gp</code>.</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="legends.html#cb384-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">col_fun =</span> col_fun, <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="at">labels_gp =</span> <span class="fu">gpar</span>(<span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">font =</span> <span class="dv">3</span>))</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-16-1.png" width="52.5490813648294" style="display: block; margin: auto;" /></p>
<p>The border of the legend as well as the ticks for the break values are
controlled by <code>border</code>. The value of <code>border</code> can be logical or a string of
color.</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="legends.html#cb385-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">col_fun =</span> col_fun, <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="at">border =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-18-1.png" width="52.5490813648294" style="display: block; margin: auto;" /></p>
<p><code>title_position</code> controls the position of titles. For vertical legends, the
value should be one of <code>topleft</code>, <code>topcenter</code>, <code>lefttop-rot</code> and
<code>leftcenter-rot</code>. Following two plots show the effect of <code>lefttop-rot</code> title
and <code>leftcenter-rot</code> title.</p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="legends.html#cb386-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">col_fun =</span> col_fun, <span class="at">title =</span> <span class="st">&quot;foooooooo&quot;</span>, <span class="at">title_position =</span> <span class="st">&quot;lefttop-rot&quot;</span>,</span>
<span id="cb386-2"><a href="legends.html#cb386-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend_height =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>))</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-20-1.png" width="69.681469816273" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="legends.html#cb387-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">col_fun =</span> col_fun, <span class="at">title =</span> <span class="st">&quot;foooooooo&quot;</span>, <span class="at">title_position =</span> <span class="st">&quot;leftcenter-rot&quot;</span>,</span>
<span id="cb387-2"><a href="legends.html#cb387-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend_height =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>))</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-22-1.png" width="69.681469816273" style="display: block; margin: auto;" /></p>
<p>Legend titles and labels can be set as mathematical formulas.</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="legends.html#cb388-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">col_fun =</span> col_fun, <span class="at">title =</span> <span class="fu">expression</span>(<span class="fu">hat</span>(beta) <span class="sc">==</span> (X<span class="sc">^</span>t <span class="sc">*</span> X)<span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>} <span class="sc">*</span> X<span class="sc">^</span>t <span class="sc">*</span> y), </span>
<span id="cb388-2"><a href="legends.html#cb388-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">at =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">expression</span>(alpha, beta, gamma, delta, epsilon))</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-24-1.png" width="96.3218139399242" style="display: block; margin: auto;" /></p>
<p>More complicated texts can be added by using the <strong>gridtext</strong> package (Section <a href="integrate-with-other-packages.html#gridtext-legends">10.3.5</a>).</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="legends.html#cb389-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">col_fun =</span> col_fun, </span>
<span id="cb389-2"><a href="legends.html#cb389-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">gt_render</span>(<span class="st">&quot;&lt;span style=&#39;color:orange&#39;&gt;**Legend title**&lt;/span&gt;&quot;</span>), </span>
<span id="cb389-3"><a href="legends.html#cb389-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title_gp =</span> <span class="fu">gpar</span>(<span class="at">box_fill =</span> <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb389-4"><a href="legends.html#cb389-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">at =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">3</span>), </span>
<span id="cb389-5"><a href="legends.html#cb389-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">gt_render</span>(<span class="fu">c</span>(<span class="st">&quot;&lt;span style=&#39;color:blue&#39;&gt;*negative*&lt;/span&gt; three&quot;</span>, <span class="st">&quot;zero&quot;</span>, </span>
<span id="cb389-6"><a href="legends.html#cb389-6" aria-hidden="true" tabindex="-1"></a>                         <span class="st">&quot;&lt;span style=&#39;color:red&#39;&gt;*positive*&lt;/span&gt; three&quot;</span>))</span>
<span id="cb389-7"><a href="legends.html#cb389-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-26-1.png" width="118.175748031496" style="display: block; margin: auto;" /></p>
<p>Settings for horizontal continuous legends are almost the same as vertical
legends, except that now <code>legend_width</code> controls the width of the legend, and
the title position can only be one of <code>topcenter</code>, <code>topleft</code>, <code>lefttop</code> and
<code>leftcenter</code>.</p>
<p>The default style for horizontal legend:</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="legends.html#cb390-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">col_fun =</span> col_fun, <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="at">direction =</span> <span class="st">&quot;horizontal&quot;</span>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-28-1.png" width="151.700157480315" style="display: block; margin: auto;" /></p>
<p>Manually set <code>at</code>:</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="legends.html#cb391-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">col_fun =</span> col_fun, <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="dv">1</span>), </span>
<span id="cb391-2"><a href="legends.html#cb391-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">&quot;horizontal&quot;</span>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-30-1.png" width="140.056482939633" style="display: block; margin: auto;" /></p>
<p>Manually set <code>labels</code>:</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="legends.html#cb392-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">col_fun =</span> col_fun, <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>), </span>
<span id="cb392-2"><a href="legends.html#cb392-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;median&quot;</span>, <span class="st">&quot;high&quot;</span>), <span class="at">direction =</span> <span class="st">&quot;horizontal&quot;</span>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-32-1.png" width="127.649133858268" style="display: block; margin: auto;" /></p>
<p>Set <code>legend_width</code>:</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="legends.html#cb393-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">col_fun =</span> col_fun, <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="at">legend_width =</span> <span class="fu">unit</span>(<span class="dv">6</span>, <span class="st">&quot;cm&quot;</span>), </span>
<span id="cb393-2"><a href="legends.html#cb393-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">&quot;horizontal&quot;</span>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-34-1.png" width="241.889763779528" style="display: block; margin: auto;" /></p>
<p>Set graphic parameters for labels:</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="legends.html#cb394-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">col_fun =</span> col_fun, <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="at">labels_gp =</span> <span class="fu">gpar</span>(<span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">font =</span> <span class="dv">3</span>), </span>
<span id="cb394-2"><a href="legends.html#cb394-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">&quot;horizontal&quot;</span>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-36-1.png" width="151.700157480315" style="display: block; margin: auto;" /></p>
<p>Set rotations of labels.</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="legends.html#cb395-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">col_fun =</span> col_fun, <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="at">labels_rot =</span> <span class="dv">45</span>, </span>
<span id="cb395-2"><a href="legends.html#cb395-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">&quot;horizontal&quot;</span>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-38-1.png" width="166.260590246026" style="display: block; margin: auto;" /></p>
<p>Title can be set as <code>topleft</code>, <code>topcenter</code> or <code>lefttop</code> and <code>leftcenter</code>.</p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="legends.html#cb396-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">col_fun =</span> col_fun, <span class="at">title =</span> <span class="st">&quot;foooooooo&quot;</span>, <span class="at">direction =</span> <span class="st">&quot;horizontal&quot;</span>, </span>
<span id="cb396-2"><a href="legends.html#cb396-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">title_position =</span> <span class="st">&quot;topcenter&quot;</span>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-40-1.png" width="151.700157480315" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="legends.html#cb397-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">col_fun =</span> col_fun, <span class="at">title =</span> <span class="st">&quot;foooooooo&quot;</span>, <span class="at">direction =</span> <span class="st">&quot;horizontal&quot;</span>, </span>
<span id="cb397-2"><a href="legends.html#cb397-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">title_position =</span> <span class="st">&quot;lefttop&quot;</span>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-42-1.png" width="228.605879265092" style="display: block; margin: auto;" /></p>
<p>In examples we showed above, the intervals between every two break values are
equal. Actually <code>at</code> can also be set as break values with uneuqal intervals.
In this scenario, the ticks on the legend are still at the original places
while the corresponding texts are shifted to get rid of overlapping. Then,
there are lines connecting the ticks and the labels.</p>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="legends.html#cb398-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">col_fun =</span> col_fun, <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.15</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-44-1.png" width="71.3009973753281" style="display: block; margin: auto;" /></p>
<p>If the labels do not need to be adjusted, they are still at the original places.</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="legends.html#cb399-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">col_fun =</span> col_fun, <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>, <span class="dv">1</span>), </span>
<span id="cb399-2"><a href="legends.html#cb399-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend_height =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>))</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-46-1.png" width="52.5490813648294" style="display: block; margin: auto;" /></p>
<p>It is similar for the horizontal legends:</p>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="legends.html#cb400-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">col_fun =</span> col_fun, <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.15</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="dv">1</span>),</span>
<span id="cb400-2"><a href="legends.html#cb400-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">&quot;horizontal&quot;</span>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-48-1.png" width="192.997165354331" style="display: block; margin: auto;" /></p>
<p>Set rotations of labels to 90 degree.</p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="legends.html#cb401-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">col_fun =</span> col_fun, <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.15</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="dv">1</span>),</span>
<span id="cb401-2"><a href="legends.html#cb401-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">&quot;horizontal&quot;</span>, <span class="at">title_position =</span> <span class="st">&quot;lefttop&quot;</span>, <span class="at">labels_rot =</span> <span class="dv">90</span>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-50-1.png" width="165.716220472441" style="display: block; margin: auto;" /></p>
<p>When the position of title is set to <code>lefttop</code>, the area below the title will
also be taken into account when calculating the adjusted positions of labels.</p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="legends.html#cb402-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">col_fun =</span> col_fun, <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="dv">1</span>),</span>
<span id="cb402-2"><a href="legends.html#cb402-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;mininal&quot;</span>, <span class="st">&quot;q10&quot;</span>, <span class="st">&quot;median&quot;</span>, <span class="st">&quot;q75&quot;</span>, <span class="st">&quot;maximal&quot;</span>),</span>
<span id="cb402-3"><a href="legends.html#cb402-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">&quot;horizontal&quot;</span>, <span class="at">title_position =</span> <span class="st">&quot;lefttop&quot;</span>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-52-1.png" width="262.882204724409" style="display: block; margin: auto;" /></p>
<p>If <code>at</code> is set in the decreasing order, the legend is reversed, <em>i.e.</em> the smallest value
is on the top of the legend.</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="legends.html#cb403-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">col_fun =</span> col_fun, <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>, <span class="dv">0</span>))</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-54-1.png" width="52.5490813648294" style="display: block; margin: auto;" /></p>
<p>Most continuous legends have legend breaks with equal distance, which I mean,
<em>e.g.</em> the distance between the first and the second breaks are the same as the
distance between the second and the third breaks. However, there are still special
cases where users want to set legend breaks with unequal distances.</p>
<p>In the following example, the color mapping function <code>col_fun_prop</code> visualizes
proportion values with breaks in <code>c(0, 0.05, 0.1, 0.5, 1)</code>. The legend breaks
with unequal distance might reflect the different importance of the values in <code>c(0, 1)</code>.
For example, maybe we want to see more details in the interval <code>c(0, 0.1)</code>.</p>
<p>Following is the default style of the legend where the breaks are selected from 0 to 1
with equal distance.</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="legends.html#cb404-1" aria-hidden="true" tabindex="-1"></a>col_fun_prop <span class="ot">=</span> <span class="fu">colorRamp2</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="dv">1</span>), </span>
<span id="cb404-2"><a href="legends.html#cb404-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;green&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;blue&quot;</span>))</span>
<span id="cb404-3"><a href="legends.html#cb404-3" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">col_fun =</span> col_fun_prop, <span class="at">title =</span> <span class="st">&quot;Prop&quot;</span>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-56-1.png" width="52.5490813648294" style="display: block; margin: auto;" /></p>
<p>You cann’t see the details in the interval <code>c(0, 0.1)</code>, right? This also reminds us that
the breaks set in <code>colorRamp2()</code> only defines the color mapping while not determine
the breaks in the legend.</p>
<p>If we manually select the break values, the color bar keeps the same. The labels
are shifted and lines connect them to the original positions. In this case, the distance
in the color bar is still proportional to the real difference in the break values, <em>i.e.</em>,
the distance between 0.5 and 1 is five times longer than 0 and 0.1.</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="legends.html#cb405-1" aria-hidden="true" tabindex="-1"></a>col_fun_prop <span class="ot">=</span> <span class="fu">colorRamp2</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="dv">1</span>), </span>
<span id="cb405-2"><a href="legends.html#cb405-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;green&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;blue&quot;</span>))</span>
<span id="cb405-3"><a href="legends.html#cb405-3" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">col_fun =</span> col_fun_prop, <span class="at">title =</span> <span class="st">&quot;Prop&quot;</span>,</span>
<span id="cb405-4"><a href="legends.html#cb405-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">at =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-58-1.png" width="71.3009973753281" style="display: block; margin: auto;" /></p>
<p>From version 2.7.1, <code>Legend()</code> function has a new argument <code>break_dist</code> that
controls the distance between two neighbouring break values in the legend.
<strong>It might be confusing, but from here, when I mention “break distance,” it
always means the visual distance in the legend.</strong></p>
<p>The value of <code>break_dist</code> should have length either one which means all break
values have equal distance in the legend, or <code>length(at) - 1</code>.</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="legends.html#cb406-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">col_fun =</span> col_fun_prop, <span class="at">title =</span> <span class="st">&quot;Prop&quot;</span>, <span class="at">break_dist =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-60-1.png" width="59.9624146981627" style="display: block; margin: auto;" /></p>
<p>And in the following example, the top two break intervals are three times longer than
the bottom two intervals.</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="legends.html#cb407-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">col_fun =</span> col_fun_prop, <span class="at">title =</span> <span class="st">&quot;Prop&quot;</span>, <span class="at">break_dist =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>))</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-62-1.png" width="71.3009973753281" style="display: block; margin: auto;" /></p>
<p>If we increase the legend height by <code>legend_height</code> argument, there will be enough space
for the labels and their positions are not adjusted any more.</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="legends.html#cb408-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">col_fun =</span> col_fun_prop, <span class="at">title =</span> <span class="st">&quot;Prop&quot;</span>, <span class="at">break_dist =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>),</span>
<span id="cb408-2"><a href="legends.html#cb408-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend_height =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>))</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-64-1.png" width="59.9624146981627" style="display: block; margin: auto;" /></p>
<p>Imaging following user case, we want to use one color scheme for the values in
<code>c(0, 0.1)</code> and a second color schema for the values in <code>c(0.1, 1)</code>, maybe for
the reason that we want to emphasize the two intervals are very different. The
color mapping can be defined as:</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="legends.html#cb409-1" aria-hidden="true" tabindex="-1"></a>col_fun2 <span class="ot">=</span> <span class="fu">colorRamp2</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.1+1e-6</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="st">&quot;white&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;blue&quot;</span>))</span></code></pre></div>
<p>So here I just added a tiny shift (<code>1e-6</code>) to 0.1 and set it as the lower bound for the
second color scheme. The legend looks like:</p>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="legends.html#cb410-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">col_fun =</span> col_fun2, <span class="at">title =</span> <span class="st">&quot;Prop&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="dv">1</span>),</span>
<span id="cb410-2"><a href="legends.html#cb410-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">break_dist =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">3</span>), <span class="at">legend_height =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>))</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-67-1.png" width="59.9624146981627" style="display: block; margin: auto;" /></p>
<p>Now you can see the colors are not changed smoothly from 0 to 1 and there are two disticnt
color schemes.</p>
</div>
<div id="discrete-legends" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Discrete legends</h2>
<p>Discrete legends are used for discrete color mappings. The continuous color
mapping can also be degenerated as discrete color mapping by only providing
the colors and the break values.</p>
<p>You can either specify <code>at</code> or <code>labels</code>, but most probably you specify
<code>labels</code>. The colors should be specified by <code>legend_gp</code>.</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="legends.html#cb411-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="at">legend_gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>))</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-69-1.png" width="41.4290813648294" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="legends.html#cb412-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">labels =</span> month.name[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>], <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="at">legend_gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>))</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-71-1.png" width="87.5624146981627" style="display: block; margin: auto;" /></p>
<p>The discrete legend for continuous color mapping:</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="legends.html#cb413-1" aria-hidden="true" tabindex="-1"></a>at <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.2</span>)</span>
<span id="cb413-2"><a href="legends.html#cb413-2" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">at =</span> at, <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="at">legend_gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> <span class="fu">col_fun</span>(at)))</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-73-1.png" width="52.5490813648294" style="display: block; margin: auto;" /></p>
<p>The position of title:</p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="legends.html#cb414-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">labels =</span> month.name[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>], <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="at">legend_gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>),</span>
<span id="cb414-2"><a href="legends.html#cb414-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">title_position =</span> <span class="st">&quot;lefttop&quot;</span>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-75-1.png" width="115.58813648294" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="legends.html#cb415-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">labels =</span> month.name[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>], <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="at">legend_gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>),</span>
<span id="cb415-2"><a href="legends.html#cb415-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">title_position =</span> <span class="st">&quot;leftcenter-rot&quot;</span>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-77-1.png" width="104.694803149606" style="display: block; margin: auto;" /></p>
<p>The size of grids are controlled by <code>grid_width</code> and <code>grid_height</code>.</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="legends.html#cb416-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">legend_gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>), <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, </span>
<span id="cb416-2"><a href="legends.html#cb416-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">grid_height =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>), <span class="at">grid_width =</span> <span class="fu">unit</span>(<span class="dv">5</span>, <span class="st">&quot;mm&quot;</span>))</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-79-1.png" width="45.2086089238845" style="display: block; margin: auto;" /></p>
<p>The graphic parameters of labels are controlled by <code>labels_gp</code>.</p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="legends.html#cb417-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">labels =</span> month.name[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>], <span class="at">legend_gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>), <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, </span>
<span id="cb417-2"><a href="legends.html#cb417-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels_gp =</span> <span class="fu">gpar</span>(<span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">fontsize =</span> <span class="dv">14</span>))</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-81-1.png" width="108.981081364829" style="display: block; margin: auto;" /></p>
<p>The graphic parameters of the title are controlled by <code>title_gp</code>.</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="legends.html#cb418-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">labels =</span> month.name[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>], <span class="at">legend_gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>), <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, </span>
<span id="cb418-2"><a href="legends.html#cb418-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">title_gp =</span> <span class="fu">gpar</span>(<span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">fontsize =</span> <span class="dv">14</span>))</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-83-1.png" width="87.5624146981627" style="display: block; margin: auto;" /></p>
<p>Title and labels are be complicated texts by integrating <strong>gridtext</strong> package (Section <a href="integrate-with-other-packages.html#gridtext-legends">10.3.5</a>):</p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="legends.html#cb419-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(</span>
<span id="cb419-2"><a href="legends.html#cb419-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">gt_render</span>(<span class="st">&quot;&lt;span style=&#39;color:orange&#39;&gt;**Legend title**&lt;/span&gt;&quot;</span>), </span>
<span id="cb419-3"><a href="legends.html#cb419-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title_gp =</span> <span class="fu">gpar</span>(<span class="at">box_fill =</span> <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb419-4"><a href="legends.html#cb419-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">at =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">3</span>), </span>
<span id="cb419-5"><a href="legends.html#cb419-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">gt_render</span>(<span class="fu">c</span>(<span class="st">&quot;**negative** three&quot;</span>, <span class="st">&quot;*zero*&quot;</span>, <span class="st">&quot;**positive** three&quot;</span>)),</span>
<span id="cb419-6"><a href="legends.html#cb419-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend_gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb419-7"><a href="legends.html#cb419-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-85-1.png" width="138.922414698163" style="display: block; margin: auto;" /></p>
<p>Borders of grids are controlled by <code>border</code>.</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="legends.html#cb420-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">labels =</span> month.name[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>], <span class="at">legend_gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>), <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, </span>
<span id="cb420-2"><a href="legends.html#cb420-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">border =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-87-1.png" width="87.5624146981627" style="display: block; margin: auto;" /></p>
<p>One important thing for the discrete legend is you can arrange the grids into
multiple rows or/and columns. If <code>ncol</code> is set to a number, the grids are
arranged into <code>ncol</code> columns.</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="legends.html#cb421-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">labels =</span> month.name[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], <span class="at">legend_gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>), </span>
<span id="cb421-2"><a href="legends.html#cb421-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-89-1.png" width="246.795800524934" style="display: block; margin: auto;" /></p>
<p>Still the title position is calculated based on the multiplt-column legend.</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="legends.html#cb422-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">labels =</span> month.name[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], <span class="at">legend_gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>), <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, </span>
<span id="cb422-2"><a href="legends.html#cb422-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">title_position =</span> <span class="st">&quot;topcenter&quot;</span>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-91-1.png" width="246.795800524934" style="display: block; margin: auto;" /></p>
<p>You can choose to list the legend levels by rows by setting <code>by_row = TRUE</code>.</p>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="legends.html#cb423-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">labels =</span> month.name[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], <span class="at">legend_gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>), <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, </span>
<span id="cb423-2"><a href="legends.html#cb423-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">by_row =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-93-1.png" width="253.115800524934" style="display: block; margin: auto;" /></p>
<p>The gaps between two columns are controlled by <code>gap</code> or <code>column_gap</code>. These two arguments
are treated the same.</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="legends.html#cb424-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">labels =</span> month.name[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], <span class="at">legend_gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>), <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, </span>
<span id="cb424-2"><a href="legends.html#cb424-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">gap =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>))</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-95-1.png" width="307.268241469816" style="display: block; margin: auto;" /></p>
<p>The gaps between rows are controlled by <code>row_gap</code>.</p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="legends.html#cb425-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">labels =</span> month.name[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], <span class="at">legend_gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>), <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, </span>
<span id="cb425-2"><a href="legends.html#cb425-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">row_gap =</span> <span class="fu">unit</span>(<span class="dv">5</span>, <span class="st">&quot;mm&quot;</span>))</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-97-1.png" width="246.795800524934" style="display: block; margin: auto;" /></p>
<p>Instead of <code>ncol</code>, you can also specify the layout by <code>nrow</code>. Note you cannot
use <code>ncol</code> and <code>nrow</code> at a same time.</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="legends.html#cb426-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">labels =</span> month.name[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], <span class="at">legend_gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>), </span>
<span id="cb426-2"><a href="legends.html#cb426-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="at">nrow =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-99-1.png" width="308.21249343832" style="display: block; margin: auto;" /></p>
<p>One extreme case is when all levels are put in one row and the title are
rotated by 90 degree. The height of the legend will be the height of the
rotated title.</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="legends.html#cb427-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">labels =</span> month.name[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>], <span class="at">legend_gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>), <span class="at">title =</span> <span class="st">&quot;foooooo&quot;</span>, </span>
<span id="cb427-2"><a href="legends.html#cb427-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">title_position =</span> <span class="st">&quot;lefttop-rot&quot;</span>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-101-1.png" width="401.738267716535" style="display: block; margin: auto;" /></p>
<p>Following style a lot of people might like:</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="legends.html#cb428-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">labels =</span> month.name[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>], <span class="at">legend_gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>), <span class="at">title =</span> <span class="st">&quot;foooooo&quot;</span>, </span>
<span id="cb428-2"><a href="legends.html#cb428-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">title_position =</span> <span class="st">&quot;leftcenter&quot;</span>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-103-1.png" width="445.218267716535" style="display: block; margin: auto;" /></p>
<p><code>Legend()</code> also supports to use simple graphics (e.g. points, lines, boxplots) as
legends. <code>type</code> argument can be specified as <code>points</code> or <code>p</code> that you can use number
for <code>pch</code> or single-letter for <code>pch</code>.</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="legends.html#cb429-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">labels =</span> month.name[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>], <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="at">type =</span> <span class="st">&quot;points&quot;</span>, </span>
<span id="cb429-2"><a href="legends.html#cb429-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">legend_gp =</span> <span class="fu">gpar</span>(<span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>), <span class="at">background =</span> <span class="st">&quot;#FF8080&quot;</span>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-105-1.png" width="87.5624146981627" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="legends.html#cb430-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">labels =</span> month.name[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>], <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="at">type =</span> <span class="st">&quot;points&quot;</span>, </span>
<span id="cb430-2"><a href="legends.html#cb430-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>], <span class="at">legend_gp =</span> <span class="fu">gpar</span>(<span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>), <span class="at">background =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-107-1.png" width="87.5624146981627" style="display: block; margin: auto;" /></p>
<p>Or set <code>type = "lines"</code>/<code>type = "l"</code> to use lines as legend:</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="legends.html#cb431-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">labels =</span> month.name[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>], <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="at">type =</span> <span class="st">&quot;lines&quot;</span>, </span>
<span id="cb431-2"><a href="legends.html#cb431-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend_gp =</span> <span class="fu">gpar</span>(<span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>), <span class="at">grid_width =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>))</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-109-1.png" width="110.239580052493" style="display: block; margin: auto;" /></p>
<p>Or set <code>type = "boxplot"</code>/<code>type = "box"</code> to use boxes as legends:</p>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="legends.html#cb432-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">labels =</span> month.name[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>], <span class="at">title =</span> <span class="st">&quot;foo&quot;</span>, <span class="at">type =</span> <span class="st">&quot;boxplot&quot;</span>,</span>
<span id="cb432-2"><a href="legends.html#cb432-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend_gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>))</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-111-1.png" width="87.5624146981627" style="display: block; margin: auto;" /></p>
<p>When <code>pch</code> is an integer number, the numbers in <code>26:28</code> correspond to following symbols:</p>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="legends.html#cb433-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">labels =</span> <span class="fu">paste0</span>(<span class="st">&quot;pch = &quot;</span>, <span class="dv">26</span><span class="sc">:</span><span class="dv">28</span>), <span class="at">type =</span> <span class="st">&quot;points&quot;</span>, <span class="at">pch =</span> <span class="dv">26</span><span class="sc">:</span><span class="dv">28</span>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-113-1.png" width="85.5357480314961" style="display: block; margin: auto;" /></p>
<p>In all examples showed above, the labels are single lines. Multiple-line labels are also
supported. As shown in the following example, legend grids for multiple-line labels are
automatically enlongated.</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="legends.html#cb434-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;aaaaa</span><span class="sc">\n</span><span class="st">aaaaa&quot;</span>, <span class="st">&quot;bbbbb</span><span class="sc">\n</span><span class="st">bbbbb&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>),</span>
<span id="cb434-2"><a href="legends.html#cb434-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend_gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>))</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-115-1.png" width="71.0824146981627" style="display: block; margin: auto;" /></p>
<p>If the legend is arranged in multiple rows or columns, the sizes of legend grids are adjusted
to the label with the most number of lines.</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="legends.html#cb435-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;aaaaa</span><span class="sc">\n</span><span class="st">aaaaa&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>, <span class="st">&quot;bbbbb</span><span class="sc">\n</span><span class="st">bbbbb&quot;</span>),</span>
<span id="cb435-2"><a href="legends.html#cb435-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend_gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-117-1.png" width="134.072440944882" style="display: block; margin: auto;" /></p>
<p>The last useful argument <code>graphics</code> can be used to self-define the legend
graphics. The value for <code>graphics</code> should be a list of functions with four
arguments: <code>x</code> and <code>y</code>: the center of the legend grid, <code>w</code> and <code>h</code>: the width
and height of the legend grid. Length of <code>graphics</code> should be the same as <code>at</code>
or <code>labels.</code> If <code>graphics</code> is a named list where the names correspond to
<code>labels</code>, then the order of the list of <code>graphics</code> is automatically adjusted.</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="legends.html#cb436-1" aria-hidden="true" tabindex="-1"></a>lgd <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">labels =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb436-2"><a href="legends.html#cb436-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">graphics =</span> <span class="fu">list</span>(</span>
<span id="cb436-3"><a href="legends.html#cb436-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">function</span>(x, y, w, h) <span class="fu">grid.rect</span>(x, y, w<span class="sc">*</span><span class="fl">0.33</span>, h, <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> <span class="st">&quot;red&quot;</span>)),</span>
<span id="cb436-4"><a href="legends.html#cb436-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">function</span>(x, y, w, h) <span class="fu">grid.rect</span>(x, y, w, h<span class="sc">*</span><span class="fl">0.33</span>, <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>)),</span>
<span id="cb436-5"><a href="legends.html#cb436-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">function</span>(x, y, w, h) <span class="fu">grid.text</span>(<span class="st">&quot;A&quot;</span>, x, y, <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>)),</span>
<span id="cb436-6"><a href="legends.html#cb436-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">function</span>(x, y, w, h) <span class="fu">grid.points</span>(x, y, <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">col =</span> <span class="st">&quot;orange&quot;</span>), <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb436-7"><a href="legends.html#cb436-7" aria-hidden="true" tabindex="-1"></a>    ))</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-119-1.png" width="41.4290813648294" style="display: block; margin: auto;" /></p>
</div>
<div id="a-list-of-legends" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> A list of legends</h2>
<p>A list of legends can be constructed or packed as a <code>Legends</code> object where the
individual legends are arranged within a certain layout. The legend list can
be sent to <code>packLegend()</code> separatedly or as a list. The legend can be arranged
either vertically or horizontally. <strong>ComplexHeatmap</strong> uses <code>packLegend()</code>
internally to arrange multiple legends. Normally you don’t need to manually
control the arrangement of multiple legends, but the following section would
be useful if you want to manually construct a list of legends and apply to
other plots.</p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="legends.html#cb437-1" aria-hidden="true" tabindex="-1"></a>lgd1 <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">legend_gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>), <span class="at">title =</span> <span class="st">&quot;legend1&quot;</span>)</span>
<span id="cb437-2"><a href="legends.html#cb437-2" aria-hidden="true" tabindex="-1"></a>lgd2 <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">col_fun =</span> col_fun, <span class="at">title =</span> <span class="st">&quot;legend2&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="dv">1</span>))</span>
<span id="cb437-3"><a href="legends.html#cb437-3" aria-hidden="true" tabindex="-1"></a>lgd3 <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">labels =</span> month.name[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">legend_gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> <span class="dv">7</span><span class="sc">:</span><span class="dv">9</span>), <span class="at">title =</span> <span class="st">&quot;legend3&quot;</span>)</span>
<span id="cb437-4"><a href="legends.html#cb437-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb437-5"><a href="legends.html#cb437-5" aria-hidden="true" tabindex="-1"></a>pd <span class="ot">=</span> <span class="fu">packLegend</span>(lgd1, lgd2, lgd3)</span>
<span id="cb437-6"><a href="legends.html#cb437-6" aria-hidden="true" tabindex="-1"></a><span class="co"># which is same as </span></span>
<span id="cb437-7"><a href="legends.html#cb437-7" aria-hidden="true" tabindex="-1"></a>pd <span class="ot">=</span> <span class="fu">packLegend</span>(<span class="at">list =</span> <span class="fu">list</span>(lgd1, lgd2, lgd3))</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-121-1.png" width="87.5624146981628" style="display: block; margin: auto;" /></p>
<p>Simillar as single legend, you can draw the packed legends by <code>draw()</code>
function. Also you can get the size of <code>pd</code> by <code>ComplexHeatmap:::width()</code> and
<code>ComplexHeatmap:::height()</code>.</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="legends.html#cb438-1" aria-hidden="true" tabindex="-1"></a>ComplexHeatmap<span class="sc">:::</span><span class="fu">width</span>(pd)</span></code></pre></div>
<pre><code>## [1] 19.1675555555556mm</code></pre>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="legends.html#cb440-1" aria-hidden="true" tabindex="-1"></a>ComplexHeatmap<span class="sc">:::</span><span class="fu">height</span>(pd)</span></code></pre></div>
<pre><code>## [1] 78.6988333333334mm</code></pre>
<p>Horizontally arranging the legends simply by setting <code>direction = "horizontal"</code>.</p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="legends.html#cb442-1" aria-hidden="true" tabindex="-1"></a>pd <span class="ot">=</span> <span class="fu">packLegend</span>(lgd1, lgd2, lgd3, <span class="at">direction =</span> <span class="st">&quot;horizontal&quot;</span>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-124-1.png" width="218.838635170604" style="display: block; margin: auto;" /></p>
<p>One feature of <code>packLegend()</code> is, e.g. if the packing is vertically and the
sum of the packed legends exceeds the height specified by <code>max_height</code>, it
will be rearragned as mutliple column layout. In following example, the
maximum height is <code>10cm</code>.</p>
<p>When all the legends are put into multiple columns, <code>column_gap</code> controls the
space between two columns.</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="legends.html#cb443-1" aria-hidden="true" tabindex="-1"></a>pd <span class="ot">=</span> <span class="fu">packLegend</span>(lgd1, lgd3, lgd2, lgd3, lgd2, lgd1, <span class="at">max_height =</span> <span class="fu">unit</span>(<span class="dv">10</span>, <span class="st">&quot;cm&quot;</span>), </span>
<span id="cb443-2"><a href="legends.html#cb443-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">column_gap =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>))</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-126-1.png" width="286.117270341207" style="display: block; margin: auto;" /></p>
<p>Similar for horizontal packing:</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="legends.html#cb444-1" aria-hidden="true" tabindex="-1"></a>lgd1 <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">legend_gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>), <span class="at">title =</span> <span class="st">&quot;legend1&quot;</span>,</span>
<span id="cb444-2"><a href="legends.html#cb444-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">nr =</span> <span class="dv">1</span>)</span>
<span id="cb444-3"><a href="legends.html#cb444-3" aria-hidden="true" tabindex="-1"></a>lgd2 <span class="ot">=</span> <span class="fu">Legend</span>(<span class="at">col_fun =</span> col_fun, <span class="at">title =</span> <span class="st">&quot;legend2&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="dv">1</span>),</span>
<span id="cb444-4"><a href="legends.html#cb444-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">&quot;horizontal&quot;</span>)</span>
<span id="cb444-5"><a href="legends.html#cb444-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb444-6"><a href="legends.html#cb444-6" aria-hidden="true" tabindex="-1"></a>pd <span class="ot">=</span> <span class="fu">packLegend</span>(lgd1, lgd2, lgd3, lgd1, lgd2, lgd3, <span class="at">max_width =</span> <span class="fu">unit</span>(<span class="dv">10</span>, <span class="st">&quot;cm&quot;</span>), </span>
<span id="cb444-7"><a href="legends.html#cb444-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">&quot;horizontal&quot;</span>, <span class="at">column_gap =</span> <span class="fu">unit</span>(<span class="dv">5</span>, <span class="st">&quot;mm&quot;</span>), <span class="at">row_gap =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>))</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-128-1.png" width="354.615223097113" style="display: block; margin: auto;" /></p>
<p>The packed legends <code>pd</code> is also a <code>Legends</code> object, which means you can use
<code>draw()</code> to draw it by specifying the positions.</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="legends.html#cb445-1" aria-hidden="true" tabindex="-1"></a>pd <span class="ot">=</span> <span class="fu">packLegend</span>(lgd1, lgd2, lgd3, <span class="at">direction =</span> <span class="st">&quot;horizontal&quot;</span>)</span>
<span id="cb445-2"><a href="legends.html#cb445-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pushViewport</span>(<span class="fu">viewport</span>(<span class="at">width =</span> <span class="fl">0.8</span>, <span class="at">height =</span> <span class="fl">0.8</span>))</span>
<span id="cb445-3"><a href="legends.html#cb445-3" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.rect</span>()</span>
<span id="cb445-4"><a href="legends.html#cb445-4" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(pd, <span class="at">x =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>), <span class="at">y =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>), <span class="at">just =</span> <span class="fu">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;bottom&quot;</span>))</span>
<span id="cb445-5"><a href="legends.html#cb445-5" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(pd, <span class="at">x =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>), <span class="at">y =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>), <span class="at">just =</span> <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;top&quot;</span>))</span>
<span id="cb445-6"><a href="legends.html#cb445-6" aria-hidden="true" tabindex="-1"></a><span class="fu">popViewport</span>()</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-129-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>To be mentioned again, <code>packLegend()</code> is used internally to manage the list
of heatmap and annotation legends.</p>
</div>
<div id="heatmap-and-annotation-legends" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Heatmap and annotation legends</h2>
<p>Settings for heatmap legend are controlled by <code>heatmap_legend_param</code> argument
in <code>Heatmap()</code>. The value for <code>heatmap_legend_param</code> is a list of parameters
which are supported in <code>Legend()</code>.</p>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="legends.html#cb446-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>), <span class="dv">10</span>)</span>
<span id="cb446-2"><a href="legends.html#cb446-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Heatmap</span>(m, <span class="at">name =</span> <span class="st">&quot;mat&quot;</span>, <span class="at">heatmap_legend_param =</span> <span class="fu">list</span>(</span>
<span id="cb446-3"><a href="legends.html#cb446-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">at =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb446-4"><a href="legends.html#cb446-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;zero&quot;</span>, <span class="st">&quot;high&quot;</span>),</span>
<span id="cb446-5"><a href="legends.html#cb446-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Some values&quot;</span>,</span>
<span id="cb446-6"><a href="legends.html#cb446-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend_height =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb446-7"><a href="legends.html#cb446-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title_position =</span> <span class="st">&quot;lefttop-rot&quot;</span></span>
<span id="cb446-8"><a href="legends.html#cb446-8" aria-hidden="true" tabindex="-1"></a>))</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-130-1.png" width="499.2" style="display: block; margin: auto;" /></p>
<p><code>annotation_legend_param</code> controls legends for annotations. Since a
<code>HeatmapAnnotation</code> may contain multiple annotations, the value of
<code>annotation_legend_param</code> is a list of configurations of each annotation.</p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="legends.html#cb447-1" aria-hidden="true" tabindex="-1"></a>ha <span class="ot">=</span> <span class="fu">HeatmapAnnotation</span>(<span class="at">foo =</span> <span class="fu">runif</span>(<span class="dv">10</span>), <span class="at">bar =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;f&quot;</span>, <span class="st">&quot;m&quot;</span>), <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb447-2"><a href="legends.html#cb447-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">annotation_legend_param =</span> <span class="fu">list</span>(</span>
<span id="cb447-3"><a href="legends.html#cb447-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">foo =</span> <span class="fu">list</span>(</span>
<span id="cb447-4"><a href="legends.html#cb447-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">title =</span> <span class="st">&quot;Fooooooh&quot;</span>,</span>
<span id="cb447-5"><a href="legends.html#cb447-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">at =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>),</span>
<span id="cb447-6"><a href="legends.html#cb447-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;zero&quot;</span>, <span class="st">&quot;median&quot;</span>, <span class="st">&quot;one&quot;</span>)</span>
<span id="cb447-7"><a href="legends.html#cb447-7" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb447-8"><a href="legends.html#cb447-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">bar =</span> <span class="fu">list</span>(</span>
<span id="cb447-9"><a href="legends.html#cb447-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">title =</span> <span class="st">&quot;Baaaaaaar&quot;</span>,</span>
<span id="cb447-10"><a href="legends.html#cb447-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">at =</span> <span class="fu">c</span>(<span class="st">&quot;f&quot;</span>, <span class="st">&quot;m&quot;</span>),</span>
<span id="cb447-11"><a href="legends.html#cb447-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Male&quot;</span>)</span>
<span id="cb447-12"><a href="legends.html#cb447-12" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb447-13"><a href="legends.html#cb447-13" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb447-14"><a href="legends.html#cb447-14" aria-hidden="true" tabindex="-1"></a><span class="fu">Heatmap</span>(m, <span class="at">name =</span> <span class="st">&quot;mat&quot;</span>, <span class="at">top_annotation =</span> ha)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-131-1.png" width="499.2" style="display: block; margin: auto;" /></p>
<p>If the heatmaps are concatenated horizontally, all heatmap and row annotation
legends are grouped and all column annotation legends ae grouped. The reason
we assume the horizontal direction passes the main message of the plot, while
the vertical direction provides secondary information.</p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="legends.html#cb448-1" aria-hidden="true" tabindex="-1"></a>ha1 <span class="ot">=</span> <span class="fu">HeatmapAnnotation</span>(<span class="at">foo1 =</span> <span class="fu">runif</span>(<span class="dv">10</span>), <span class="at">bar1 =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;f&quot;</span>, <span class="st">&quot;m&quot;</span>), <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb448-2"><a href="legends.html#cb448-2" aria-hidden="true" tabindex="-1"></a>ha2 <span class="ot">=</span> <span class="fu">HeatmapAnnotation</span>(<span class="at">foo2 =</span> <span class="fu">runif</span>(<span class="dv">10</span>), <span class="at">bar2 =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;f&quot;</span>, <span class="st">&quot;m&quot;</span>), <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb448-3"><a href="legends.html#cb448-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Heatmap</span>(m, <span class="at">name =</span> <span class="st">&quot;mat1&quot;</span>, <span class="at">top_annotation =</span> ha1) <span class="sc">+</span></span>
<span id="cb448-4"><a href="legends.html#cb448-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rowAnnotation</span>(<span class="at">sth =</span> <span class="fu">runif</span>(<span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb448-5"><a href="legends.html#cb448-5" aria-hidden="true" tabindex="-1"></a><span class="fu">Heatmap</span>(m, <span class="at">name =</span> <span class="st">&quot;mat2&quot;</span>, <span class="at">top_annotation =</span> ha2)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-132-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Similarlly, if the heatmaps are concatenated vertically, all heatmaps/column
annotations are grouped and legends for all row annotations are grouped.</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="legends.html#cb449-1" aria-hidden="true" tabindex="-1"></a>ha1 <span class="ot">=</span> <span class="fu">HeatmapAnnotation</span>(<span class="at">foo1 =</span> <span class="fu">runif</span>(<span class="dv">10</span>), <span class="at">bar1 =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;f&quot;</span>, <span class="st">&quot;m&quot;</span>), <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>), </span>
<span id="cb449-2"><a href="legends.html#cb449-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">annotation_name_side =</span> <span class="st">&quot;left&quot;</span>)</span>
<span id="cb449-3"><a href="legends.html#cb449-3" aria-hidden="true" tabindex="-1"></a>ha2 <span class="ot">=</span> <span class="fu">HeatmapAnnotation</span>(<span class="at">foo2 =</span> <span class="fu">runif</span>(<span class="dv">10</span>), <span class="at">bar2 =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;f&quot;</span>, <span class="st">&quot;m&quot;</span>), <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb449-4"><a href="legends.html#cb449-4" aria-hidden="true" tabindex="-1"></a><span class="fu">Heatmap</span>(m, <span class="at">name =</span> <span class="st">&quot;mat1&quot;</span>, <span class="at">top_annotation =</span> ha1) <span class="sc">%v%</span></span>
<span id="cb449-5"><a href="legends.html#cb449-5" aria-hidden="true" tabindex="-1"></a><span class="fu">Heatmap</span>(m, <span class="at">name =</span> <span class="st">&quot;mat2&quot;</span>, <span class="at">top_annotation =</span> ha2, </span>
<span id="cb449-6"><a href="legends.html#cb449-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">right_annotation =</span> <span class="fu">rowAnnotation</span>(<span class="at">sth =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>))</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-133-1.png" width="499.2" style="display: block; margin: auto;" /></p>
<p><code>show_legend</code> in <code>HeatmapAnnotation()</code> and <code>show_heatmap_legend</code> in
<code>Heatmap()</code> controls whether show the legends. Note <code>show_legend</code> can be a
single logical value, a logical vector, or a named vector which controls
subset of annotations.</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="legends.html#cb450-1" aria-hidden="true" tabindex="-1"></a>ha <span class="ot">=</span> <span class="fu">HeatmapAnnotation</span>(<span class="at">foo =</span> <span class="fu">runif</span>(<span class="dv">10</span>), </span>
<span id="cb450-2"><a href="legends.html#cb450-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">bar =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;f&quot;</span>, <span class="st">&quot;m&quot;</span>), <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb450-3"><a href="legends.html#cb450-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">show_legend =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>), <span class="co"># it can also be show_legend = c(bar = FALSE)</span></span>
<span id="cb450-4"><a href="legends.html#cb450-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">annotation_name_side =</span> <span class="st">&quot;left&quot;</span>)</span>
<span id="cb450-5"><a href="legends.html#cb450-5" aria-hidden="true" tabindex="-1"></a><span class="fu">Heatmap</span>(m, <span class="at">name =</span> <span class="st">&quot;mat1&quot;</span>, <span class="at">top_annotation =</span> ha) <span class="sc">+</span></span>
<span id="cb450-6"><a href="legends.html#cb450-6" aria-hidden="true" tabindex="-1"></a><span class="fu">Heatmap</span>(m, <span class="at">name =</span> <span class="st">&quot;mat2&quot;</span>, <span class="at">show_heatmap_legend =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-134-1.png" width="768" style="display: block; margin: auto;" /></p>
<p><code>merge_legend</code> in <code>draw()</code> function controlls whether to merge all the legends
into a single group. Normally, when there are many annotations and heatmaps,
the number of legends is always large. In this case, the legends are
automatically arranged into multiple columns (or multiple rows if they are put
at the bottom of the heatmaps) to get rid of being out of the figure page. If
a heatmap has heatmap annotations, the order of putting legends are: legends
for the left annotations, legends for the top annotations, legend of the
heatmap, legends for the bottom annotations and legends for the right
annotations.</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="legends.html#cb451-1" aria-hidden="true" tabindex="-1"></a>ha1 <span class="ot">=</span> <span class="fu">HeatmapAnnotation</span>(<span class="at">foo1 =</span> <span class="fu">runif</span>(<span class="dv">10</span>), </span>
<span id="cb451-2"><a href="legends.html#cb451-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">bar1 =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;f&quot;</span>, <span class="st">&quot;m&quot;</span>), <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb451-3"><a href="legends.html#cb451-3" aria-hidden="true" tabindex="-1"></a>ha2 <span class="ot">=</span> <span class="fu">rowAnnotation</span>(<span class="at">foo2 =</span> <span class="fu">runif</span>(<span class="dv">10</span>), </span>
<span id="cb451-4"><a href="legends.html#cb451-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">bar2 =</span> <span class="fu">sample</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb451-5"><a href="legends.html#cb451-5" aria-hidden="true" tabindex="-1"></a>ha3 <span class="ot">=</span> <span class="fu">rowAnnotation</span>(<span class="at">foo3 =</span> <span class="fu">runif</span>(<span class="dv">10</span>), </span>
<span id="cb451-6"><a href="legends.html#cb451-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">bar3 =</span> <span class="fu">sample</span>(month.name[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb451-7"><a href="legends.html#cb451-7" aria-hidden="true" tabindex="-1"></a>ht_list <span class="ot">=</span> <span class="fu">Heatmap</span>(m, <span class="at">name =</span> <span class="st">&quot;mat1&quot;</span>, <span class="at">top_annotation =</span> ha1) <span class="sc">+</span> </span>
<span id="cb451-8"><a href="legends.html#cb451-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Heatmap</span>(m, <span class="at">name =</span> <span class="st">&quot;mat2&quot;</span>, <span class="at">left_annotation =</span> ha2) <span class="sc">+</span> </span>
<span id="cb451-9"><a href="legends.html#cb451-9" aria-hidden="true" tabindex="-1"></a>    ha3</span>
<span id="cb451-10"><a href="legends.html#cb451-10" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(ht_list, <span class="at">merge_legend =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-135-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>If you want the heatmap legends to be the “pure heatmap legends,” you can set
<code>legend_grouping = "original"</code> to enforce all annotation legends to be put together,
no matter whether they are row annotation legends or column annotation legends.</p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="legends.html#cb452-1" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(ht_list, <span class="at">legend_grouping =</span> <span class="st">&quot;original&quot;</span>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-136-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>A continuous color mapping can have a
discrete legend by setting <code>color_bar = "discrete"</code>, both work for heatmap
legends and annotation legends.</p>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="legends.html#cb453-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Heatmap</span>(m, <span class="at">name =</span> <span class="st">&quot;mat&quot;</span>, <span class="at">heatmap_legend_param =</span> <span class="fu">list</span>(<span class="at">color_bar =</span> <span class="st">&quot;discrete&quot;</span>),</span>
<span id="cb453-2"><a href="legends.html#cb453-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">top_annotation =</span> <span class="fu">HeatmapAnnotation</span>(<span class="at">foo =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb453-3"><a href="legends.html#cb453-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">annotation_legend_param =</span> <span class="fu">list</span>(</span>
<span id="cb453-4"><a href="legends.html#cb453-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">foo =</span> <span class="fu">list</span>(<span class="at">color_bar =</span> <span class="st">&quot;discrete&quot;</span>))))</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-137-1.png" width="499.2" style="display: block; margin: auto;" /></p>
<p>If the <code>value</code> is a character vector, no matter it is an annotation or the one-row/one-column
matrix for the heatmap, the default order of legend labels is <code>sort(unique(value))</code> and if <code>value</code>
is a factor, the order of legend labels is <code>levels(value)</code>. Always remember the order can be
fine-tuned by setting <code>at</code> and <code>labels</code> parameters in <code>heatmap_legend_param</code>/<code>annotation_legend_param</code>
in <code>Heatmap()</code>/<code>HeamtapAnnotation()</code> functions respectively.</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="legends.html#cb454-1" aria-hidden="true" tabindex="-1"></a>chr <span class="ot">=</span> <span class="fu">sample</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb454-2"><a href="legends.html#cb454-2" aria-hidden="true" tabindex="-1"></a>chr</span></code></pre></div>
<pre><code>##  [1] &quot;a&quot; &quot;c&quot; &quot;a&quot; &quot;c&quot; &quot;b&quot; &quot;b&quot; &quot;a&quot; &quot;c&quot; &quot;c&quot; &quot;b&quot;</code></pre>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="legends.html#cb456-1" aria-hidden="true" tabindex="-1"></a>fa1 <span class="ot">=</span> <span class="fu">factor</span>(chr)</span>
<span id="cb456-2"><a href="legends.html#cb456-2" aria-hidden="true" tabindex="-1"></a>fa2 <span class="ot">=</span> <span class="fu">factor</span>(chr, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;c&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>))</span>
<span id="cb456-3"><a href="legends.html#cb456-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Heatmap</span>(m, <span class="at">top_annotation =</span> <span class="fu">HeatmapAnnotation</span>(<span class="at">chr =</span> chr, <span class="at">fa1 =</span> fa1, <span class="at">fa2 =</span> fa2, <span class="at">fa3 =</span> fa2,</span>
<span id="cb456-4"><a href="legends.html#cb456-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">annotation_legend_param =</span> <span class="fu">list</span>(<span class="at">fa3 =</span> <span class="fu">list</span>(<span class="at">at =</span> <span class="fu">c</span>(<span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;a&quot;</span>)))))</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-138-1.png" width="499.2" style="display: block; margin: auto;" /></p>
</div>
<div id="add-customized-legends" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> Add customized legends</h2>
<p>The self-defined legends (constructed by <code>Legend()</code>) can be added to the
heatmap legend list by <code>heatmap_legend_list</code> argument in <code>draw()</code> and the
legends for annotations can be added to the annotation legend list by
<code>annotation_legend_list</code> argument.</p>
<p>There is a nice example of adding self-defined legends in Section
<a href="other-high-level-plots.html#stacked-summary-plot">11.2</a>, but here we show a simple example.</p>
<p>As mentioned before, only the heatmap and simple annotations can generate
legends on the plot. <strong>ComplexHeatmap</strong> provides many annotation functions,
but none of them supports generating legends. In following code, we add a
point annotation, a line annotation and a summary annotation to the heatmaps.</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="legends.html#cb457-1" aria-hidden="true" tabindex="-1"></a>ha1 <span class="ot">=</span> <span class="fu">HeatmapAnnotation</span>(<span class="at">pt =</span> <span class="fu">anno_points</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">col =</span> <span class="fu">rep</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">each =</span> <span class="dv">5</span>)), </span>
<span id="cb457-2"><a href="legends.html#cb457-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">height =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>)), <span class="at">show_annotation_name =</span> <span class="cn">FALSE</span>)</span>
<span id="cb457-3"><a href="legends.html#cb457-3" aria-hidden="true" tabindex="-1"></a>ha2 <span class="ot">=</span> <span class="fu">HeatmapAnnotation</span>(<span class="at">ln =</span> <span class="fu">anno_lines</span>(<span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">10</span><span class="sc">:</span><span class="dv">1</span>), <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">col =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>),</span>
<span id="cb457-4"><a href="legends.html#cb457-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">height =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>)), <span class="at">show_annotation_name =</span> <span class="cn">FALSE</span>)</span>
<span id="cb457-5"><a href="legends.html#cb457-5" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>), <span class="dv">10</span>)</span>
<span id="cb457-6"><a href="legends.html#cb457-6" aria-hidden="true" tabindex="-1"></a>ht_list <span class="ot">=</span> <span class="fu">Heatmap</span>(m, <span class="at">name =</span> <span class="st">&quot;mat1&quot;</span>, <span class="at">top_annotation =</span> ha1) <span class="sc">+</span> </span>
<span id="cb457-7"><a href="legends.html#cb457-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">Heatmap</span>(m, <span class="at">name =</span> <span class="st">&quot;mat2&quot;</span>, <span class="at">top_annotation =</span> ha2) <span class="sc">+</span></span>
<span id="cb457-8"><a href="legends.html#cb457-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">Heatmap</span>(m[, <span class="dv">1</span>], <span class="at">name =</span> <span class="st">&quot;mat3&quot;</span>, </span>
<span id="cb457-9"><a href="legends.html#cb457-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">top_annotation =</span> <span class="fu">HeatmapAnnotation</span>(</span>
<span id="cb457-10"><a href="legends.html#cb457-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">summary =</span> <span class="fu">anno_summary</span>(<span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>))</span>
<span id="cb457-11"><a href="legends.html#cb457-11" aria-hidden="true" tabindex="-1"></a>          ), <span class="at">width =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>))</span>
<span id="cb457-12"><a href="legends.html#cb457-12" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(ht_list, <span class="at">ht_gap =</span> <span class="fu">unit</span>(<span class="dv">7</span>, <span class="st">&quot;mm&quot;</span>), <span class="at">row_km =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-139-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Next we construct legends for the points, the lines and the boxplots.</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="legends.html#cb458-1" aria-hidden="true" tabindex="-1"></a>lgd_list <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb458-2"><a href="legends.html#cb458-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Legend</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>), <span class="at">title =</span> <span class="st">&quot;pt&quot;</span>, <span class="at">type =</span> <span class="st">&quot;points&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>, </span>
<span id="cb458-3"><a href="legends.html#cb458-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend_gp =</span> <span class="fu">gpar</span>(<span class="at">col =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)),</span>
<span id="cb458-4"><a href="legends.html#cb458-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Legend</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;darkblue&quot;</span>, <span class="st">&quot;lightblue&quot;</span>), <span class="at">title =</span> <span class="st">&quot;ln&quot;</span>, <span class="at">type =</span> <span class="st">&quot;lines&quot;</span>, </span>
<span id="cb458-5"><a href="legends.html#cb458-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend_gp =</span> <span class="fu">gpar</span>(<span class="at">col =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)),</span>
<span id="cb458-6"><a href="legends.html#cb458-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Legend</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;group1&quot;</span>, <span class="st">&quot;group2&quot;</span>), <span class="at">title =</span> <span class="st">&quot;km&quot;</span>, <span class="at">type =</span> <span class="st">&quot;boxplot&quot;</span>,</span>
<span id="cb458-7"><a href="legends.html#cb458-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend_gp =</span> <span class="fu">gpar</span>(<span class="at">fill =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>))</span>
<span id="cb458-8"><a href="legends.html#cb458-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb458-9"><a href="legends.html#cb458-9" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(ht_list, <span class="at">ht_gap =</span> <span class="fu">unit</span>(<span class="dv">7</span>, <span class="st">&quot;mm&quot;</span>), <span class="at">row_km =</span> <span class="dv">2</span>, <span class="at">annotation_legend_list =</span> lgd_list)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-140-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="the-side-of-legends" class="section level2" number="5.6">
<h2><span class="header-section-number">5.6</span> The side of legends</h2>
<p>By default, the heatmap legends and annotation legends are put on the right of
the plot. The side relative to the heatmaps of the two types of legends can be
controlled by <code>heatmap_legend_side</code> and <code>annotation_legend_side</code> arguments in
<code>draw()</code> function. The values that can be set for the two arguments are
<code>left</code>, <code>right</code>, <code>bottom</code> and <code>top</code>.</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="legends.html#cb459-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">100</span>), <span class="dv">10</span>)</span>
<span id="cb459-2"><a href="legends.html#cb459-2" aria-hidden="true" tabindex="-1"></a>ha1 <span class="ot">=</span> <span class="fu">HeatmapAnnotation</span>(<span class="at">foo1 =</span> <span class="fu">runif</span>(<span class="dv">10</span>), <span class="at">bar1 =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;f&quot;</span>, <span class="st">&quot;m&quot;</span>), <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb459-3"><a href="legends.html#cb459-3" aria-hidden="true" tabindex="-1"></a>ha2 <span class="ot">=</span> <span class="fu">HeatmapAnnotation</span>(<span class="at">foo2 =</span> <span class="fu">runif</span>(<span class="dv">10</span>), <span class="at">bar2 =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;f&quot;</span>, <span class="st">&quot;m&quot;</span>), <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb459-4"><a href="legends.html#cb459-4" aria-hidden="true" tabindex="-1"></a>ht_list <span class="ot">=</span> <span class="fu">Heatmap</span>(m, <span class="at">name =</span> <span class="st">&quot;mat1&quot;</span>, <span class="at">top_annotation =</span> ha1) <span class="sc">+</span></span>
<span id="cb459-5"><a href="legends.html#cb459-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rowAnnotation</span>(<span class="at">sth =</span> <span class="fu">runif</span>(<span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb459-6"><a href="legends.html#cb459-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Heatmap</span>(m, <span class="at">name =</span> <span class="st">&quot;mat2&quot;</span>, <span class="at">top_annotation =</span> ha2)</span>
<span id="cb459-7"><a href="legends.html#cb459-7" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(ht_list, <span class="at">heatmap_legend_side =</span> <span class="st">&quot;left&quot;</span>, <span class="at">annotation_legend_side =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-141-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>When the legends are put at the bottom or on the top, the legends are arranged
horizontally. We might also want to set every single legend as horizontal
legend, this needs to be set via the <code>heatmap_legend_param</code> and
<code>annotation_legend_param</code> arguments in <code>Heatmap()</code> and <code>HeatmapAnnotation()</code>
functions:</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="legends.html#cb460-1" aria-hidden="true" tabindex="-1"></a>ha1 <span class="ot">=</span> <span class="fu">HeatmapAnnotation</span>(<span class="at">foo1 =</span> <span class="fu">runif</span>(<span class="dv">10</span>), <span class="at">bar1 =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;f&quot;</span>, <span class="st">&quot;m&quot;</span>), <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb460-2"><a href="legends.html#cb460-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">annotation_legend_param =</span> <span class="fu">list</span>(</span>
<span id="cb460-3"><a href="legends.html#cb460-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">foo1 =</span> <span class="fu">list</span>(<span class="at">direction =</span> <span class="st">&quot;horizontal&quot;</span>),</span>
<span id="cb460-4"><a href="legends.html#cb460-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">bar1 =</span> <span class="fu">list</span>(<span class="at">nrow =</span> <span class="dv">1</span>)))</span>
<span id="cb460-5"><a href="legends.html#cb460-5" aria-hidden="true" tabindex="-1"></a>ha2 <span class="ot">=</span> <span class="fu">HeatmapAnnotation</span>(<span class="at">foo2 =</span> <span class="fu">runif</span>(<span class="dv">10</span>), <span class="at">bar2 =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;f&quot;</span>, <span class="st">&quot;m&quot;</span>), <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb460-6"><a href="legends.html#cb460-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">annotation_legend_param =</span> <span class="fu">list</span>(</span>
<span id="cb460-7"><a href="legends.html#cb460-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">foo2 =</span> <span class="fu">list</span>(<span class="at">direction =</span> <span class="st">&quot;horizontal&quot;</span>),</span>
<span id="cb460-8"><a href="legends.html#cb460-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">bar2 =</span> <span class="fu">list</span>(<span class="at">nrow =</span> <span class="dv">1</span>)))</span>
<span id="cb460-9"><a href="legends.html#cb460-9" aria-hidden="true" tabindex="-1"></a>ht_list <span class="ot">=</span> <span class="fu">Heatmap</span>(m, <span class="at">name =</span> <span class="st">&quot;mat1&quot;</span>, <span class="at">top_annotation =</span> ha1, </span>
<span id="cb460-10"><a href="legends.html#cb460-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">heatmap_legend_param =</span> <span class="fu">list</span>(<span class="at">direction =</span> <span class="st">&quot;horizontal&quot;</span>)) <span class="sc">+</span></span>
<span id="cb460-11"><a href="legends.html#cb460-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rowAnnotation</span>(<span class="at">sth =</span> <span class="fu">runif</span>(<span class="dv">10</span>), </span>
<span id="cb460-12"><a href="legends.html#cb460-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">annotation_legend_param =</span> <span class="fu">list</span>(<span class="at">sth =</span> <span class="fu">list</span>(<span class="at">direction =</span> <span class="st">&quot;horizontal&quot;</span>))) <span class="sc">+</span></span>
<span id="cb460-13"><a href="legends.html#cb460-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Heatmap</span>(m, <span class="at">name =</span> <span class="st">&quot;mat2&quot;</span>, <span class="at">top_annotation =</span> ha2,</span>
<span id="cb460-14"><a href="legends.html#cb460-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">heatmap_legend_param =</span> <span class="fu">list</span>(<span class="at">direction =</span> <span class="st">&quot;horizontal&quot;</span>))</span>
<span id="cb460-15"><a href="legends.html#cb460-15" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(ht_list, <span class="at">merge_legend =</span> <span class="cn">TRUE</span>, <span class="at">heatmap_legend_side =</span> <span class="st">&quot;bottom&quot;</span>, </span>
<span id="cb460-16"><a href="legends.html#cb460-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">annotation_legend_side =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<p><img src="05-legends_files/figure-html/unnamed-chunk-142-1.png" width="768" style="display: block; margin: auto;" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="a-list-of-heatmaps.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="heatmap-decoration.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jokergoo/ComplexHeatmap-reference/edit/master/05-legends.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["ComplexHeatmap-reference.epub"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
